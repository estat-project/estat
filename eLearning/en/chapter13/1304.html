<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <title>Chapter 13</title>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="../../css/ie10-viewport-bug-workaround.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="../../css/dashboard.css" rel="stylesheet">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <style type="text/css">code{white-space: pre;}</style>
       <style type="text/css">.sidebar ul{padding-left: 10px;}</style>
       <script src="../../js/prism.js"></script>
       <link rel="stylesheet" href="../../css/prism.css">
       <script src="../../js/jquery.min.js"></script>    
       <script type="text/javascript" id="MathJax-script" async
	       src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
       </script>
       <script>
	 $(document).ready(function() {
  	     toc = $("#sidebar > ul > li > ul");
  	     sections = toc.children();   // <li>
  	     for(var i=0; i<sections.length; i++) {
  		 if ($(sections[i]).children().length == 1) { continue; }
  		 var first = sections[i].firstElementChild;  // <a>
  		 var last = sections[i].lastElementChild;
  		 var li = $("<li>");
  		 var details = $("<details>");
  		 var summary = $("<summary>");
  		 $(summary).append(first)
  		 $(details).append(summary);
  		 $(details).append(last);
  		 $(li).append(details);	
  		 $(sections[i]).replaceWith(li);
  	     }
	 });
	 </script>
       <link rel="stylesheet" href="../../css/pandoc.css">
       <script src="../../js/eBook.js"></script>
       <script src="../../../eStat/js/language.js" ></script>   
       <script src="../../../eStat/lib/d3/d3.v4.min.js"></script>   
       <script src="../../../eStat/lib/DistributionsUtil.js" ></script>
       <script src="../../../eStat/js/eStatU.js"></script>
       <script src="../../../eStat/lib/FileSaver.min.js" ></script>
       <script src="../../../eStat/lib/convertSVG.js"></script>
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
  <ul class="nav navbar-nav">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Chapter<span class="caret"></span></a>
      <ul class="dropdown-menu"> 
        <li><a href="../index.html">HOME</a></li>
        <li><a href="../chapter01/index.html">Chapter 1</a></li>
        <li><a href="../chapter02/index.html">Chapter 2</a></li>
        <li><a href="../chapter03/index.html">Chapter 3</a></li>
        <li><a href="../chapter04/index.html">Chapter 4</a></li>
        <li><a href="../chapter05/index.html">Chapter 5</a></li>
        <li><a href="../chapter06/index.html">Chapter 6</a></li>
        <li><a href="../chapter07/index.html">Chapter 7</a></li>
        <li><a href="../chapter08/index.html">Chapter 8</a></li>
        <li><a href="../chapter09/index.html">Chapter 9</a></li>
        <li><a href="../chapter10/index.html">Chapter 10</a></li>
        <li><a href="../chapter11/index.html">Chapter 11</a></li>
        <li><a href="../chapter12/index.html">Chapter 12</a></li>
        <li><a href="../chapter13/index.html">Chapter 13</a></li>
      </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Section<span class="caret"></span></a>
	  <ul class="dropdown-menu"> 
                <li><a href="../chapter13/1301.html">13.1 What is Time Series Analysis?</a></li>
                <li><a href="../chapter13/1302.html">13.2 Smoothing of Time Series</a></li>
                <li><a href="../chapter13/1303.html">13.3 Transformation of Time Series</a></li>
                <li><a href="../chapter13/1304.html">13.4 Regression Model and Forecasting</a></li>
                <li><a href="../chapter13/1305.html">13.5 Exponential Smoothing Model and Forecasting</a></li>
                <li><a href="../chapter13/1306.html">13.6 13.6 Seasonal Model and Forecasting</a></li>
                <li><a href="../chapter13/1307.html">13.7 Exercise</a></li>
	  </ul>
    </li>
    <li><a class="navbar-brand" href="http://estat.me" target="_blank">eStat</a></li>
    <li><a class="navbar-brand" href="http://www.estat.me/estat/eStatU/index.html" target="_blank">eStatU</a></li>
    <li><a class="navbar-brand" href="/estat/eLearning/Distribution/index.html" target="_blank">Distribution</a></li>
  </ul>
</nav>

<div class="container-fluid">
  <div class="row">
    <div id="sidebar" class="col-sm-3 col-md2 sidebar">
      <ul>
	<li><a href=""></a>
	  <ul>
            <li><a href="../index.html">HOME</a></li>
	    <li><a href="../chapter01/index.html">Chapter 1</a>
	      <ul>
                <li><a href="../chapter01/0101.html">1.1 Statistics and Data Science</a></li>
                <li><a href="../chapter01/0102.html">1.2 Population and Sample</a></li>
                <li><a href="../chapter01/0103.html">1.3 Variables and Data</a></li>
                <li><a href="../chapter01/0104.html">1.4 Softwares for Statistical Analysis</a></li>
                <li><a href="../chapter01/0105.html">1.5 Exercies</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter02/index.html">Chapter 2</a>
	      <ul>
                <li><a href="../chapter02/0201.html">2.1 Visualization of Qualitative Data</a></li>
                <li><a href="../chapter02/0202.html">2.2 Visualization of Summary Data</a></li>
                <li><a href="../chapter02/0202.html">&nbsp;&nbsp;2.2.1 Summary Data of Categorical Variable</a></li>
                <li><a href="../chapter02/0202.html">&nbsp;&nbsp;2.2.2 Summary Data of Categorical Variable with Group</a></li>
                <li><a href="../chapter02/0203.html">2.3 Visualization of Raw Data</a></li>
                <li><a href="../chapter02/0203.html">&nbsp;&nbsp;2.3.1 Raw Data of Categorical Variable</a></li>
                <li><a href="../chapter02/0203.html">&nbsp;&nbsp;2.3.2 Raw Data of Categorical Variable with Group</a></li>
                <li><a href="../chapter02/0204.html">2.4 Word Cloud</a></li>
                <li><a href="../chapter02/0205.html">2.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter03/index.html">Chapter 3</a>
	      <ul>
                <li><a href="../chapter03/0301.html">3.1 Visualization of Quantitative Data</a></li> 
                <li><a href="../chapter03/0302.html">3.2 Visualization of Single Quantitative Variable</a></li>
                <li><a href="../chapter03/0302.html">&nbsp;&nbsp;3.2.1 Visualization of Quantitative Data without Group</a></li>
                <li><a href="../chapter03/0302.html">&nbsp;&nbsp;3.2.2 Visualization of Quantitative Data with Group</a></li>
                <li><a href="../chapter03/0303.html">3.3 Visualization of Two Quantitative Variables</a></li>
                <li><a href="../chapter03/0304.html">3.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter04/index.html">Chapter 4</a>
	      <ul>
                <li><a href="../chapter04/0401.html">4.1 Frequency Table for Single Variable</a></li>
                <li><a href="../chapter04/0401.html">&nbsp;&nbsp;4.1.1 Frequency Table for Categorical Variable</a></li>
                <li><a href="../chapter04/0401.html">&nbsp;&nbsp;4.1.2 Frequency Table for Quantitative Variable</a></li>
                <li><a href="../chapter04/0402.html">4.2 Contingency Table for Two Variables</a></li>
                <li><a href="../chapter04/0402.html">&nbsp;&nbsp;4.2.1 Contingency Table for Two Categorical Variables</a></li>
                <li><a href="../chapter04/0402.html">&nbsp;&nbsp;4.2.2 Contingency Table for Two Quantitative Variables</a></li>
                <li><a href="../chapter04/040301.html">4.3 Summary Measures for Quantitative Variable</a></li>
                <li><a href="../chapter04/040301.html">&nbsp;&nbsp;4.3.1 Measures of Central Tendency</a></li>
                <li><a href="../chapter04/040302.html">&nbsp;&nbsp;4.3.2 Measures of Dispersion</a></li>
                <li><a href="../chapter04/0404.html">4.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter05/index.html">Chapter 5</a>
	      <ul>
                <li><a href="../chapter05/0501.html">5.1 Definition of Probability</a></li>
                <li><a href="../chapter05/0502.html">5.2 Calculation of Probability</a></li>
                <li><a href="../chapter05/0503.html">5.3 Discrete Random Variable</a></li>
		<li><a href="../chapter05/050301.html">&nbsp;&nbsp;5.3.1 Binomial Distribution</a></li>
		<li><a href="../chapter05/050302.html">&nbsp;&nbsp;5.3.2 Poissson Distribution</a></li>
		<li><a href="../chapter05/050303.html">&nbsp;&nbsp;5.3.3 Geometric Distribution</a></li>
		<li><a href="../chapter05/050304.html">&nbsp;&nbsp;5.3.4 Hypergeometric Distribution</a></li>
                <li><a href="../chapter05/0504.html">5.4 Continuous Random Variable</a></li>
		<li><a href="../chapter05/050401.html">&nbsp;&nbsp;5.4.1 Normal Distribution</a></li>
		<li><a href="../chapter05/050402.html">&nbsp;&nbsp;5.4.2 Exponential Distribution</a></li>
                <li><a href="../chapter05/0505.html">5.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter06/index.html">Chapter 6</a>
	      <ul>
                <li><a href="../chapter06/0601.html">6.1 Simple Random Sampling</a></li>
                <li><a href="../chapter06/060201.html">6.2 Sampling Distribution of Sample Means and Estimation of the Population Mean</a></li>
                <li><a href="../chapter06/060201.html">&nbsp;&nbsp;6.2.1 Sampling Distribution of Sample Means</a></li>
                <li><a href="../chapter06/060202.html">&nbsp;&nbsp;6.2.2 Estimation of the Population Mean</a></li>
                <li><a href="../chapter06/060301.html">6.3 Sampling Distribution of Sample Variances and Estimation of the Population Variance</a></li>
                <li><a href="../chapter06/060301.html">&nbsp;&nbsp;6.3.1 Sampling Distribution of Sample Variances</a></li>
                <li><a href="../chapter06/060302.html">&nbsp;&nbsp;6.3.2 Estimation of the Population Variance</a></li>
                <li><a href="../chapter06/060401.html">6.4 Sampling Distribution of Sample Proportions and Estimation of the Population Proportion</a></li>
                <li><a href="../chapter06/060401.html">&nbsp;&nbsp;6.4.1 Sampling Distribution of Sample Proportions</a></li>
                <li><a href="../chapter06/060402.html">&nbsp;&nbsp;6.4.2 Estimation of the Population Proportion</a></li>
                <li><a href="../chapter06/0605.html">6.5 Determination of the Sample Size  </a></li>
                <li><a href="../chapter06/0605.html">&nbsp;&nbsp;6.5.1 Determination of the Sample Size to Estimate the Population Mean </a></li>
                <li><a href="../chapter06/0605.html">&nbsp;&nbsp;6.5.2 Determination of the Sample Size to Estimate the Population Proportion</a></li> 
                <li><a href="../chapter06/0606.html">6.6 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter07/index.html">Chapter 7</a>
	      <ul>
                <li><a href="../chapter07/0701.html">7.1 Testing Hypothesis for a Population Mean</a></li>
                <li><a href="../chapter07/0702.html">7.2 Testing Hypothesis for a Population Variance</a></li>
                <li><a href="../chapter07/0703.html">7.3 Testing Hypothesis for a Population Proportion</a></li>
                <li><a href="../chapter07/0704.html">7.4 Testing Hypothesis with α and β simultaneously</a></li>
                <li><a href="../chapter07/0704.html">&nbsp;&nbsp;7.4.1 Type 2 Error and Power of a Test</a></li>
                <li><a href="../chapter07/0704.html">&nbsp;&nbsp;7.4.2 Testing Hypothesis with α and β</a></li>
                <li><a href="../chapter07/0705.html">7.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter08/index.html">Chapter 8</a>
	      <ul>
                <li><a href="../chapter08/080101.html">8.1 Testing Hypothesis for Two Population Means</a></li>
                <li><a href="../chapter08/080101.html">&nbsp;&nbsp;8.1.1 Two Independent Samples</a></li>
                <li><a href="../chapter08/080102.html">&nbsp;&nbsp;8.1.2 Paired Sample</a></li>
                <li><a href="../chapter08/0802.html">8.2 Testing Hypothesis for Two Population Variances</a></li>
                <li><a href="../chapter08/0803.html">8.3 Testing Hypothesis for Two Population Proportions</a></li>
                <li><a href="../chapter08/0804.html">8.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter09/index.html">Chapter 9</a>
	      <ul>
                <li><a href="../chapter09/0901.html">9.1 Analysis of Variance for Experiments of Single Factor</a></li>
                <li><a href="../chapter09/090101.html">&nbsp;&nbsp;9.1.1 Multiple Comparison</a></li>
                <li><a href="../chapter09/090101.html">&nbsp;&nbsp;9.1.2 Residual Analysis</a></li>
                <li><a href="../chapter09/0902.html">9.2 Design of Experiments for Sampling</a></li>
                <li><a href="../chapter09/0902.html">&nbsp;&nbsp;9.2.1 Completely Randomized Design</a></li>
                <li><a href="../chapter09/0902.html">&nbsp;&nbsp;9.2.2 Randomized Block Design</a></li>
                <li><a href="../chapter09/0903.html">9.3 Analysis of Variance for Experiments of Two Factors</a></li>
                <li><a href="../chapter09/0904.html">9.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter10/index.html">Chapter 10</a>
	      <ul>
                <li><a href="../chapter10/1001.html">10.1 Nonparametric Test for the Location Parameter of Single Population  </a></li>
                <li><a href="../chapter10/1001.html">&nbsp;&nbsp;10.1.1 Sign Test</a></li>
                <li><a href="../chapter10/100102.html">&nbsp;&nbsp;10.1.2 Wilcoxon Signed Rank Sum Test</a></li>
                <li><a href="../chapter10/1002.html">10.2 Nonparametric Test for Location Parameters of Two Populations</a></li>
                <li><a href="../chapter10/1002.html">&nbsp;&nbsp;10.2.1 Independent Samples: Wilcoxon Rank Sum Test</a></li>
                <li><a href="../chapter10/100202.html">&nbsp;&nbsp;10.2.2 Paired Samples: Wilcoxon Signed Rank Sum Test</a></li>
                <li><a href="../chapter10/1003.html">10.3 Nonparametric Test for Location Parameters of Several Populations</a></li>
                <li><a href="../chapter10/1003.html">&nbsp;&nbsp;10.3.1 Completely Randomized Design: Kruskal-Wallis Test</a></li>
                <li><a href="../chapter10/100302.html">&nbsp;&nbsp;10.3.2 Randomized Block Design: Friedman Test</a></li>
                <li><a href="../chapter10/1004.html">10.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter11/index.html">Chapter 11</a>
	      <ul>
                <li><a href="../chapter11/1101.html">11.1 Goodness of Fit Test</a></li>
                <li><a href="../chapter11/1101.html">&nbsp;&nbsp;11.1.1 Goodness of Fit Test for Categorical Distribution</a></li>
                <li><a href="../chapter11/110102.html">&nbsp;&nbsp;11.1.2 Goodness of Fit Test for Continuous Distribution</a></li>
                <li><a href="../chapter11/1102.html">11.2 Testing Hypothesis for Contingency Table</a></li>
                <li><a href="../chapter11/1102.html">&nbsp;&nbsp;11.2.1 Independence Test</a></li>
                <li><a href="../chapter11/110202.html">&nbsp;&nbsp;11.2.2 Homogeneity Test</a></li>
                <li><a href="../chapter11/1103.html">11.3 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter12/index.html">Chapter 12</a>
	      <ul>
                <li><a href="../chapter12/1201.html">12.1 Correlation Analysis</a></li>
                <li><a href="../chapter12/1202.html">12.2 Simple Linear Regression Analysis</a></li>
                <li><a href="../chapter12/1203.html">12.3 Multiple Linear Regression Analysis</a></li>
                <li><a href="../chapter12/1204.html">12.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter13/index.html">Chapter 13</a>
	      <ul>
                <li><a href="../chapter13/1301.html">13.1 What is Time Series Analysis?</a></li>
                <li><a href="../chapter13/1302.html">13.2 Smoothing of Time Series</a></li>
                <li><a href="../chapter13/1303.html">13.3 Transformation of Time Series</a></li>
                <li><a href="../chapter13/1304.html">13.4 Regression Model and Forecasting</a></li>
                <li><a href="../chapter13/1305.html">13.5 Exponential Smoothing Model and Forecasting</a></li>
                <li><a href="../chapter13/1306.html">13.6 Seasonal Model and Forecasting</a></li>
                <li><a href="../chapter13/1307.html">13.7 Exercise</a></li>
	      </ul>
	    </li>

	  </ul>
	</li>
      </ul>
    </div>
  </div>
</div>

<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

  <!--***********************************************************************-->
  <h2>Chapter 13. Time Series Analysis</h2> 
  <p>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(133)">&#10094; &nbsp;&nbsp;<b>Previous</b></button>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(135)"><b>Next</b>&nbsp;&nbsp; &#10095;</button>
  <p>
  <h3>13.4 Regression Model and Forecasting</h3>
  <p>
<!---
  <h6>
      <a href="1202.pdf" target="_blank"><u>[presentation]</u></a>&nbsp;&nbsp;&nbsp;
      <a href="https://youtu.be/wn0Dl3dLgko" target="_blank"><u>[video]</u></a>
  </h6>
--->
  <p>

    <div class="mainTable">
       If there is a trend factor that shows a continuous increase or decrease in the time series,
       the regression model learned in Chapter 12 can be applied. For example, if the time series 
       shows a linear trend, the linear regression model is applied with the time series as 
       the observation values of the random variable \(Y_1 , Y_2 , ... , Y_n\) and time 
       as 1, 2, ... , \(n\) as follows.
     $$
        Y_t \,=\, \beta_0 \,+\, \beta_1 t \,+\, \epsilon_t
     $$
       Here \(\epsilon_t \) is ther error term with mean 0 and variance \(\sigma^2\).
       A characteristic of the linear model is that it increases by a slope \(\beta_1\) 
       of a certain magnitude over time.
     <p>
       When the estimated regression coefficients are \(\beta_0 , \beta_1\), the validity test 
       of the linear regression model is the same as the method described in Chapter 12. 
       The standard error of estimate and coefficient of determination are often used. 
       In a linear trend model, \(\sigma\)  represents the degree to which observations
       can be scattered around the estimated regression line at each time point. As an estimate 
       of this \(\sigma\), the following standard error is used.
     $$
       s \,=\, \sqrt { \frac{1} {n-2} \sum_{t=1}^n ( Y_t -  {\hat Y}_t )^2 }  
     $$
       A smaller standard error \(s\) value  indicates that the observed values are close to 
       the estimated regression line, which means that the regression line model is well fitted.
     <p>
       The coefficient of determination is the ratio of the regression sum of squares, RSS, which is explained out of the total sum of squares, TSS.
     $$
         R^2 \,=\, \frac{RSS}{TSS}
     $$
       The value of the coefficient of determination is always between 0 and 1, and the closer the value is to 1, the more dense the samples are around the regression line, which means that the estimated regression equation explains the observations well. 
     <p>
       As explained in Chapter 12, since it is difficult to determine the absolute criteria for adequacy of 
       the standard error or the coefficient of determination, a hypothesis test is used to determine whether 
       the trend parameter \(\beta_1\) is zero or not.
     <p>
        \(\small  \qquad \text{Hypothesis: }  \qquad \,\, H_0 : \beta_1 = 0, H_1: \beta_1 \ne 0\) <br>
        \(\small  \qquad \text{Test statistic:} \qquad t_{obs} = \frac {{\hat \beta}_1 } { SE ({{\hat \beta}_1 }) } \) , 
             Here, \( SE( \hat{ \beta_1} ) \,=\, \frac{ s} { \sqrt { \sum_{i=1}^ n (i - \overline t  )^2 } }     \) <br>
        \(\small  \qquad \text{Rejection region:} \quad If \,\; |t_{obs}| \,>\, t_{n-2,\alpha/2}, \,\,reject\,\, H_0     \) with significance level \(\alpha\) <br>
     <p>
       If the null hypothesis \(H_0\) is not rejected, the model cannot be considered valid.
     <p>
       The assumption for error \(\epsilon_t\) is tested using the residual, which is the difference between the observed time series value and the predicted value which is called residual analysis. Residual analysis usually examines whether assumptions about error terms such as independence and equal variance between errors are satisfied by drawing a scatter plot of the residuals over time or a scatter plot of the residuals and predicted values. In the scatterplots, if the residuals do not show a specific trend around 0 and appear randomly, it means that each assumption is valid. To examine the normality assumption of the error term, draw a normal probability plot of the residuals, and if the points on the figure show the shape of a straight line, it is judged that the assumption of the normal distribution is appropriate.
     <p>
       If the linear regression model is suitable, the predicted value 
       \({\hat Y}_{t_0} \,=\, {\hat \beta}_0  \,+\, {\hat \beta}_1 \cdot t_0 \) at the time point \(t_0\) 
       can be interpreted as a point estimate for the mean of the random variable \(Y_{t_0}\) at the time point, 
       and the confidence interval for the mean of \({\hat Y}_{t_0}\) at this time \(t_0\) is as follows:
     $$\small 
        {\hat Y}_{t_0}  \,±\, t_{n-2,\alpha/2} \cdot  SE ({\hat Y}_{t_0}  ) \;\;  where \;\, SE ( {\hat Y}_{t_0} )  \,=\, s \cdot \sqrt {  \frac{1}{n} + \frac {(t_0 - \overline t )^2} { \sum_{i=1}^n (i - \overline t )^2 } }   
     $$
     <p>
       If the trend is in the form of a quadratic, cubic or higher polynomial, the following multiple linear regression model can be assumed.
     <p>
       \( \qquad \text{Quadratic}  \qquad   Y_t = \beta_0  + \beta_1 \cdot t + \beta_2 \cdot t^2  + \epsilon _t \) <br>
       \( \qquad \text{Cubic}  \qquad \qquad   Y_t = \beta_0  + \beta_1 \cdot t + \beta_2 \cdot t^2 + \beta_3 \cdot  t^3 + \epsilon _t  \)  
     <p>		
       The prediction method is similar to the above simple linear regression model.
     <p>
       If the trend is not a polynomial model as above, the following model can also be considered.
     <p>
       \( \qquad \text{Square root} \qquad   Y_t = \beta_0  + \beta_1 \cdot \sqrt{t} + \epsilon _t \) <br>
       \( \qquad \text{Log}  \qquad \qquad \quad \; Y_t = \beta_0  + \beta_1 \cdot log(t) + \epsilon _t  \)  
     <p>		
       These models are the same as the linear regression model if \(\sqrt{t}\) or \(log(t)\) 
       are replaced with the independent variable X in the simple linear regression and the prediction method is similar.
     <p>
       In addition, the function types to which the linear regression model can be applied by transformation are as follows.
     <p>
       \( \qquad \text{Power} \qquad \qquad  Y _{t} = \beta_{0} \cdot t ^{\beta _{1}} +  \epsilon  _{t}  \) <br>
       \( \qquad \text{Exponential}  \quad  \;\; Y_t = \beta_0  \cdot e^ {( \beta_1  t)}  + \epsilon _t  \)  
     <p>		
       In the case of these two models, the parameters should be estimated using the nonlinear regression model, 
       but if the error term is ignored, the linear model can be estimated approximately as follows:
     <p>
       \( \qquad \text{Power} \qquad \qquad  log(Y_{t}) = log(\beta_{0}) +{\beta _{1}} \cdot log(t)  \) <br>
       \( \qquad \text{Exponential}  \quad  \;\; log(Y_t) = log(\beta_0) + \beta_1 \cdot t  \)  
     <p>		
       Korea's GDP from 1986 to 2021 is shown in [Table 13.4.1]. &lt;Figure 13.4.1&gt; shows the application of 
       three regression models to this data. Among these models, the quadratic model has the largest value of  
       \(r^2\) = 0.9591, so it can be said that the time series is the most suitable model. However, additional validation of the model is required.

      <p>
      <div class="textLeft">[Table 13.4.1] GDP of Korea</div>
      <table style="width:300px"> 
        <tr> 
          <th class="thGrey" style="width:150px">Year</th>
          <th class="thGrey" style="width:150px">GDP (billion $)</th>
        </tr>
        <tr> 
           <td class="tdCenter">
             1991<br>
             1992<br>
             1993<br>
             1994<br>
             1995<br>
             1996<br>
             1997<br>
             1998<br>
             1999<br>
             2000<br>
             2001<br>
             2002<br>
             2003<br>
             2004<br>
             2005<br>
             2006<br>
             2007<br>
             2008<br>
             2009<br>
             2010<br>
             2011<br>
             2012<br>
             2013<br>
             2014<br>
             2015<br>
             2016<br>
             2017<br>
             2018<br>
             2019<br>
             2020<br>
           </td> 
           <td class="tdRight">
              330.65<br>
              355.53<br>
              392.67<br>
              463.62<br>
              566.58<br>
              610.17<br>
              569.76<br>
              383.33<br>
              497.51<br>
              576.18<br>
              547.66<br>
              627.25<br>
              702.72<br>
              793.18<br>
              934.9<br>
             1053.22<br>
             1172.61<br>
             1047.34<br>
             943.67<br>
             1143.98<br>
             1253.16<br>
             1278.43<br>
             1370.8<br>
             1484.32<br>
             1465.77<br>
             1499.36<br>
             1623.07<br>
             1725.37<br>
             1651.42<br>
             1638.26<br>
          </td> 
        </tr>
      </table>

      <p>
      <!---   ************ html for Time Series - Regression Model ************  ---->
      <b>[<span data-msgid="TimeSeries"></span> : <span data-msgid="Forecasting"></span> : <span data-msgid="RegressionModel"></span>]</b>
      <p>
         <input class="qrBtn" type="image" src="../../QR/eStatU350_TimeseriesRegression.svg" onclick="window.open(addrStr[136])">
      <p>
      <button type="button" id="erase" style="width:100px;"><b>New Data</b></button>
      <p>
      <table class="data">
	<tr>
	  <td><b>Y <span data-msgid="input data"></span></b></td>
	  <td colspan="3"><input type="text" size=73 id="data2"></td>
	</tr>
        <tr>
          <td style="text-align: right;"><b><span data-msgid="Main Title">Main Title</span></b>&nbsp;</td>
          <td colspan="3"><input type="text" size=50 id="mtitle"></td>
        </tr>
	<tr>
          <td style="text-align: right;"><b><span data-msgid="y title">y title</span></b>&nbsp;</td>
          <td><input type="text" size=15 id="ytitle"></td>
 	</tr>
      </table>   
      <p>
      <button type="button" id="execute"><span data-msgid="Execute">Execute</span></button>
      <table class="stat">
	<tr>
          <td><span data-msgid="ForecastingPeriod"></span></td>
          <td><input type="number" min="0" max="20" value="0" id="nn42" style="text-align:center" onchange="clearScreen()"></td>
 	  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>         
 	  <td><span data-msgid="NumberData"></span></td>         
	  <td><span class="fontmath">n<sub>Y</sub></span></td>
	  <td><input type="text" style="text-align:center;" size=6 id="nn41"> <span style="color:red;">( ≤ 120)</span></td>     
	</tr>
      </table>

      <svg id="chart" width="620" height="400" style="border-style:solid;"> </svg> 
      <table style="width:800px;">
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model1">&nbsp;&nbsp;<span data-msgid="Linear"></span>
            </label> 
          </td>
	  <td><span class="fontmath">y = b<sub>0</sub> + b<sub>1</sub> t</span></td>
          <td><input type="text" size=6 id="rsquare1" style="text-align: left;">&nbsp;</td>
          <td><input type="text" size=36 id="equation1" style="text-align: left;"></td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model2">&nbsp;&nbsp;<span data-msgid="Quadratic"></span>
            </label> 
          </td>
	  <td><span class="fontmath">y = β<sub>0</sub> + β<sub>1</sub> t + b<sub>2</sub> t<sup>2</sup></span></td>
          <td><input type="text" size=6 id="rsquare2" style="text-align: left;">&nbsp;</td>
          <td><input type="text" size=36 id="equation2" style="text-align: left;"></td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model3">&nbsp;&nbsp;<span data-msgid="Cubic"></span>
            </label> 
          </td>
	  <td><span class="fontmath">y = β<sub>0</sub>+β<sub>1</sub>t+β<sub>2</sub>t<sup>2</sup></span>+β<sub>3</sub>t<sup>3</sup></td>
          <td><input type="text" size=6 id="rsquare3" style="text-align: left;">&nbsp;</td>
          <td><input type="text" size=36 id="equation3" style="text-align: left;"></td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model4">&nbsp;&nbsp;<span data-msgid="SquareRoot"></span>
            </label> 
          </td>
	  <td><span class="fontmath">y = β<sub>0</sub> + β<sub>1</sub> √t </span></td>
          <td><input type="text" size=6 id="rsquare4" style="text-align: left;">&nbsp;</td>
          <td><input type="text" size=36 id="equation4" style="text-align: left;"></td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model5">&nbsp;&nbsp;<span data-msgid="Log"></span>
            </label> 
          </td>
	  <td><span class="fontmath">y = β<sub>0</sub> + β<sub>1</sub> log(t)</span></td>
          <td><input type="text" size=6 id="rsquare5" style="text-align: left;"></td>
          <td><input type="text" size=36 id="equation5" style="text-align: left;"></td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model6">&nbsp;&nbsp;<span data-msgid="Power"></span>
            </label> 
          </td>
	  <td><span class="fontmath">y = β<sub>0</sub> t <sup> β<sub>1</sub></sup></span></td>
          <td><input type="text" size=6 id="rsquare6" style="text-align: left;"></td>
          <td><input type="text" size=36 id="equation6" style="text-align: left;"></td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model7">&nbsp;&nbsp;<span data-msgid="Exponent"></span>
            </label> 
          </td>
	  <td><span class="fontmath">y = β<sub>0</sub> e <sup>(β<sub>1</sub> t)</span></sup></td>
          <td><input type="text" size=6 id="rsquare7" style="text-align: left;"></td>
          <td><input type="text" size=36 id="equation7" style="text-align: left;"></td>
	</tr>
	<tr>
 	  <td><button type="button" id="saveGraphU"><span class="tooltiptext" data-msgid="Graph Save">Graph Save</span></button></td>               
          <td><button type="button" id="createTable"><span class="tooltiptext" data-msgid="ForecastTable"></span></button></td>    
          <td><button type="button" id="saveTable"><span class="tooltiptext" data-msgid="SaveTable"></span></button></td>
	</tr>
      </table>
      <p>
         <div class="figText">&lt;Figure 13.4.1&gt; Korea GDP data and regression model</div>
      <p>
      <div> 
        <div id="screenTable" >
          <div id="loc">
          </div>
        </div>
      </div>
      <p>
    </div>
    <p>
    <!---   ************ html for Time Series - Regression Model ************  ---->
  <script>
      setLanguage('en');
      var svg     = d3.select("#chart"); 
      var i, r;
      var svgWidth    = 620;
      var svgHeight   = 400;
      var margin      = {top: 80, bottom: 50, left: 60, right: 60};
      var buffer      = 40;
      var graphWidth  = svgWidth - margin.left - margin.right;
      var graphHeight = svgHeight - margin.top - margin.bottom;
      var checkTitle  = true;
      var mTitle, yTitle, xTitle;
      var tobs, temp, temp1, temp2, model, str;
      var sst, sse, mse, rmse, alpha, tvalue, info;
      var nforecast = 0;
      var xobs, xmin, xmax, xgap, gxmin, gxmax, gxrange;
      var yobs, ymin, ymax, ygap, gymin, gymax, gyrange;
      var x1, x2, y1, y2;
      var fontsize = "1em";
      var stat1     = new Array(30);
      var stat2     = new Array(30);
      var stat3     = new Array(30);
      var stat4     = new Array(30);
      var stat5     = new Array(30);
      var stat6     = new Array(30);
      var stat7     = new Array(30);
      var beta2     = new Array(30);
      var beta3     = new Array(30);
      var tstat     = new Array(30);
      var rowmax    = 200;
      var tdata     = new Array(rowmax);
      var xdata     = new Array(rowmax);
      var ydata     = new Array(rowmax);
      var yhat      = new Array(rowmax);
      var ylog      = new Array(rowmax);
      var clow1     = new Array(rowmax);
      var clow2     = new Array(rowmax);
      var clow3     = new Array(rowmax);
      var clow4     = new Array(rowmax);
      var clow5     = new Array(rowmax);
      var clow6     = new Array(rowmax);
      var clow7     = new Array(rowmax);
      var chigh1    = new Array(rowmax);
      var chigh2    = new Array(rowmax);
      var chigh3    = new Array(rowmax);
      var chigh4    = new Array(rowmax);
      var chigh5    = new Array(rowmax);
      var chigh6    = new Array(rowmax);
      var chigh7    = new Array(rowmax);
      var checkModel    = new Array(10);
      var nvar      = 10;
      var X         = new Array(nvar)
      var sumX      = new Array(nvar)
      var invXPX    = new Array(nvar);
      for (j = 0; j < nvar; j++) {
        invXPX[j] = new Array(nvar);
      }
      var checkForecast = false;
      for (i=1; i<=7; i++) checkModel[i] = false;
      xTitle = "t";
      document.getElementById("nn41").disabled      = true;    
      document.getElementById("rsquare1").disabled  = true;    
      document.getElementById("rsquare2").disabled  = true;    
      document.getElementById("rsquare3").disabled  = true;       
      document.getElementById("rsquare4").disabled  = true;       
      document.getElementById("rsquare5").disabled  = true;       
      document.getElementById("rsquare6").disabled  = true;       
      document.getElementById("rsquare7").disabled  = true;       
      document.getElementById("equation1").disabled = true;    
      document.getElementById("equation2").disabled = true;    
      document.getElementById("equation3").disabled = true;       
      document.getElementById("equation4").disabled = true;       
      document.getElementById("equation5").disabled = true;       
      document.getElementById("equation6").disabled = true;       
      document.getElementById("equation7").disabled = true;
      svg.selectAll("*").remove();
      alpha = 0.05;
      // input data control ===================================================
      d3.select("#data2").on("input", function() {
        stat = simplestat("#data2");  
        ydata = data; 
        yobs = stat.n;
      });
      updateData = function() {
       document.getElementById("data2").value = '';    
      }
    
      // init example
      document.getElementById("data2").value = "330.65,355.53,392.67,463.62,566.58,610.17,569.76,383.33,497.51,576.18,547.66,627.25,702.72,793.18,934.9,1053.22,1172.61,1047.34,943.67,1143.98,1253.16,1278.43,1370.8,1484.32,1465.77,1499.36,1623.07,1725.37,1651.42,1638.26";
        stat = simplestat("#data2");  
        ydata = data; 
        yobs = stat.n;
      document.getElementById("mtitle").value = "GDP of Korea, 1991-2020";
      document.getElementById("ytitle").value = "billion US$";
  
      // erase Data and Graph
      d3.select("#erase").on("click",function() {
        svg.selectAll("*").remove();
        document.getElementById("data2").value  = "";
        document.getElementById("mtitle").value = "";
        document.getElementById("ytitle").value = "";
        document.getElementById("nn41").value   = "";
        document.getElementById("nn42").value   = "0";   
        document.getElementById("rsquare1").value  = "";    
        document.getElementById("rsquare2").value  = "";    
        document.getElementById("rsquare3").value  = "";       
        document.getElementById("rsquare4").value  = "";       
        document.getElementById("rsquare5").value  = "";       
        document.getElementById("rsquare6").value  = "";       
        document.getElementById("rsquare7").value  = "";       
        document.getElementById("equation1").value = "";    
        document.getElementById("equation2").value = "";    
        document.getElementById("equation3").value = "";       
        document.getElementById("equation4").value = "";       
        document.getElementById("equation5").value = "";       
        document.getElementById("equation6").value = "";       
        document.getElementById("equation7").value = "";
        document.getElementById("model1").checked  = false;
        document.getElementById("model2").checked  = false;
        document.getElementById("model3").checked  = false;
        document.getElementById("model4").checked  = false;
        document.getElementById("model5").checked  = false;
        document.getElementById("model6").checked  = false;
        document.getElementById("model7").checked  = false;
      })

      d3.select("#execute").on("click", function(){  
          clearExecute();
          for (i = 0; i < yobs; i++) {
              tdata[i] = i + 1;   
              xdata[i] = tdata[i];
          }
          tobs = yobs;
          // 입력 도수에 숫자 문자 빈칸 있나 체크
          for (i=0; i<tobs; i++) {
            if ( isNaN(ydata[i]) ) {
              svg.append("text").attr("class","mean").attr("x", 250).attr("y", margin.top + 40)
                 .text(alertMsg[48][langNum]).style("stroke","red").style("font-size","1em");
              return;
            }
          }
          // title
          mTitle = d3.select("#mtitle").node().value;
          yTitle = d3.select("#ytitle").node().value;
          // 시계열그림
          nforecast = 0;
          model1Stat(tobs, tdata, tdata, ydata, stat1);
          sst = stat1[20];
          document.getElementById("nn41").value   = yobs;
          initialCordinate(tobs, xdata, ydata);    
          model = 1;
          showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
      })
      // svg Graph Save
      d3.select("#saveGraphU").on("click", function() {
        var svg = d3.select("#chart");
        var width = svgWidth;
        var height = svgHeight;
        var svgString = getSVGString(svg.node());
        svgString2Image(svgString, width, height, 'png', save);
        function save(dataBlob, filesize) {
          saveAs(dataBlob, 'eStatGraphU.png');
        }
      });
      // create Table
      d3.select("#createTable").on("click", function() {
          if ( nforecast == 0 ) {alert("Enter forecasting period"); return;}
          if ( checkModel[1] ) {
            for (j=0; j<30; j++) tstat[j] = stat1[j];
            forecastTable(1, tobs, nforecast, tstat, clow1, chigh1);  
          }
          if ( checkModel[2] ) {
            for (j=0; j<30; j++) tstat[j] = beta2[j];
            forecastTable(2, tobs, nforecast, tstat, clow2, chigh2);  
          }
          if ( checkModel[3] ) {
            for (j=0; j<30; j++) tstat[j] = beta3[j];
            forecastTable(3, tobs, nforecast, tstat, clow3, chigh3);  
          }
          if ( checkModel[4] ) {
            for (j=0; j<30; j++) tstat[j] = stat4[j];
            forecastTable(4, tobs, nforecast, tstat, clow4, chigh4);  
          }
          if ( checkModel[5] ) {
            for (j=0; j<30; j++) tstat[j] = stat5[j];
            forecastTable(5, tobs, nforecast, tstat, clow5, chigh5);  
          }
          if ( checkModel[6] ) {
            for (j=0; j<30; j++) tstat[j] = stat6[j];
            forecastTable(6, tobs, nforecast, tstat, clow6, chigh6);  
          }
          if ( checkModel[7] ) {
            for (j=0; j<30; j++) tstat[j] = stat7[j];
            forecastTable(7, tobs, nforecast, tstat, clow7, chigh7);            
          }
      });
      // save Table
      d3.select("#saveTable").on("click", function() {
        head = '<html><head><meta charset="UTF-8"></head><body>';
        tail = '</body></html>';
        saveAs(new Blob([head + d3.select("#screenTable").html() + tail]), "eStatULog.html");
      });

      // 회귀선 그리기
      d3.select("#model1").on("click",function() {
          if(this.checked) {
            model = 1;
            checkModel[model] = true;
            drawModel1()
          } else {
	    removeRegression1();
          }
      })
      d3.select("#model2").on("click",function() {
          if(this.checked) {
            model = 2;
            checkModel[model] = true;
            drawModel2();
          } else {
	    removeRegression2();
          }
      })
      d3.select("#model3").on("click",function() {
          if(this.checked) {
            model = 3;
            checkModel[model] = true;
            drawModel3();
          } else {
	    removeRegression3();
          }
      })
      // Model4: y = a + b * sqrt(t) 
      d3.select("#model4").on("click",function() {
          if(this.checked) {
            model = 4;
            checkModel[model] = true;
            drawModel4();
          } else {
	    removeRegression4();
          }
      })
      // Model5: y = a + b * ln(t) 
      d3.select("#model5").on("click",function() {
          if(this.checked) {
            model = 5;
            checkModel[model] = true;
            drawModel5();
          } else {
	    removeRegression5();
          }
      })
      // Model6: y = a t^b  =>  ln(y) = ln(a) + b * ln(t) 
      d3.select("#model6").on("click",function() {
          if(this.checked) {
            model = 6;
            checkModel[model] = true;
            drawModel6();
          } else {
	    removeRegression6();
          }
      })
      // Model7: y = a e^(bt)  =>  ln(y) = ln(a) + b t 
      d3.select("#model7").on("click",function() {
          if(this.checked) {
            model = 7;
            checkModel[model] = true;
            drawModel7();
          } else {
	    removeRegression7();
          }
      })

function drawModel1() {
        for (i=0; i<tobs; i++) xdata[i] = tdata[i];  
        model1Stat(tobs, tdata, xdata, ydata, stat1);           
        for (i=tobs; i<tobs+nforecast; i++) tdata[i] = i+1;
        for (i=tobs; i<tobs+nforecast; i++) ydata[i] = stat1[7] + stat1[8]*tdata[i];
        showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
        if (nforecast > 0) {
            // confidence interval
            temp1 = stat1[21];   // Sxx
            df = tobs - 2;
            tvalue = t_inv(1-alpha/2, df, info);
            for (i=tobs; i<tobs+nforecast; i++) {
               temp2 = tdata[i] - (tobs+1)/2;
               temp = tvalue * stat1[24] * Math.sqrt(1/tobs + temp2*temp2/temp1)
               clow1[i]  = ydata[i] - temp;
               chigh1[i] = ydata[i] + temp;
            }
        }
        showModel1(model, tobs, nforecast, stat1, clow1, chigh1, checkTitle);
        document.getElementById("rsquare1").value = "r\u00B2 = " + f4(stat1[10]);    
        document.getElementById("equation1").value = "y = ("+f4(stat1[7])+") + ("+f4(stat1[8])+")t";  
}
function drawModel2() {
            var nindep = 3;
            statRegression(nindep, tobs, ydata, beta2, stat2);
            beta2[10] = stat2[13];
            for (i=tobs; i<tobs+nforecast; i++) tdata[i] = i+1;
            for (i=tobs; i<tobs+nforecast; i++) ydata[i] = beta2[0] + beta2[1]*tdata[i] + beta2[2]*tdata[i]*tdata[i];
            showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
        if (nforecast > 0) {
            // confidence interval
            df = tobs - 3;
            tvalue = t_inv(1-alpha/2, df, info);
            // x' (X'X)^-1 x
            for (i=tobs; i<tobs+nforecast; i++) {
              X[0] = 1;
              X[1] = tdata[i];
              X[2] = tdata[i]*tdata[i]; 
              for (j=0; j<nindep; j++) {
                sumX[j] = 0;
                for (k=0; k<nindep; k++) {
                  sumX[j] += X[k]*invXPX[k][j];
                }
              }
              temp = 0;
              for (j=0; j<nindep; j++) {
                temp += sumX[j]*X[j];
              }
              temp1 = tvalue * Math.sqrt(stat2[8]*temp);
              clow2[i]  = ydata[i] - temp1;
              chigh2[i] = ydata[i] + temp1;
            }
        }
        showModel2(model, tobs, nforecast, beta2, clow2, chigh2, checkTitle);
        document.getElementById("rsquare2").value = "r\u00B2 = " + f4(stat2[13]);    
        document.getElementById("equation2").value = "y = ("+f4(beta2[0])+") + ("+f4(beta2[1])+")t +("+f4(beta2[2])+")t\u00B2";  
}
function drawModel3() {
            var nindep = 4;
            statRegression(nindep, tobs, ydata, beta3, stat3);
            beta3[10] = stat3[13];
            for (i=tobs; i<tobs+nforecast; i++) tdata[i] = i+1;
            for (i=tobs; i<tobs+nforecast; i++) ydata[i] = beta3[0] + beta3[1]*tdata[i] + beta3[2]*tdata[i]*tdata[i] + beta3[3]*tdata[i]*tdata[i]*tdata[i];
            showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
        if (nforecast > 0) {
            // confidence interval
            df = tobs - 4;
            tvalue = t_inv(1-alpha/2, df, info);
            // x' (X'X)^-1 x
            for (i=tobs; i<tobs+nforecast; i++) {
              X[0] = 1;
              X[1] = tdata[i];
              X[2] = tdata[i]*tdata[i]; 
              X[3] = X[2]*tdata[i];
              for (j=0; j<nindep; j++) {
                sumX[j] = 0;
                for (k=0; k<nindep; k++) {
                  sumX[j] += X[k]*invXPX[k][j];
                }
              }
              temp = 0;
              for (j=0; j<nindep; j++) {
                temp += sumX[j]*X[j];
              }
              temp1 = tvalue * Math.sqrt(stat3[8]*temp);
              clow3[i]  = ydata[i] - temp1;
              chigh3[i] = ydata[i] + temp1;
            }
        }
        showModel3(model, tobs, nforecast, beta3, clow3, chigh3, checkTitle);
        document.getElementById("rsquare3").value = "r\u00B2 = " + f4(stat3[13]);    
        document.getElementById("equation3").value = "y=("+f4(beta3[0])+")+("+f4(beta3[1])+")t+("+f4(beta3[2])+")t\u00B2+("+f4(beta3[3])+")t\u00B3";  
}
function drawModel4() {
        for (i=0; i<tobs; i++) xdata[i] = Math.sqrt(tdata[i])  
        model1Stat(tobs, tdata, xdata, ydata, stat4);
        for (i=tobs; i<tobs+nforecast; i++) tdata[i] = i+1;
        for (i=tobs; i<tobs+nforecast; i++) ydata[i] = stat4[7] + stat4[8]*Math.sqrt(tdata[i]);
        showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
        if (nforecast > 0) {
            // confidence interval
            temp1 = stat4[21]; // Sxx
            df = tobs - 2;
            tvalue = t_inv(1-alpha/2, df, info);
            for (i=tobs; i<tobs+nforecast; i++) {
               temp2 = Math.sqrt(tdata[i]) - stat4[1];
               temp = tvalue * stat4[24] * Math.sqrt(1/tobs + temp2*temp2/temp1)
               clow4[i]  = ydata[i] - temp;
               chigh4[i] = ydata[i] + temp;
            }
        }
        showModel4(model, tobs, nforecast, stat4, clow4, chigh4, checkTitle);
        document.getElementById("rsquare4").value  = "r\u00B2 = " + f4(stat4[10]);    
        document.getElementById("equation4").value = "y = ("+f4(stat4[7])+") + ("+f4(stat4[8])+") √t";  
}
function drawModel5() {
        for (i=0; i<tobs; i++) xdata[i] = Math.log(tdata[i])  
        model1Stat(tobs, tdata, xdata, ydata, stat5);
        for (i=tobs; i<tobs+nforecast; i++) tdata[i] = i+1;
        for (i=tobs; i<tobs+nforecast; i++) ydata[i] = stat5[7] + stat5[8]*Math.log(tdata[i]);
        showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
        if (nforecast > 0) {
            // confidence interval
            temp1 = stat5[21]; // Sxx
            df = tobs - 2;
            tvalue = t_inv(1-alpha/2, df, info);
            for (i=tobs; i<tobs+nforecast; i++) {
               temp2 = Math.log(tdata[i]) - stat5[1];
               temp = tvalue * stat5[24] * Math.sqrt(1/tobs + temp2*temp2/temp1)
               clow5[i]  = ydata[i] - temp;
               chigh5[i] = ydata[i] + temp;
            }
        }
        showModel5(model, tobs, nforecast, stat5, clow5, chigh5, checkTitle);
        document.getElementById("rsquare5").value  = "r\u00B2 = " + f4(stat5[10]);    
        document.getElementById("equation5").value = "y = ("+f4(stat5[7])+") + ("+f4(stat5[8])+") ln(t)"; 
}
function drawModel6() {
            for (i=0; i<tobs; i++) {
              xdata[i] = Math.log(tdata[i]);
              ylog[i]  = Math.log(ydata[i]);
            }
            model1Stat(tobs, tdata, xdata, ylog, stat6);
            sse = 0;
            for (i=0; i<tobs; i++) {
              temp = ydata[i] - Math.exp(stat6[7]) * Math.pow(tdata[i],stat6[8]);  
              sse += temp * temp;
            }
            stat6[10] = 1 - sse/sst;
            for (i=tobs; i<tobs+nforecast; i++) tdata[i] = i+1;
            for (i=tobs; i<tobs+nforecast; i++) ydata[i] = Math.exp(stat6[7]) * Math.pow(tdata[i],stat6[8]);
            showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
        if (nforecast > 0) {
            // confidence interval
            temp1 = stat6[21]; // Sxx
            df = tobs - 2;
            tvalue = t_inv(1-alpha/2, df, info);
            for (i=tobs; i<tobs+nforecast; i++) {
               temp2 = Math.log(tdata[i]) - stat6[1];
               temp  = tvalue * stat6[24] * Math.sqrt(1/tobs + temp2*temp2/temp1)
               clow6[i]  = Math.exp( stat6[7] + stat6[8]*Math.log(tdata[i]) - temp );
               chigh6[i] = Math.exp( stat6[7] + stat6[8]*Math.log(tdata[i]) + temp );
            }
        }
        showModel6(model, tobs, nforecast, stat6, clow6, chigh6, checkTitle);
        document.getElementById("rsquare6").value  = "r\u00B2 = " + f4(stat6[10]);    
        document.getElementById("equation6").value = "y = ("+f4(Math.exp(stat6[7]))+") t ^ ("+f4(stat6[8])+")"; 
}
function drawModel7() {
            for (i=0; i<tobs; i++) {
              xdata[i] = tdata[i];  
              ylog[i]  = Math.log(ydata[i])  
            }
            model1Stat(tobs, tdata, xdata, ylog, stat7);
            sse = 0;
            for (i=0; i<tobs; i++) {
              temp = ydata[i] - Math.exp(stat7[7]) * Math.exp(stat7[8]*tdata[i]); 
              sse += temp * temp;
            }
            stat7[10] = 1 - sse/sst;
            for (i=tobs; i<tobs+nforecast; i++) tdata[i] = i+1;
            for (i=tobs; i<tobs+nforecast; i++) ydata[i] = Math.exp(stat7[7]) * Math.exp(stat7[8]*tdata[i]);
            showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
        if (nforecast > 0) {
            // confidence interval
            temp1 = stat7[21]; // Sxx
            df = tobs - 2;
            tvalue = t_inv(1-alpha/2, df, info);
            for (i=tobs; i<tobs+nforecast; i++) {
               temp2 = tdata[i] - stat7[1];
               temp  = tvalue * stat7[24] * Math.sqrt(1/tobs + temp2*temp2/temp1)
               clow7[i]  = Math.exp( stat7[7] + stat7[8]*tdata[i] - temp );
               chigh7[i] = Math.exp( stat7[7] + stat7[8]*tdata[i] + temp );
            }
        }
        showModel7(model, tobs, nforecast, stat7, clow7, chigh7, checkTitle);
        document.getElementById("rsquare7").value  = "r\u00B2 = " + f4(stat7[10]);    
        document.getElementById("equation7").value = "y = ("+f4(Math.exp(stat7[7]))+") exp( "+f4(stat7[8])+" t )";    
}
// 회귀선 그리기 함수
function showModel1(model, tobs, nforecast, stat, clow, chigh, checkTitle) {
     var cx, cy, x1, y1, x2, y2;
     // confidence interval
     confidenceBand(model, tobs, nforecast, clow, chigh);
     // forecast
     for (i=tobs; i<tobs+nforecast; i++) {
          cx = margin.left+graphWidth*(tdata[i]-gxmin)/gxrange;
          cy = margin.top+graphHeight-graphHeight*(stat[7]+stat[8]*tdata[i]-gymin)/gyrange; 
          svg.append("circle").attr("class","reglabel1")
             .attr("cx", cx)
             .attr("cy", cy)         
             .attr("r", 3)
             .style("fill",myColor[1])
     }
     x1  = margin.left + graphWidth*(stat[3]-gxmin)/gxrange;
     y1  = margin.top  + graphHeight - graphHeight*((stat[7]+stat[8]*stat[3])-gymin)/gyrange;
     x2  = margin.left + graphWidth*(xmax-gxmin)/gxrange;
     y2  = margin.top  + graphHeight - graphHeight*((stat[7]+stat[8]*xmax)-gymin)/gyrange;
     svg.append("line").attr("class","reglabel1")
                .attr("x1",x1)
                .attr("y1",y1)
                .attr("x2",x2)
                .attr("y2",y2)
                .style("stroke",myColor[1]) 
     if(checkTitle) {   
        svg.append("text").attr("class","reglabel1")
                .attr("x", margin.left + 20)
                .attr("y", margin.top +  20)
                .text("y = ("+f4(stat[7])+") + ("+f4(stat[8])+ ") t , " + " r\u00B2 = "+f4(stat[10]))
                .style("stroke",myColor[1]) 
     }
}
function showModel2(model, tobs, nforecast, stat, clow, chigh, checkTitle) {
     var cx, cy;
     // confidence interval
     confidenceBand(model, tobs, nforecast, clow, chigh);
     for (i=tobs; i<tobs+nforecast; i++) {
          cx = margin.left+graphWidth*(tdata[i]-gxmin)/gxrange;
          cy = margin.top+graphHeight-graphHeight*(stat[0]+stat[1]*tdata[i]+ stat[2]*tdata[i]*tdata[i]-gymin)/gyrange; 
          svg.append("circle").attr("class","reglabel2")
             .attr("cx", cx)
             .attr("cy", cy)         
             .attr("r", 3)
             .style("fill",myColor[1])
     }
     var ninterval = 100;
     var gxgap     = (tobs + nforecast) / ninterval;
     var x1, y1, x2, y2, temp;
     x1  = margin.left + graphWidth*(1-gxmin)/gxrange;
     y1  = margin.top  + graphHeight - graphHeight*((stat[0]+stat[1]*1+ stat[2]*1*1 )-gymin)/gyrange;
     temp = 1;
     for (i = 1; i < ninterval-6; i++) {
          temp += gxgap;
          x2  = margin.left + graphWidth*(temp-gxmin)/gxrange;
          y2  = margin.top  + graphHeight - graphHeight*((stat[0]+stat[1]*temp+stat[2]*temp*temp)-gymin)/gyrange;
          svg.append("line").attr("class","reglabel2")
                .attr("x1",x1)
                .attr("y1",y1)
                .attr("x2",x2)
                .attr("y2",y2)
                .style("stroke",myColor[2]) 
          x1 = x2;
          y1 = y2;
     }
     if(checkTitle) {   
        svg.append("text").attr("class","reglabel2")
                .attr("x", margin.left + 20)
                .attr("y", margin.top +  40)
                .text("y = ("+f4(stat[0])+") + ("+ f4(stat[1])+ ")t +("+ f4(stat[2])+")t\u00B2 , " + " r\u00B2 = "+f4(stat[10]))
                .style("stroke",myColor[2]) 
     }
}
function showModel3(model, tobs, nforecast, stat, clow, chigh, checkTitle) {
     var cx, cy;
     // confidence interval
     confidenceBand(model, tobs, nforecast, clow, chigh);
     for (i=tobs; i<tobs+nforecast; i++) {
          cx = margin.left+graphWidth*(tdata[i]-gxmin)/gxrange;
          cy = margin.top+graphHeight-graphHeight*(stat[0]+stat[1]*tdata[i]+ stat[2]*tdata[i]*tdata[i] + stat[3]*tdata[i]*tdata[i]*tdata[i] -gymin)/gyrange; 
          svg.append("circle").attr("class","reglabel3")
             .attr("cx", cx)
             .attr("cy", cy)         
             .attr("r", 3)
             .style("fill",myColor[1])
     }
     var ninterval = 100;
     var gxgap     = gxrange / ninterval;
     var x1, y1, x2, y2, temp;
     x1  = margin.left + graphWidth*(1-gxmin)/gxrange;
     y1  = margin.top  + graphHeight - graphHeight*((stat[0]+stat[1]*1+ stat[2]*1*1 + stat[3] )-gymin)/gyrange;
     for (i = 1; i < ninterval-6; i++) {
          temp = 1+i*gxgap;
          x2  = margin.left + graphWidth*(temp-gxmin)/gxrange;
          y2  = margin.top  + graphHeight - graphHeight*((stat[0]+stat[1]*temp+stat[2]*temp*temp+stat[3]*temp*temp*temp)-gymin)/gyrange;
          svg.append("line").attr("class","reglabel3")
                .attr("x1",x1)
                .attr("y1",y1)
                .attr("x2",x2)
                .attr("y2",y2)
                .style("stroke",myColor[3]) 
          x1 = x2;
          y1 = y2;
     }
     if(checkTitle) {   
        svg.append("text").attr("class","reglabel3")
                .attr("x", margin.left + 20)
                .attr("y", margin.top +  60)
                .text("y = ("+f4(stat[0])+") + ("+ f4(stat[1])+ ")t +("+ f4(stat[2])+")t\u00B2 "+f4(stat[3])+")t\u00B3 , " + " r\u00B2 = "+f4(stat[10]))
                .style("stroke",myColor[3]) 
     }
}
function showModel4(model, tobs, nforecast, stat, clow, chigh, checkTitle){
     var cx, cy;
     // confidence interval
     confidenceBand(model, tobs, nforecast, clow, chigh);
     // forecast value
     for (i=tobs; i<tobs+nforecast; i++) {
          cx = margin.left+graphWidth*(tdata[i]-gxmin)/gxrange;
          cy = margin.top+graphHeight-graphHeight*(stat[7]+stat[8]*Math.sqrt(tdata[i])-gymin)/gyrange; 
          svg.append("circle").attr("class","reglabel4")
             .attr("cx", cx)
             .attr("cy", cy)         
             .attr("r", 3)
             .style("fill",myColor[1])
     }
     var ninterval = 100;
     var gxgap     = gxrange / ninterval;
     var x1, y1, x2, y2;
     x1  = margin.left + graphWidth*(stat[3]-gxmin)/gxrange;
     y1  = margin.top  + graphHeight - graphHeight*((stat[7]+stat[8]*Math.sqrt(stat[3]))-gymin)/gyrange;
     for (i = 1; i < ninterval-6; i++) {
          x2  = margin.left + graphWidth*(stat[3]+i*gxgap-gxmin)/gxrange;
          y2  = margin.top  + graphHeight - graphHeight*((stat[7]+stat[8]*Math.sqrt(stat[3]+i*gxgap))-gymin)/gyrange;
          svg.append("line").attr("class","reglabel4")
                .attr("x1",x1)
                .attr("y1",y1)
                .attr("x2",x2)
                .attr("y2",y2)
                .style("stroke",myColor[4]) 
          x1 = x2;
          y1 = y2;
     }
     if(checkTitle) {   
        svg.append("text").attr("class","reglabel4")
                .attr("x", margin.left + 20)
                .attr("y", margin.top +  80)
                .text("y = ("+f4(stat[7])+") + ("+ f4(stat[8])+ ") √ t , " + " r\u00B2 = "+f4(stat[10]))
                .style("stroke",myColor[4]) 
     }
}
function showModel5(model, tobs, nforecast, stat, clow, chigh, checkTitle) {
     var cx, cy;
     // confidence interval
     confidenceBand(model, tobs, nforecast, clow, chigh);
     for (i=tobs; i<tobs+nforecast; i++) {
          cx = margin.left+graphWidth*(tdata[i]-gxmin)/gxrange;
          cy = margin.top+graphHeight-graphHeight*(stat[7]+stat[8]*Math.log(tdata[i])-gymin)/gyrange; 
          svg.append("circle").attr("class","reglabel5")
             .attr("cx", cx)
             .attr("cy", cy)         
             .attr("r", 3)
             .style("fill",myColor[1])
     }
     var ninterval = 100;
     var gxgap     = gxrange / ninterval;
     var x1, y1, x2, y2;
     x1  = margin.left + graphWidth*(stat[3]-gxmin)/gxrange;
     y1  = margin.top  + graphHeight - graphHeight*((stat[7]+stat[8]*Math.log(stat[3]))-gymin)/gyrange;
     for (i = 1; i < ninterval-6; i++) {
          x2  = margin.left + graphWidth*(stat[3]+i*gxgap-gxmin)/gxrange;
          y2  = margin.top  + graphHeight - graphHeight*((stat[7]+stat[8]*Math.log(stat[3]+i*gxgap))-gymin)/gyrange;
          svg.append("line").attr("class","reglabel5")
                .attr("x1",x1)
                .attr("y1",y1)
                .attr("x2",x2)
                .attr("y2",y2)
                .style("stroke",myColor[5]) 
          x1 = x2;
          y1 = y2;
     }
     if(checkTitle) {   
        svg.append("text").attr("class","reglabel5")
                .attr("x", margin.left + 20)
                .attr("y", margin.top +  100)
                .text("y = ("+f4(stat[7])+") + ("+ f4(stat[8])+ ") log(t) , " + " r\u00B2 = "+f4(stat[10]))
                .style("stroke",myColor[5]) 
     }
}
function showModel6(model, tobs, nforecast, stat, clow, chigh, checkTitle) {
     var cx, cy;
     // confidence interval
     confidenceBand(model, tobs, nforecast, clow, chigh);
     for (i=tobs; i<tobs+nforecast; i++) {
          cx = margin.left+graphWidth*(tdata[i]-gxmin)/gxrange;
          cy = margin.top+graphHeight-graphHeight*(Math.exp(stat[7])*Math.pow(tdata[i],stat[8])-gymin)/gyrange; 
          svg.append("circle").attr("class","reglabel6")
             .attr("cx", cx)
             .attr("cy", cy)         
             .attr("r", 3)
             .style("fill",myColor[1])
     }
     var ninterval = 100;
     var gxgap     = gxrange / ninterval;
     var x1, y1, x2, y2;
     x1  = margin.left + graphWidth*(stat[3]-gxmin)/gxrange;
     y1  = margin.top  + graphHeight - graphHeight*(Math.exp(stat[7])*Math.pow(stat[3],stat[8])-gymin)/gyrange;
     for (i = 1; i < ninterval-6; i++) {
          x2  = margin.left + graphWidth*(stat[3]+i*gxgap-gxmin)/gxrange;
          y2  = margin.top  + graphHeight - graphHeight*(Math.exp(stat[7])*Math.pow(stat[3]+i*gxgap,stat[8])-gymin)/gyrange;
          svg.append("line").attr("class","reglabel6")
                .attr("x1",x1)
                .attr("y1",y1)
                .attr("x2",x2)
                .attr("y2",y2)
                .style("stroke",myColor[6]) 
          x1 = x2;
          y1 = y2;
     }
     if(checkTitle) {   
        svg.append("text").attr("class","reglabel6")
                .attr("x", margin.left + 20)
                .attr("y", margin.top +  120)
                .text("y = ("+f4(Math.exp(stat[7]))+") * t ^("+ f4(stat[8])+ ") , " + " r\u00B2 = "+f4(stat[10]))
                .style("stroke",myColor[6]) 
     }
}

function showModel7(model, tobs, nforecast, stat, clow, chigh, checkTitle) {
     var cx, cy;
     // confidence interval
     confidenceBand(model, tobs, nforecast, clow, chigh);
     for (i=tobs; i<tobs+nforecast; i++) {
          cx = margin.left+graphWidth*(tdata[i]-gxmin)/gxrange;
          cy = margin.top+graphHeight-graphHeight*(Math.exp(stat[7])*Math.exp(stat[8]*tdata[i])-gymin)/gyrange; 
          svg.append("circle").attr("class","reglabel7")
             .attr("cx", cx)
             .attr("cy", cy)         
             .attr("r", 3)
             .style("fill",myColor[1])
     }
     var ninterval = 100;
     var gxgap     = gxrange / ninterval;
     var x1, y1, x2, y2;
     x1  = margin.left + graphWidth*(stat[3]-gxmin)/gxrange;
     y1  = margin.top  + graphHeight - graphHeight*(Math.exp(stat[7])*Math.exp(stat[8]*(stat[3]))-gymin)/gyrange;
     for (i = 1; i < ninterval-6; i++) {
          x2  = margin.left + graphWidth*(stat[3]+i*gxgap-gxmin)/gxrange;
          y2  = margin.top  + graphHeight - graphHeight*(Math.exp(stat[7])*Math.exp(stat[8]*(stat[3]+i*gxgap))-gymin)/gyrange;
          svg.append("line").attr("class","reglabel7")
                .attr("x1",x1)
                .attr("y1",y1)
                .attr("x2",x2)
                .attr("y2",y2)
                .style("stroke",myColor[7]) 
          x1 = x2;
          y1 = y2;
     }
     if(checkTitle) {   
        svg.append("text").attr("class","reglabel7")
                .attr("x", margin.left + 20)
                .attr("y", margin.top +  140)
                .text("y = ("+f4(Math.exp(stat[7]))+") + * exp("+ f4(stat[8])+ " t ), " + " r\u00B2 = "+f4(stat[10]))
                .style("stroke",myColor[7]) 
     }
}
// Remove Regression Line of Simulation
function clearExecute() {
     svg.selectAll("*").remove();
     document.getElementById("model1").checked=false;
     document.getElementById("model2").checked=false;
     document.getElementById("model3").checked=false;
     document.getElementById("model4").checked=false;
     document.getElementById("model5").checked=false;
     document.getElementById("model6").checked=false;
     document.getElementById("model7").checked=false;
     for (i=1; i<=7; i++) checkModel[i] = false;
     document.getElementById("nn42").value = 0;
     removeRegression1();
     removeRegression2();
     removeRegression3();
     removeRegression4();
     removeRegression5();
     removeRegression6();
     removeRegression7();
}
function clearScreen(){
     svg.selectAll("*").remove();
     nforecast = parseFloat(d3.select("#nn42").node().value);

     for (i=0; i<tobs; i++) xdata[i] = tdata[i];  
     model1Stat(tobs, tdata, xdata, ydata, stat1);
     for (i=tobs; i<tobs+nforecast; i++) {
       tdata[i] = i+1;
       xdata[i] = tdata[i];
       ydata[i] = stat1[7] + stat1[8]*tdata[i];
     }
     initialCordinate(tobs+nforecast, tdata, ydata);
     model = 1;
     showTimeSeriesPlot(model, tobs, nforecast, tdata, ydata, checkTitle);
     if ( checkModel[1] ) drawModel1(stat1, checkTitle);
     if ( checkModel[2] ) drawModel2(stat1, checkTitle);
     if ( checkModel[3] ) drawModel3(stat1, checkTitle);
     if ( checkModel[4] ) drawModel4(stat1, checkTitle);
     if ( checkModel[5] ) drawModel5(stat1, checkTitle);
     if ( checkModel[6] ) drawModel6(stat1, checkTitle);
     if ( checkModel[7] ) drawModel7(stat1, checkTitle);
}

function removeRegression1() {
     checkModel[1] = false;
     document.getElementById("rsquare1").value  = "";    
     document.getElementById("equation1").value = "";    
     svg.selectAll("circle.reglabel1").remove();
     svg.selectAll("line.reglabel1").remove();
     svg.selectAll("text.reglabel1").remove();
     svg.selectAll("path.reglabel1").remove();
     svg.selectAll("circle.forecast1").remove();
}
function removeRegression2() {
     checkModel[2] = false;
     document.getElementById("rsquare2").value  = "";    
     document.getElementById("equation2").value = "";    
     svg.selectAll("circle.reglabel2").remove();
     svg.selectAll("line.reglabel2").remove();
     svg.selectAll("text.reglabel2").remove();
     svg.selectAll("path.reglabel2").remove();
     svg.selectAll("circle.forecast2").remove();
}
function removeRegression3() {
     checkModel[3] = false;
     document.getElementById("rsquare3").value  = "";    
     document.getElementById("equation3").value = "";    
     svg.selectAll("circle.reglabel3").remove();
     svg.selectAll("line.reglabel3").remove();
     svg.selectAll("text.reglabel3").remove();
     svg.selectAll("path.reglabel3").remove();
     svg.selectAll("circle.forecast3").remove();
}
function removeRegression4() {
     checkModel[4] = false;
     document.getElementById("rsquare4").value  = "";    
     document.getElementById("equation4").value = "";    
     svg.selectAll("circle.reglabel4").remove();
     svg.selectAll("line.reglabel4").remove();
     svg.selectAll("text.reglabel4").remove();
     svg.selectAll("path.reglabel4").remove();
     svg.selectAll("circle.forecast4").remove();
}
function removeRegression5() {
     checkModel[5] = false;
     document.getElementById("rsquare5").value  = "";    
     document.getElementById("equation5").value = "";    
     svg.selectAll("circle.reglabel5").remove();
     svg.selectAll("line.reglabel5").remove();
     svg.selectAll("text.reglabel5").remove();
     svg.selectAll("path.reglabel5").remove();
     svg.selectAll("circle.forecast5").remove();
}
function removeRegression6() {
     checkModel[6] = false;
     document.getElementById("rsquare6").value  = "";    
     document.getElementById("equation6").value = "";    
     svg.selectAll("circle.reglabel6").remove();
     svg.selectAll("line.reglabel6").remove();
     svg.selectAll("text.reglabel6").remove();
     svg.selectAll("path.reglabel6").remove();
     svg.selectAll("circle.forecast6").remove();
}
function removeRegression7() {
     checkModel[7] = false;
     document.getElementById("rsquare7").value  = "";    
     document.getElementById("equation7").value = "";    
     svg.selectAll("circle.reglabel7").remove();
     svg.selectAll("line.reglabel7").remove();
     svg.selectAll("text.reglabel7").remove();
     svg.selectAll("path.reglabel7").remove();
     svg.selectAll("circle.forecast7").remove();
}
function forecastTable(model, nobs, nforecast, stat, clow, chigh) {
    var screenTable = document.getElementById("screenTable");
    var table = document.createElement('table');
    loc.appendChild(table);
    var row, header;
    var i, j, k, strModel, temp;
    var ncol = 3;
    var cell = new Array(4);
    table.style.fontSize = "13px";
    switch (model) {
      case 1:
        strModel = "y = "+f4(stat[7])+" + "+f4(stat[8])+" t";
        break;
      case 2:
        strModel = "y = "+f4(stat[0])+" + "+f4(stat[1])+" t +"+f4(stat[2])+" t\u00B2";
        break;
      case 3:
        strModel = "y = "+f4(stat[0])+" + "+f4(stat[1])+" t +"+f4(stat[2])+" t\u00B2"+f4(stat[3])+" t\u00B3";
        break;
      case 4:
        strModel = "y = "+f4(stat[7])+" + "+f4(stat[8])+" √t";
        break;
      case 5:
        strModel = "y = "+f4(stat[7])+" + "+f4(stat[8])+" ln(t)";
        break;
      case 6:
        strModel = "y = "+f4(stat[7])+" t^("+f4(stat[8])+")";
        break;
      case 7:
        strModel = "y = "+f4(stat[7])+" exp("+f4(stat[8])+" t)";
        break;
    }

    k = 0;
    row = table.insertRow(k++);
    row.style.height ="30px";
    for (j=0; j<ncol; j++) {
      cell[j] = row.insertCell(j);
      cell[j].style.textAlign = "center";
      cell[j].style.border = "1px solid black";
    }
    cell[0].innerHTML = "<b>"+svgStrU[127][langNum]+"</b> "+model;
    cell[1].innerHTML = strModel;
    cell[0].style.width ="70px";
    cell[1].style.width ="150px";
    cell[2].style.width ="200px";

    row  = table.insertRow(k++);
    row.style.height ="25px";
    for (j=0; j<ncol; j++) {
            cell[j] = row.insertCell(j);
            cell[j].style.backgroundColor = "#eee";
            cell[j].style.textAlign = "center";
            cell[j].style.border = "1px solid black";
    }
    cell[0].innerHTML = "<b>t</b>";
    cell[1].innerHTML = "Y "+ svgStr[84][langNum]; // predicted value
    cell[2].innerHTML = "95% "+svgStrU[20][langNum];  // confidence interval

    for (i=nobs+1; i<=nobs+nforecast; i++) {
       row = table.insertRow(k++);
       for (j=0; j<ncol; j++) {
              cell[j] = row.insertCell(j)          
              cell[j].style.textAlign = "center";
              cell[j].style.border = "1px solid black";
       }
       cell[0].innerHTML = i;
       switch (model) {
         case 1:
           temp = stat[7] + stat[8]*i;
           break;
         case 2:
           temp = stat[0] + stat[1]*i + stat[2]*i*i; 
           break;
         case 3:
           temp = stat[0] + stat[1]*i + stat[2]*i*i + stat[3]*i*i*i; 
           break;
         case 4:
           temp = stat[7] + stat[8]*Math.sqrt(i);
           break;
         case 5:
           temp = stat[7] + stat[8]*Math.log(i);
           break;
         case 6:
           temp = Math.exp(stat[7]) * Math.pow(i, stat[8]);
           break;
         case 7:
           temp = Math.exp(stat[7]) * Math.exp(stat[8]*i);
           break;
       }
       cell[1].innerHTML = f4(temp);
       cell[2].innerHTML = "( "+f4(clow[i-1])+ " , "+f4(chigh[i-1])+ ")";
       cell[0].style.backgroundColor = "#eee";
       cell[0].style.textAlign = "center";
    }
}

// Multiple Linear Regression for polynomial
function statRegression(numVar, prow, ydata, Beta, statF) {
    var i, j, k, nAug;
    var temp, tempx, tempy, sum;
    var SSR, SSE, SST, MSE, info, multpleR, stdErr;
    var avgY, avgYhat, avgResid, SSYH;
    var nAug = 2 * numVar;
    var X = new Array(prow); // 2차원 행렬
    var Y = new Array(prow);
    var yhat        = new Array(prow);
    var residual    = new Array(prow);
    var stdResidual = new Array(prow);
    var Hii         = new Array(prow);
    var Cook        = new Array(prow);
    var T    = new Array(numVar);
//    var Beta = new Array(numVar);
    var Cii  = new Array(numVar);
    var XP   = new Array(numVar); // 2차원 행렬
    var XPX  = new Array(numVar); // 2차원 행렬
    var XPY  = new Array(numVar);
    var L    = new Array(numVar); // 2차원 행렬
    var U    = new Array(numVar); // 2차원 행렬
    var invL = new Array(numVar); // 2차원 행렬
    var invU = new Array(numVar); // 2차원 행렬
//    var invXPX = new Array(numVar); // 2차원 행렬
    for (i = 0; i < prow; i++) {
        X[i] = new Array(numVar);
    }
    for (j = 0; j < numVar; j++) {
        XP[j] = new Array(prow);
        XPX[j] = new Array(numVar);
        L[j] = new Array(nAug);
        U[j] = new Array(nAug);
        invL[j] = new Array(numVar);
        invU[j] = new Array(numVar);
//        invXPX[j] = new Array(numVar);
    }

    // vector Y, matrix X
    for (i = 0; i < prow; i++) {
        Y[i] = ydata[i];
        X[i][0] = 1;
        for (j = 1; j < numVar; j++) {
            X[i][j] = Math.pow(i+1,j);
        } // endof j
    } // endof i
    // matrix XP
    for (i = 0; i < prow; i++) {
        for (j = 0; j < numVar; j++) {
            XP[j][i] = X[i][j];
        } // endof j
    } // endof i
    // matrix XPX
    for (i = 0; i < numVar; i++) {
        for (j = 0; j < numVar; j++) {
            temp = 0;
            for (k = 0; k < prow; k++) {
                temp += XP[i][k] * X[k][j];
            }
            XPX[i][j] = temp;
            L[i][j] = temp;
        }
    }
    // vector XPY
    for (i = 0; i < numVar; i++) {
        sum = 0;
        for (k = 0; k < prow; k++) {
            sum += XP[i][k] * Y[k];
        }
        XPY[i] = sum;
    }
    // Cholesky Decomposition LU
    for (k = 0; k < numVar; k++) {
        for (i = 0; i <= k - 1; i++) {
            sum = 0;
            for (j = 0; j <= i - 1; j++) {
                sum += L[i][j] * L[k][j];
            }
            L[k][i] = (L[k][i] - sum) / L[i][i];
        }
        sum = 0;
        for (j = 0; j <= k - 1; j++) sum += L[k][j] * L[k][j];
        L[k][k] = Math.sqrt(L[k][k] - sum);
    }
    for (i = 0; i < numVar; i++) {
        for (j = 0; j < numVar; j++) {
            if (j > i) L[i][j] = 0;
            U[j][i] = L[i][j];
        }
    }

    // Solve linear Eq  Lt = XPY by forward substitution
    for (k = 0; k < numVar; k++) {
        sum = 0;
        for (j = 0; j < k; j++) sum += L[k][j] * T[j];
        T[k] = (XPY[k] - sum) / L[k][k];
    }
    // Solve linear Eq  Ub = T by forward substitution
    for (k = numVar - 1; k >= 0; k--) {
        sum = 0;
        for (j = numVar - 1; j > k; j--) sum += U[k][j] * Beta[j];
        Beta[k] = (T[k] - sum) / U[k][k];
    }
    // Augment matrix
    for (i = 0; i < numVar; i++) {
        for (k = numVar; k < nAug; k++) {
            if (k == i + numVar) {
                L[i][k] = 1;
                U[i][k] = 1;
            } else {
                L[i][k] = 0;
                U[i][k] = 0;
            }
        }
    }
    // inverse of L by Gauss Elimination
    for (k = 0; k < numVar; k++) {
        temp = L[k][k];
        for (j = k; j < nAug; j++) L[k][j] = L[k][j] / temp;
        for (i = k + 1; i < numVar; i++) {
            temp = L[i][k];
            for (j = k; j < nAug; j++) {
                L[i][j] = L[i][j] - temp * L[k][j];
            }
        }
    }
    for (i = 0; i < numVar; i++) {
        for (j = numVar; j < nAug; j++) invL[i][j - numVar] = L[i][j];
    }
    // inverse of U = (invL)^T
    for (i = 0; i < numVar; i++) {
        for (j = 0; j < numVar; j++) invU[i][j] = invL[j][i];
    }
    // inverse of XPX = (invU)(invL)
    for (i = 0; i < numVar; i++) {
        for (j = 0; j < numVar; j++) {
            sum = 0;
            for (k = 0; k < numVar; k++) sum += invU[i][k] * invL[k][j];
            invXPX[i][j] = sum;
            if (i == j) Cii[i] = invXPX[i][j];
        }
    }
    // Final Test for identity
    for (i = 0; i < numVar; i++) {
        for (j = 0; j < numVar; j++) {
            sum = 0;
            for (k = 0; k < numVar; k++) sum += XPX[i][k] * invXPX[k][j];
        }
    }
    // residual, multiple correlation
    avgY = 0;
    avgYhat = 0;
    for (i = 0; i < prow; i++) {
        sum = Beta[0];
        for (j = 1; j < numVar; j++) {
            sum += Beta[j] * X[i][j];
        } // endof j
        yhat[i] = sum;
        residual[i] = Y[i] - yhat[i];
        avgY += Y[i];
        avgYhat += yhat[i];
    } // endof i
    avgY /= prow;
    avgYhat /= prow;
    // ANOVA Statistics
    SSR = 0;
    SSE = 0;
    SST = 0;
    SSYH = 0;
    for (i = 0; i < prow; i++) {
        tempx = Y[i] - avgY;
        tempy = yhat[i] - avgY;
        SST += tempx * tempx;
        SSR += tempy * tempy;
        SSYH += tempx * tempy;
        SSE += residual[i] * residual[i];
    } // endof i
    MSE = SSE / (prow - numVar);
    stdErr = Math.sqrt(MSE);
    multipleR = SSYH / Math.sqrt(SST * SSR);
    // Hii Leverage : x_i' inv(X'X) x_i
    for (i = 0; i < prow; i++) {
        for (k = 0; k < numVar; k++) {
            T[k] = 0;
            for (j = 0; j < numVar; j++) {
                T[k] += X[i][j] * invXPX[j][k]
            }
        } // endof k
        Hii[i] = 0;
        for (j = 0; j < numVar; j++) {
            Hii[i] += T[j] * X[i][j]
        }
        stdResidual[i] = residual[i] / (stdErr * Math.sqrt(1 - Hii[i]));
        Cook[i] = stdResidual[i] * stdResidual[i] * Hii[i] / ((numVar - 1) * (1 - Hii[i]));
    } // endof i

    statF[0] = prow;
    statF[1] = SSR;
    statF[2] = SSE;
    statF[3] = SST;
    statF[4] = numVar - 1;
    statF[5] = prow - numVar;
    statF[6] = prow - 1;
    statF[7] = SSR / statF[4]; // MSR
    statF[8] = MSE; // MSE
    statF[9] = statF[7] / statF[8]; // Fobs
//    statF[10] = 1 - f_cdf(statF[9], statF[4], statF[5], info);
    statF[11] = stdErr;
    statF[12] = multipleR;
    statF[13] = SSR / SST;

    /*
    console.log("i=0 "+invXPX[0][0]+" "+invXPX[0][1]+" "+invXPX[0][2]);  
    console.log("i=1 "+invXPX[1][0]+" "+invXPX[1][1]+" "+invXPX[1][2]);  
    console.log("i=2 "+invXPX[2][0]+" "+invXPX[2][1]+" "+invXPX[2][2]);  

    console.log("i="+i+" "+L[i][0]+" "+L[i][1]+" "+L[i][2]+" "+L[i][3]+" "+L[i][4]+" "+L[i][5]);
    console.log("k="+k+" "+L[k][0]+" "+L[k][1]+" "+L[k][2]+" "+L[k][3]+" "+L[k][4]+" "+L[k][5]);  
    console.log("k="+k+" "+L[0][0]+" "+L[0][1]+" "+L[0][2]+" "+L[0][3]+" "+L[0][4]+" "+L[0][5]);  
    console.log("k="+k+" "+L[1][0]+" "+L[1][1]+" "+L[1][2]+" "+L[1][3]+" "+L[1][4]+" "+L[1][5]);  
    console.log("k="+k+" "+L[2][0]+" "+L[2][1]+" "+L[2][2]+" "+L[2][3]+" "+L[2][4]+" "+L[2][5]);  
    */
}



</script>





  <p>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(133)">&#10094; &nbsp;&nbsp;<b>Previous</b></button>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(135)"><b>Next</b>&nbsp;&nbsp; &#10095;</button>
  <p>

</div>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="https://maxcdn.bootstrapcdn.com/js/ie10-viewport-bug-workaround.js"></script>
    <script>
        //document.getElementById('sidebar').getElementsByTagName('ul')[0].className += "nav nav-sidebar";
        
        /* ajust the height when click the toc
           the code is from https://github.com/twbs/bootstrap/issues/1768
        */
        var shiftWindow = function() { scrollBy(0, -50) };
        window.addEventListener("hashchange", shiftWindow);
        function load() { if (window.location.hash) shiftWindow(); }
        
        /*add Bootstrap styles to tables*/
        var tables = document.getElementsByTagName("table");
        for(var i = 0; i < tables.length; ++i){
            tables[i].className += "table table-bordered table-hover";
        }
    </script>

</body>
</html>

