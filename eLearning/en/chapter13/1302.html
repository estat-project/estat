<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <title>Chapter 13</title>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="../../css/ie10-viewport-bug-workaround.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="../../css/dashboard.css" rel="stylesheet">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <style type="text/css">code{white-space: pre;}</style>
       <style type="text/css">.sidebar ul{padding-left: 10px;}</style>
       <script src="../../js/prism.js"></script>
       <link rel="stylesheet" href="../../css/prism.css">
       <script src="../../js/jquery.min.js"></script>    
       <script type="text/javascript" id="MathJax-script" async
	       src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
       </script>
       <script>
	 $(document).ready(function() {
  	     toc = $("#sidebar > ul > li > ul");
  	     sections = toc.children();   // <li>
  	     for(var i=0; i<sections.length; i++) {
  		 if ($(sections[i]).children().length == 1) { continue; }
  		 var first = sections[i].firstElementChild;  // <a>
  		 var last = sections[i].lastElementChild;
  		 var li = $("<li>");
  		 var details = $("<details>");
  		 var summary = $("<summary>");
  		 $(summary).append(first)
  		 $(details).append(summary);
  		 $(details).append(last);
  		 $(li).append(details);	
  		 $(sections[i]).replaceWith(li);
  	     }
	 });
	 </script>
       <link rel="stylesheet" href="../../css/pandoc.css">
       <script src="../../js/eBook.js"></script>
       <script src="../../../eStat/js/language.js" ></script>   
       <script src="../../../eStat/lib/d3/d3.v4.min.js"></script>   
       <script src="../../../eStat/lib/DistributionsUtil.js" ></script>
       <script src="../../../eStat/js/eStatU.js"></script>
       <script src="../../../eStat/lib/FileSaver.min.js" ></script>
       <script src="../../../eStat/lib/convertSVG.js"></script>
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
  <ul class="nav navbar-nav">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Chapter<span class="caret"></span></a>
      <ul class="dropdown-menu"> 
        <li><a href="../index.html">HOME</a></li>
        <li><a href="../chapter01/index.html">Chapter 1</a></li>
        <li><a href="../chapter02/index.html">Chapter 2</a></li>
        <li><a href="../chapter03/index.html">Chapter 3</a></li>
        <li><a href="../chapter04/index.html">Chapter 4</a></li>
        <li><a href="../chapter05/index.html">Chapter 5</a></li>
        <li><a href="../chapter06/index.html">Chapter 6</a></li>
        <li><a href="../chapter07/index.html">Chapter 7</a></li>
        <li><a href="../chapter08/index.html">Chapter 8</a></li>
        <li><a href="../chapter09/index.html">Chapter 9</a></li>
        <li><a href="../chapter10/index.html">Chapter 10</a></li>
        <li><a href="../chapter11/index.html">Chapter 11</a></li>
        <li><a href="../chapter12/index.html">Chapter 12</a></li>
        <li><a href="../chapter13/index.html">Chapter 13</a></li>
      </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Section<span class="caret"></span></a>
	  <ul class="dropdown-menu"> 
                <li><a href="../chapter13/1301.html">13.1 What is Time Series Analysis?</a></li>
                <li><a href="../chapter13/1302.html">13.2 Smoothing of Time Series</a></li>
                <li><a href="../chapter13/1303.html">13.3 Transformation of Time Series</a></li>
                <li><a href="../chapter13/1304.html">13.4 Regression Model and Forecasting</a></li>
                <li><a href="../chapter13/1305.html">13.5 Exponential Smoothing Model and Forecasting</a></li>
                <li><a href="../chapter13/1306.html">13.6 13.6 Seasonal Model and Forecasting</a></li>
                <li><a href="../chapter13/1307.html">13.7 Exercise</a></li>
	  </ul>
    </li>
    <li><a class="navbar-brand" href="http://estat.me" target="_blank">eStat</a></li>
    <li><a class="navbar-brand" href="http://www.estat.me/estat/eStatU/index.html" target="_blank">eStatU</a></li>
    <li><a class="navbar-brand" href="/estat/eLearning/Distribution/index.html" target="_blank">Distribution</a></li>
  </ul>
</nav>

<div class="container-fluid">
  <div class="row">
    <div id="sidebar" class="col-sm-3 col-md2 sidebar">
      <ul>
	<li><a href=""></a>
	  <ul>
            <li><a href="../index.html">HOME</a></li>
	    <li><a href="../chapter01/index.html">Chapter 1</a>
	      <ul>
                <li><a href="../chapter01/0101.html">1.1 Statistics and Data Science</a></li>
                <li><a href="../chapter01/0102.html">1.2 Population and Sample</a></li>
                <li><a href="../chapter01/0103.html">1.3 Variables and Data</a></li>
                <li><a href="../chapter01/0104.html">1.4 Softwares for Statistical Analysis</a></li>
                <li><a href="../chapter01/0105.html">1.5 Exercies</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter02/index.html">Chapter 2</a>
	      <ul>
                <li><a href="../chapter02/0201.html">2.1 Visualization of Qualitative Data</a></li>
                <li><a href="../chapter02/0202.html">2.2 Visualization of Summary Data</a></li>
                <li><a href="../chapter02/0202.html">&nbsp;&nbsp;2.2.1 Summary Data of Categorical Variable</a></li>
                <li><a href="../chapter02/0202.html">&nbsp;&nbsp;2.2.2 Summary Data of Categorical Variable with Group</a></li>
                <li><a href="../chapter02/0203.html">2.3 Visualization of Raw Data</a></li>
                <li><a href="../chapter02/0203.html">&nbsp;&nbsp;2.3.1 Raw Data of Categorical Variable</a></li>
                <li><a href="../chapter02/0203.html">&nbsp;&nbsp;2.3.2 Raw Data of Categorical Variable with Group</a></li>
                <li><a href="../chapter02/0204.html">2.4 Word Cloud</a></li>
                <li><a href="../chapter02/0205.html">2.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter03/index.html">Chapter 3</a>
	      <ul>
                <li><a href="../chapter03/0301.html">3.1 Visualization of Quantitative Data</a></li> 
                <li><a href="../chapter03/0302.html">3.2 Visualization of Single Quantitative Variable</a></li>
                <li><a href="../chapter03/0302.html">&nbsp;&nbsp;3.2.1 Visualization of Quantitative Data without Group</a></li>
                <li><a href="../chapter03/0302.html">&nbsp;&nbsp;3.2.2 Visualization of Quantitative Data with Group</a></li>
                <li><a href="../chapter03/0303.html">3.3 Visualization of Two Quantitative Variables</a></li>
                <li><a href="../chapter03/0304.html">3.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter04/index.html">Chapter 4</a>
	      <ul>
                <li><a href="../chapter04/0401.html">4.1 Frequency Table for Single Variable</a></li>
                <li><a href="../chapter04/0401.html">&nbsp;&nbsp;4.1.1 Frequency Table for Categorical Variable</a></li>
                <li><a href="../chapter04/0401.html">&nbsp;&nbsp;4.1.2 Frequency Table for Quantitative Variable</a></li>
                <li><a href="../chapter04/0402.html">4.2 Contingency Table for Two Variables</a></li>
                <li><a href="../chapter04/0402.html">&nbsp;&nbsp;4.2.1 Contingency Table for Two Categorical Variables</a></li>
                <li><a href="../chapter04/0402.html">&nbsp;&nbsp;4.2.2 Contingency Table for Two Quantitative Variables</a></li>
                <li><a href="../chapter04/040301.html">4.3 Summary Measures for Quantitative Variable</a></li>
                <li><a href="../chapter04/040301.html">&nbsp;&nbsp;4.3.1 Measures of Central Tendency</a></li>
                <li><a href="../chapter04/040302.html">&nbsp;&nbsp;4.3.2 Measures of Dispersion</a></li>
                <li><a href="../chapter04/0404.html">4.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter05/index.html">Chapter 5</a>
	      <ul>
                <li><a href="../chapter05/0501.html">5.1 Definition of Probability</a></li>
                <li><a href="../chapter05/0502.html">5.2 Calculation of Probability</a></li>
                <li><a href="../chapter05/0503.html">5.3 Discrete Random Variable</a></li>
		<li><a href="../chapter05/050301.html">&nbsp;&nbsp;5.3.1 Binomial Distribution</a></li>
		<li><a href="../chapter05/050302.html">&nbsp;&nbsp;5.3.2 Poissson Distribution</a></li>
		<li><a href="../chapter05/050303.html">&nbsp;&nbsp;5.3.3 Geometric Distribution</a></li>
		<li><a href="../chapter05/050304.html">&nbsp;&nbsp;5.3.4 Hypergeometric Distribution</a></li>
                <li><a href="../chapter05/0504.html">5.4 Continuous Random Variable</a></li>
		<li><a href="../chapter05/050401.html">&nbsp;&nbsp;5.4.1 Normal Distribution</a></li>
		<li><a href="../chapter05/050402.html">&nbsp;&nbsp;5.4.2 Exponential Distribution</a></li>
                <li><a href="../chapter05/0505.html">5.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter06/index.html">Chapter 6</a>
	      <ul>
                <li><a href="../chapter06/0601.html">6.1 Simple Random Sampling</a></li>
                <li><a href="../chapter06/060201.html">6.2 Sampling Distribution of Sample Means and Estimation of the Population Mean</a></li>
                <li><a href="../chapter06/060201.html">&nbsp;&nbsp;6.2.1 Sampling Distribution of Sample Means</a></li>
                <li><a href="../chapter06/060202.html">&nbsp;&nbsp;6.2.2 Estimation of the Population Mean</a></li>
                <li><a href="../chapter06/060301.html">6.3 Sampling Distribution of Sample Variances and Estimation of the Population Variance</a></li>
                <li><a href="../chapter06/060301.html">&nbsp;&nbsp;6.3.1 Sampling Distribution of Sample Variances</a></li>
                <li><a href="../chapter06/060302.html">&nbsp;&nbsp;6.3.2 Estimation of the Population Variance</a></li>
                <li><a href="../chapter06/060401.html">6.4 Sampling Distribution of Sample Proportions and Estimation of the Population Proportion</a></li>
                <li><a href="../chapter06/060401.html">&nbsp;&nbsp;6.4.1 Sampling Distribution of Sample Proportions</a></li>
                <li><a href="../chapter06/060402.html">&nbsp;&nbsp;6.4.2 Estimation of the Population Proportion</a></li>
                <li><a href="../chapter06/0605.html">6.5 Determination of the Sample Size  </a></li>
                <li><a href="../chapter06/0605.html">&nbsp;&nbsp;6.5.1 Determination of the Sample Size to Estimate the Population Mean </a></li>
                <li><a href="../chapter06/0605.html">&nbsp;&nbsp;6.5.2 Determination of the Sample Size to Estimate the Population Proportion</a></li> 
                <li><a href="../chapter06/0606.html">6.6 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter07/index.html">Chapter 7</a>
	      <ul>
                <li><a href="../chapter07/0701.html">7.1 Testing Hypothesis for a Population Mean</a></li>
                <li><a href="../chapter07/0702.html">7.2 Testing Hypothesis for a Population Variance</a></li>
                <li><a href="../chapter07/0703.html">7.3 Testing Hypothesis for a Population Proportion</a></li>
                <li><a href="../chapter07/0704.html">7.4 Testing Hypothesis with α and β simultaneously</a></li>
                <li><a href="../chapter07/0704.html">&nbsp;&nbsp;7.4.1 Type 2 Error and Power of a Test</a></li>
                <li><a href="../chapter07/0704.html">&nbsp;&nbsp;7.4.2 Testing Hypothesis with α and β</a></li>
                <li><a href="../chapter07/0705.html">7.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter08/index.html">Chapter 8</a>
	      <ul>
                <li><a href="../chapter08/080101.html">8.1 Testing Hypothesis for Two Population Means</a></li>
                <li><a href="../chapter08/080101.html">&nbsp;&nbsp;8.1.1 Two Independent Samples</a></li>
                <li><a href="../chapter08/080102.html">&nbsp;&nbsp;8.1.2 Paired Sample</a></li>
                <li><a href="../chapter08/0802.html">8.2 Testing Hypothesis for Two Population Variances</a></li>
                <li><a href="../chapter08/0803.html">8.3 Testing Hypothesis for Two Population Proportions</a></li>
                <li><a href="../chapter08/0804.html">8.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter09/index.html">Chapter 9</a>
	      <ul>
                <li><a href="../chapter09/0901.html">9.1 Analysis of Variance for Experiments of Single Factor</a></li>
                <li><a href="../chapter09/090101.html">&nbsp;&nbsp;9.1.1 Multiple Comparison</a></li>
                <li><a href="../chapter09/090101.html">&nbsp;&nbsp;9.1.2 Residual Analysis</a></li>
                <li><a href="../chapter09/0902.html">9.2 Design of Experiments for Sampling</a></li>
                <li><a href="../chapter09/0902.html">&nbsp;&nbsp;9.2.1 Completely Randomized Design</a></li>
                <li><a href="../chapter09/0902.html">&nbsp;&nbsp;9.2.2 Randomized Block Design</a></li>
                <li><a href="../chapter09/0903.html">9.3 Analysis of Variance for Experiments of Two Factors</a></li>
                <li><a href="../chapter09/0904.html">9.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter10/index.html">Chapter 10</a>
	      <ul>
                <li><a href="../chapter10/1001.html">10.1 Nonparametric Test for the Location Parameter of Single Population  </a></li>
                <li><a href="../chapter10/1001.html">&nbsp;&nbsp;10.1.1 Sign Test</a></li>
                <li><a href="../chapter10/100102.html">&nbsp;&nbsp;10.1.2 Wilcoxon Signed Rank Sum Test</a></li>
                <li><a href="../chapter10/1002.html">10.2 Nonparametric Test for Location Parameters of Two Populations</a></li>
                <li><a href="../chapter10/1002.html">&nbsp;&nbsp;10.2.1 Independent Samples: Wilcoxon Rank Sum Test</a></li>
                <li><a href="../chapter10/100202.html">&nbsp;&nbsp;10.2.2 Paired Samples: Wilcoxon Signed Rank Sum Test</a></li>
                <li><a href="../chapter10/1003.html">10.3 Nonparametric Test for Location Parameters of Several Populations</a></li>
                <li><a href="../chapter10/1003.html">&nbsp;&nbsp;10.3.1 Completely Randomized Design: Kruskal-Wallis Test</a></li>
                <li><a href="../chapter10/100302.html">&nbsp;&nbsp;10.3.2 Randomized Block Design: Friedman Test</a></li>
                <li><a href="../chapter10/1004.html">10.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter11/index.html">Chapter 11</a>
	      <ul>
                <li><a href="../chapter11/1101.html">11.1 Goodness of Fit Test</a></li>
                <li><a href="../chapter11/1101.html">&nbsp;&nbsp;11.1.1 Goodness of Fit Test for Categorical Distribution</a></li>
                <li><a href="../chapter11/110102.html">&nbsp;&nbsp;11.1.2 Goodness of Fit Test for Continuous Distribution</a></li>
                <li><a href="../chapter11/1102.html">11.2 Testing Hypothesis for Contingency Table</a></li>
                <li><a href="../chapter11/1102.html">&nbsp;&nbsp;11.2.1 Independence Test</a></li>
                <li><a href="../chapter11/110202.html">&nbsp;&nbsp;11.2.2 Homogeneity Test</a></li>
                <li><a href="../chapter11/1103.html">11.3 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter12/index.html">Chapter 12</a>
	      <ul>
                <li><a href="../chapter12/1201.html">12.1 Correlation Analysis</a></li>
                <li><a href="../chapter12/1202.html">12.2 Simple Linear Regression Analysis</a></li>
                <li><a href="../chapter12/1203.html">12.3 Multiple Linear Regression Analysis</a></li>
                <li><a href="../chapter12/1204.html">12.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter13/index.html">Chapter 13</a>
	      <ul>
                <li><a href="../chapter13/1301.html">13.1 What is Time Series Analysis?</a></li>
                <li><a href="../chapter13/1302.html">13.2 Smoothing of Time Series</a></li>
                <li><a href="../chapter13/1303.html">13.3 Transformation of Time Series</a></li>
                <li><a href="../chapter13/1304.html">13.4 Regression Model and Forecasting</a></li>
                <li><a href="../chapter13/1305.html">13.5 Exponential Smoothing Model and Forecasting</a></li>
                <li><a href="../chapter13/1306.html">13.6 Seasonal Model and Forecasting</a></li>
                <li><a href="../chapter13/1307.html">13.7 Exercise</a></li>
	      </ul>
	    </li>
	  </ul>
	</li>
      </ul>
    </div>
  </div>
</div>

<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

  <!--***********************************************************************-->
  <h2>Chapter 13. Time Series Analysis</h2> 
  <p>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(131)">&#10094; &nbsp;&nbsp;<b>Previous</b></button>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(133)"><b>Next</b>&nbsp;&nbsp; &#10095;</button>
  <p>
  <h3>13.2 Smoothing of Time Series </h3>
  <p>
<!---
  <h6>
      <a href="1202.pdf" target="_blank"><u>[presentation]</u></a>&nbsp;&nbsp;&nbsp;
      <a href="https://youtu.be/wn0Dl3dLgko" target="_blank"><u>[video]</u></a>
  </h6>
--->
  <p>

    <div class="mainTable">
      Original time series data can be used to make a time series model by observing trends, but in many cases, 
      time series can be observed after smoothing to unerstand better. In a time series such as stock price, it is often difficult to find a trend because of temporary or short-term fluctuations due to accidental coincidences or cyclical factors. In this case, smoothing techniques are used as a method to effectively grasp the overall long-term trend by removing temporary or short-term fluctuations. The centered moving average method and the exponential smoothing method are widely used. 
    </div>
    <p>
    <h4>13.2.1 Centered Moving Average</h4>
    <p>
    <div class="mainTable">
      The time series in [Table 13.2.1] is the world crude oil price based on the closing price every year from 1987 to 2022. Looking at &lt;Figure 13.2.1&gt;, it can be seen that the short-term fluctuations in the time series are large. However, causes such as oil shocks are short-term and not continuous, so if we are interested in the long-term trend of gasoline consumption, it would be more effective to look at the fluctuations caused by short-term causes.
      <p>
      <div class="textLeft">[Table 13.2.1]  Price of Crude Oil (End of Year Price, US$) and 5-point Centered Moving Average</div>
      <p>
      <table style="width:400px"> 
        <tr> 
          <th class="thGrey" style="width:100px">Year</th>
          <th class="thGrey" style="width:150px">Price of Oil</th>
          <th class="thGrey" style="width:150px">5-point Centered Moving Average</th>
        </tr>
        <tr> 
           <td class="tdCenter">
             1987<br>
             1988<br>
             1989<br>
             1990<br>
             1991<br>
             1992<br>
             1993<br>
             1994<br>
             1995<br>
             1996<br>
             1997<br>
             1998<br>
             1999<br>
             2000<br>
             2001<br>
             2002<br>
             2003<br>
             2004<br>
             2005<br>
             2006<br>
             2007<br>
             2008<br>
             2009<br>
             2010<br>
             2011<br>
             2012<br>
             2013<br>
             2014<br>
             2015<br>
             2016<br>
             2017<br>
             2018<br>
             2019<br>
             2020<br>
             2021<br>
             2022<br>
           </td> 
           <td class="tdCenter">
             16.74 <br>
             17.12 <br>
             21.84 <br>
             28.48 <br>
             19.15 <br>
             19.49 <br>
             14.19 <br>
             17.77 <br>
             19.54 <br>
             25.90 <br>
             17.65 <br>
             12.14 <br>
             25.76 <br>
             26.72 <br>
             19.96 <br>
             31.21 <br>
             32.51 <br>
             43.36 <br>
             61.06 <br>
             60.85 <br>
             95.95 <br>
             44.60 <br>
             79.39 <br>
             91.38 <br>
             98.83 <br>
             91.83 <br>
             98.17 <br>
             53.45 <br>
             37.13 <br>
             53.75 <br>
             60.46 <br>
             45.15 <br>
             61.14 <br>
             48.52 <br>
             75.21 <br>
             106.95<br>
          </td> 
           <td class="tdCenter">
             <br>
             <br>
             20.666<br>
             21.216<br>
             20.630<br>
             19.816<br>
             18.028<br>
             19.378<br>
             19.010<br>
             18.600<br>
             20.198<br>
             21.634<br>
             20.446<br>
             23.158<br>
             27.232<br>
             30.752<br>
             37.620<br>
             45.798<br>
             58.746<br>
             61.164<br>
             68.370<br>
             74.434<br>
             82.030<br>
             81.206<br>
             91.920<br>
             86.732<br>
             75.882<br>
             66.866<br>
             60.592<br>
             49.988<br>
             51.526<br>
             53.804<br>
             58.096<br>
             67.394<br>
             <br>
             <br>
          </td> 
         </tr>
      </table>
      <p>

      <!---   ************ html for Time Series - Smoothing ************  ---->
      <b>[<span data-msgid="TimeSeries"></span> : <span data-msgid="Smoothing"></span>. <span data-msgid="Filtering"></span>]</b>
      <p>
         <input class="qrBtn" type="image" src="../../QR/eStatU330_TimeseriesSmoothing.svg" onclick="window.open(addrStr[134])">
      <p>
      <button type="button" id="erase" style="width:100px;"><b>New Data</b></button>
      <p>
      <table class="data">
	<tr>
	  <td><b>Y <span data-msgid="input data"></span></b></td>
	  <td colspan="3"><input type="text" size=73 id="data2"></td>
	</tr>
	<tr>
	  <td><b>X <span data-msgid="input data"></span></b></td>
	  <td colspan="3"><input type="text" size=73 id="data1"></td>
	</tr>
        <tr>
          <td style="text-align: right;"><b><span data-msgid="Main Title">Main Title</span></b>&nbsp;</td>
          <td colspan="3"><input type="text" size=50 id="mtitle"></td>
        </tr>
	<tr>
          <td style="text-align: right;"><b><span data-msgid="y title">y title</span></b>&nbsp;</td>
          <td><input type="text" size=15 id="ytitle"></td>
 	</tr>
      </table>   
      <p>
      <button type="button" id="execute"><span data-msgid="Execute">Execute</span></button>
      <table class="stat">
	<tr>
 	  <td>&nbsp;&nbsp;<span data-msgid="NumberData"></span></td>         
	  <td><span class="fontmath">n<sub>Y</sub></span></td>
	  <td><input type="text" style="text-align:center;" size=6 id="nn41"> <span style="color:red;">( ≤ 120)</span></td>     
 	  <td>&nbsp;&nbsp;<span data-msgid="Mean"></span></td>         
	  <td><span class="fontmath">Y&#772;</span></td>
	  <td><input type="text" style="text-align:center;" size=6 id="yavg"></td>      
	</tr>
      </table>
      <svg id="chart" width="620" height="400" style="border-style:solid;"> </svg>
      <table style="width:600px;">
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model1">&nbsp;&nbsp;<span data-msgid="CenterMA"></span>
            </label> 
          </td>
          <td>&nbsp;&nbsp; N = <input type="number" min="2" max="30" size=5 value="3" style="text-align:center" id="ma1N" onchange="redrawModel1()"></td>
          <td><span style="color:red;">1 < N < 30</span></td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model2">&nbsp;&nbsp;<span data-msgid="CenterMA"></span>
            </label> 
          </td>
          <td>&nbsp;&nbsp; N = <input type="number" min="2" max="30" size=5 value="7" style="text-align:center" id="ma2N" onchange="redrawModel2()"></td>
          <td><span style="color:red;">1 < N < 30</span></td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model3">&nbsp;&nbsp;<span data-msgid="SingleES"></span>
            </label> 
          </td>
          <td>&nbsp;&nbsp; α = <input type="text" size=5 value="0.1" id="es1Alpha" style="text-align:center" onchange="redrawModel3()"></td>
          <td>S₀ = <input type="text" size=5 style="text-align:center" id="S01" onchange="redrawModel3()"> <span data-msgid="Default" style="color:blue"></span> Y₁</td>
	</tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model4">&nbsp;&nbsp;<span data-msgid="SingleES"></span>
            </label> 
          </td>
          <td>&nbsp;&nbsp; α = <input type="text" size=5 value="0.3" id="es2Alpha" style="text-align:center" onchange="redrawModel4()"></td>
          <td>S₀ = <input type="text" size=5 style="text-align:center" id="S02" onchange="redrawModel4()"> <span data-msgid="Default" style="color:blue"></span> Y₁</td>
        </tr>
	<tr>
          <td>
            <label>
              <input type="checkbox" id="model5">&nbsp;&nbsp;<span data-msgid="MovingMedian"></span>
            </label> 
          </td>
          <td>&nbsp;&nbsp; N = <input type="number" min="2" max="10" size=5 value="3" style="text-align:center" id="mm1N" onchange="redrawModel5()"></td>
          <td><span style="color:red;">1 < N < 10</span></td>
	</tr>
	<tr>
 	  <td><button type="button" id="saveGraphU"><span class="tooltiptext" data-msgid="Graph Save">Graph Save</span></button></td>               
          <td><button type="button" id="createTable"><span class="tooltiptext" data-msgid="CreateTable"></span></button>    
          <td><button type="button" id="saveTable"><span class="tooltiptext" data-msgid="SaveTable"></span></button>    
          </td>
	</tr>
      </table>
      <p>
         <div class="figText">&lt;Figure 13.2.1&gt; Price of Crude Oil, Smoothing and Filtering</div>
      <p>
      <div> 
        <div id="screenTable" >
          <div id="loc">
          </div>
        </div>
      </div>
      <p>
        The N-point <b>centered moving average</b> of a time series refers to the average of N data
        from a single point in time. For example, in crude oil price data, the value of the 
        five-point moving average for a specific year is the average of the data for two years 
        before the specific year, that year, and the data for the next two years. Expressed as 
        an expression, if \(M_t\) is a moving average in time \(t\), the 5-point centered moving
        average is as follows:
      $$
        M_t = \frac{Y_{t-2} \,+\, Y_{t-1} \,+\, Y_{t} \,+\, Y_{t+1} \,+\,  Y_{t+2} } {5 }   
      $$
        For example, the 5-point centered moving average for 1989 is as follows.
      <p>
        \(\qquad M_{1989} \,=\, \frac {Y_{1987} + Y_{1988} +Y_{1989} + Y_{1990} + Y_{1991} } {5 } \)
      <br>
        \( \qquad \qquad \quad =\, \frac {16.74 + 17.12 + 21.84 + 28.48 + 19.15} {5} \,=\, 20.6660 \)
      <p>
        [Table 13.2.2] shows the values ​​of all 5-points centered moving averages obtained in this way and &lt;Figure 13.2.1&gt; is the graph of 5-points moving average. Note that the moving averages for the first two years and the last two years cannot be obtained here. It can be seen that the graph of the moving average is better for grasping the long-term trend than the graph of the original data because short-term fluctuations are removed. 
      <p>
        The choice of a value N for the N-point moving average is important. A large value of N 
        will provide a smoother moving average, but it has the disadvantage of losing more points 
        at both ends and insensitive to detecting important trend changes. On the other hand, 
        if you choose small N, you will lose less data at both ends, but you may not be able 
        to get the smoothing effect because you will not sufficiently eliminate short-term fluctuations. 
        In general, try a few values N​​ to reflect important changes that should not be missed, 
        while achieving a smoothing effect and balancing the points not to lose too much at both ends.
      <p>
        If the value of N is an even number, there is a difficulty in obtaining a central moving average 
        with the same number of data on both sides of the base year. For example, the center of the 
        four-point moving average from 1987 to 1990 is between 1988 and 1989. If you denote this as 
        \(M_{1988.5}\), it can be calculated as follows:
      <p>
        \( \qquad M_{1988.5} \,=\, \frac {Y_{1987} + Y_{1988} +Y_{1989} + Y_{1990} } {4 } \)
      <br>
        \( \qquad \qquad \quad \,=\, \frac {16.74 + 17.12 + 21.84 + 28.48 } {4} \,=\, 21.045 \)
      <p>
        The 4-point moving average obtained in this way is called a non-central 4-points moving average. 
        In the case of this even number N, the non-central moving average does not match the observation 
        year of the original data, which is inconvenient. In the case of this even number N, it is 
        calculated as the average of the noncentral moving average values of two adjacent non-central
        moving averages. In other words, the central four-point moving average in 1989 is the average 
        of  \(M_{1988.5}\) and  \(M_{1989.5}\)  as follows:
      <p>
        \( \qquad M_{1989} \,=\, \frac {M_{1988.5} \,+\, M_{1989.5} } {2 } \)
      <br>
        \( \qquad \qquad \quad =\, \frac {21.0450 \,+\, 21.6475 } {2} \,=\, 21.3463 \)
      <p>
        If the time series is quarterly or monthly, a 4-point central moving average or a 12-point central moving average is an average of one year, so it is often used to observe data without seasonality.
    </div>
    <p>

    <!---   ************ script for Time Series - Smoothing ************  ---->
  <script>
      setLanguage('en');
      var svg     = d3.select("#chart"); 
      var i, k, k1, k2;
      var svgWidth    = 620;
      var svgHeight   = 400;
      var margin      = {top: 80, bottom: 50, left: 60, right: 60};
      var buffer      = 40;
      var graphWidth  = svgWidth - margin.left - margin.right;
      var graphHeight = svgHeight - margin.top - margin.bottom;
      var checkTitle  = true;
      var mTitle, yTitle, xTitle;
      var tobs; 
      var temp, model, str, strLabel, strModel, yavg;
      var nforecast = 0;
      var ma1N, ma2N, mm1N, es1Alpha, es2Alpha, S01, S02;
      var xobs, xmin, xmax, xgap, gxmin, gxmax, gxrange;
      var yobs, ymin, ymax, ygap, gymin, gymax, gyrange;
      var fontsize = "1em";
      var stat1     = new Array(30);
      var tstat     = new Array(30);
      var rowmax    = 200;
      var tdata     = new Array(rowmax);
      var xdata     = new Array(rowmax);
      var ydata     = new Array(rowmax);
      var yhat1     = new Array(rowmax);
      var yhat2     = new Array(rowmax);
      var yhat3     = new Array(rowmax);
      var yhat4     = new Array(rowmax);
      var yhat5     = new Array(rowmax);
      var MA        = new Array(rowmax);
      var S         = new Array(rowmax);
      var MM        = new Array(rowmax);
      var tempd     = new Array(rowmax);
      var checkModel    = new Array(10);
      var checkForecast = false;
      xTitle = "t";
      document.getElementById("nn41").disabled = true;    
      document.getElementById("yavg").disabled = true;    
      svg.selectAll("*").remove();

      // input data control ===================================================
      d3.select("#data2").on("input", function() {
        stat = simplestat("#data2");  
        ydata = data; 
        yobs = stat.n;
      });
      d3.select("#data1").on("input", function() {
        stat = simplestat("#data1");  
        xdata = data; 
        xobs = stat.n;
      });
      updateData = function() {
        document.getElementById("data2").value = '';    
      }
      updateData = function() {
        document.getElementById("data1").value = '';    
      }

      // init example
      document.getElementById("data1").value = "1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022";
        stat = simplestat("#data1");  
        xdata = data; 
        xobs = stat.n;
      document.getElementById("data2").value = "16.74,17.12,21.84,28.48,19.15,19.49,14.19,17.77,19.54,25.90,17.65,12.14,25.76,26.72,19.96,31.21,32.51,43.36,61.06,60.85,95.95,44.60,79.39,91.38,98.83,91.83,98.17,53.45,37.13,53.75,60.46,45.15,61.14,48.52,75.21,106.95";
        stat = simplestat("#data2");  
        ydata = data; 
        yobs = stat.n;
      document.getElementById("mtitle").value = "Price of Crude Oil (year close)";
      document.getElementById("ytitle").value = "US$";
  
      // erase Data and Graph
      d3.select("#erase").on("click",function() {
        svg.selectAll("*").remove();
        document.getElementById("data1").value  = "";
        document.getElementById("data2").value  = "";
        document.getElementById("mtitle").value = "";
        document.getElementById("ytitle").value = "";
        document.getElementById("nn41").value   = "";
        document.getElementById("yavg").value   = "";
        document.getElementById("S01").value    = "";
        document.getElementById("S02").value    = "";
        document.getElementById("model1").checked = false;
        document.getElementById("model2").checked = false;
        document.getElementById("model3").checked = false;
        document.getElementById("model4").checked = false;
        document.getElementById("model5").checked = false;
      })
    
      d3.select("#execute").on("click", function(){  
          svg.selectAll("*").remove();  // 전화면 제거
          if (xobs > 0) {
            if (yobs != xobs) {alert("size of Y data is not the same as X data"); return;}
          }
          else {
            for (i = 0; i < yobs; i++) {
              tdata[i] = i + 1;   
              xdata[i] = tdata[i];
            }
          }
          // 입력 도수에 숫자 문자 빈칸 있나 체크
          tobs = yobs;
          for (i=0; i<tobs; i++) {
            if ( isNaN(ydata[i]) ) {
              svg.append("text").attr("class","mean").attr("x", 250).attr("y", margin.top + 40)
                 .text(alertMsg[48][langNum]).style("stroke","red").style("font-size","1em");
              return;
            }
          }
          // title
          mTitle = d3.select("#mtitle").node().value;
          yTitle = d3.select("#ytitle").node().value;
          document.getElementById("model1").checked = false;
          document.getElementById("model2").checked = false;
          document.getElementById("model3").checked = false;
          document.getElementById("model4").checked = false;
          document.getElementById("model5").checked = false;
          for (i=1; i<=5; i++) checkModel[i] = false;
          document.getElementById("ma1N").value     = 3;
          document.getElementById("ma2N").value     = 7;
          document.getElementById("es1Alpha").value = 0.1;
          document.getElementById("es2Alpha").value = 0.3;
          document.getElementById("S01").value      = "";
          document.getElementById("S02").value      = "";
          document.getElementById("mm1N").value     = 3;
          // 시계열그림
          nforecast = 0;
          model1Stat(tobs, tdata, xdata, ydata, stat1);
          document.getElementById("nn41").value = yobs;
          yavg = stat1[11];
          document.getElementById("yavg").value = f2(yavg);
          model = 1;
          initialCordinate(tobs, xdata, ydata);    
          showTimeSeriesPlot(model, tobs, nforecast, xdata, ydata, checkTitle);
      })

      // Single MA1 그리기
      d3.select("#model1").on("click",function() {
          if(this.checked) drawModel1();
          else clearModel1();
      })
      // Single MA2 그리기
      d3.select("#model2").on("click",function() {
          if(this.checked) drawModel2();
          else clearModel2();
      })
      // Single ES1 그리기
      d3.select("#model3").on("click",function() {
          if(this.checked) drawModel3();
          else clearModel3();
      })
      // Single ES2 그리기
      d3.select("#model4").on("click",function() {
          if(this.checked) drawModel4();
          else clearModel4();
      })
      // Single MM1 그리기
      d3.select("#model5").on("click",function() {
          if(this.checked) drawModel5();
          else clearModel5();
      })

      // svg Graph Save
      d3.select("#saveGraphU").on("click", function() {
        var svg = d3.select("#chart");
        var width = svgWidth;
        var height = svgHeight;
        var svgString = getSVGString(svg.node());
        svgString2Image(svgString, width, height, 'png', save);
        function save(dataBlob, filesize) {
          saveAs(dataBlob, 'eStatGraphU.png');
        }
      });
      // create Table
      d3.select("#createTable").on("click", function() {
        for (i=1; i<=5; i++) {
          if (i==1) for (j=0; j<tobs; j++) tstat[j] = yhat1[j];
          else if (i==2) for (j=0; j<tobs; j++) tstat[j] = yhat2[j];
          else if (i==3) for (j=0; j<tobs; j++) tstat[j] = yhat3[j];
          else if (i==4) for (j=0; j<tobs; j++) tstat[j] = yhat4[j];
          else if (i==5) for (j=0; j<tobs; j++) tstat[j] = yhat5[j];
          if ( checkModel[i] ) smoothingTable(i, tobs, tstat); 
        }
      });

      // save Table
      d3.select("#saveTable").on("click", function() {
        head = '<html><head><meta charset="UTF-8"></head><body>';
        tail = '</body></html>';
        saveAs(new Blob([head + d3.select("#screenTable").html() + tail]), "eStatULog.html");
      });

// Single MA1
function drawModel1(){
            model = 1;
            checkModel[model] = true;
            for (j=0; j<tobs; j++) yhat1[j] = NaN;
            ma1N = parseFloat(d3.select("#ma1N").node().value);
            for (i=0; i<tobs-ma1N+1; i++) {
              sum = 0;
              for (j=i; j<i+ma1N; j++) sum += ydata[j];
              MA[i] = sum / ma1N;
            }
            // N이 홀수 경우
            if (ma1N % 2 == 1) {
              k  = Math.floor((ma1N+1)/2);
              k1 = k-1;
              k2 = tobs - k1;
              for (i=k1; i<k2; i++) {
                yhat1[i] = MA[i-k1]
              }
            }
            else {
              k = Math.floor((ma1N)/2);
              k1 = k;
              k2 = tobs - k;
              for (i=k1; i<k2; i++) {
                yhat1[i] = 0.5*(MA[i-k1] + MA[i-k1+1]);
              }
            }
            strLabel = "reglabel"+model;
            strModel = svgStrU[124][langNum]+" (N="+ma1N+")"; // 중심이동평균
            showSmoothing(strModel, strLabel, tobs, k1, k2, xdata, yhat1);
}
// Draw time series smoothing on the plot
function showSmoothing(strModel, strLabel, nobs, ibegin, iend, xdata, yhat) {
    var ty = margin.top + model*20;;
    for (i=ibegin; i<iend; i++) {
          svg.append("circle").attr("class",strLabel)
             .attr("cx", margin.left+graphWidth*(xdata[i]-gxmin)/gxrange)
             .attr("cy", margin.top+graphHeight-graphHeight*(yhat[i]-gymin)/gyrange)         
             .attr("r", 3)
             .style("fill",myColor[model])
    }

    var x1  = margin.left + graphWidth*(xdata[ibegin]-gxmin)/gxrange;
    var y1  = margin.top  + graphHeight - graphHeight*(yhat[ibegin]-gymin)/gyrange;
    for (i=ibegin+1; i<iend; i++) {
      var x2  = margin.left + graphWidth*(xdata[i]-gxmin)/gxrange;
      var y2  = margin.top  + graphHeight - graphHeight*(yhat[i]-gymin)/gyrange;
      svg.append("line").attr("class",strLabel)
                .attr("x1",x1)
                .attr("y1",y1)
                .attr("x2",x2)
                .attr("y2",y2)
                .style("stroke",myColor[model]) 
      x1 = x2;
      y1 = y2;
    }
    if(checkTitle) {   
        svg.append("text").attr("class",strLabel)
                .attr("x", margin.left + 20)
                .attr("y", ty)
                .text(strModel)
                .style("stroke",myColor[model]) 
     }
}
// Single MA
function drawModel2(){
            model = 2;
            checkModel[model] = true;
            for (j=0; j<tobs; j++) yhat2[j] = NaN;
            ma2N = parseFloat(d3.select("#ma2N").node().value);
            for (i=0; i<tobs-ma2N+1; i++) {
              sum = 0;
              for (j=i; j<i+ma2N; j++) sum += ydata[j];
              MA[i] = sum / ma2N;
            }
            // N이 홀수 경우
            if (ma2N % 2 == 1) {
              k  = Math.floor((ma2N+1)/2);
              k1 = k-1;
              k2 = tobs - k1;
              for (i=k1; i<k2; i++) {
                yhat2[i] = MA[i-k1]
              }
            }
            else {
              k = Math.floor((ma2N)/2);
              k1 = k;
              k2 = tobs - k;
              for (i=k1; i<k2; i++) {
                yhat2[i] = 0.5*(MA[i-k1] + MA[i-k1+1]);
              }
            }
            strLabel = "reglabel"+model;
            strModel = svgStrU[124][langNum]+" (N="+ma2N+")"; //중심이동평균
            showSmoothing(strModel, strLabel, tobs, k1, k2, xdata, yhat2);
}
// Single ES1
function drawModel3() {
            model = 3;
            checkModel[model] = true;
            for (j=0; j<tobs; j++) yhat3[j] = NaN;
            es1Alpha = parseFloat(d3.select("#es1Alpha").node().value);
            S01 = parseFloat(d3.select("#S01").node().value);
            if ( isNaN(S01) ) {
              S01 = ydata[0];
              document.getElementById("S01").value = f2(S01);
            }
            S[0] = es1Alpha*ydata[0] + (1-es1Alpha)*S01;
            yhat3[0] = S[0];
            for (i=1; i<tobs; i++) {
              S[i] = es1Alpha*ydata[i] + (1-es1Alpha)*S[i-1];
              yhat3[i] = S[i];
            }
            strLabel = "reglabel"+model;
            strModel = svgStrU[125][langNum]+" (α="+es1Alpha+")"; //지수평활
            showSmoothing(strModel, strLabel, tobs, 0, tobs, xdata, yhat3);
}
// Single ES2
function drawModel4() {
            model = 4;
            checkModel[model] = true;
            for (j=0; j<tobs; j++) yhat4[j] = NaN;
            es2Alpha = parseFloat(d3.select("#es2Alpha").node().value);
            S02 = parseFloat(d3.select("#S02").node().value);
            if ( isNaN(S02) ) {
              S02 = ydata[0];
              document.getElementById("S02").value = f2(S02);
            }
            S[0] = es2Alpha*ydata[0] + (1-es2Alpha)*S02;
            yhat4[0] = S[0];
            for (i=1; i<tobs; i++) {
              S[i] = es2Alpha*ydata[i] + (1-es2Alpha)*S[i-1];
              yhat4[i] = S[i];
            }
            strLabel = "reglabel"+model;
            strModel = svgStrU[125][langNum]+" (α="+es2Alpha+")"; //지수평활
            showSmoothing(strModel, strLabel, tobs, 0, tobs, xdata, yhat4);
}
// Single Moving Median
function drawModel5(){
            model = 5;
            checkModel[model] = true;
            mm1N = parseFloat(d3.select("#mm1N").node().value);
            for (j=0; j<tobs; j++) yhat5[j] = NaN;
            for (i=0; i<tobs-mm1N+1; i++) {
              for (j=i; j<i+mm1N; j++) tempd[j-i] = ydata[j];
              // sorting
              for (j=0; j<mm1N-1; j++) {
                for (k=j+1; k<mm1N; k++) {
                  if (tempd[j] > tempd[k]) {
                    temp  = tempd[j];
                    tempd[j] = tempd[k];
                    tempd[k] = temp;
                  }
                }
              }
              // N이 홀수 경우
              if (mm1N % 2 == 1) {
                k = Math.floor((mm1N+1)/2);
                MM[i] = tempd[k-1];
              }
              else {
                k = Math.floor((mm1N)/2);
                MM[i] = 0.5*(tempd[k] + tempd[k+1]);
              }
            }
            // N이 홀수 경우
            if (mm1N % 2 == 1) {
              k  = Math.floor((mm1N+1)/2);
              k1 = k-1;
              k2 = tobs - k1;
              for (i=k1; i<k2; i++) {
                yhat5[i] = MM[i-k1]
              }
            }
            else {
              k = Math.floor((mm1N)/2);
              k1 = k;
              k2 = tobs - k;
              for (i=k1; i<k2; i++) {
                yhat5[i] = 0.5*(MM[i-k1] + MM[i-k1+1]);
              }
            }
            strLabel = "reglabel"+model;
            strModel = svgStrU[126][langNum]+" (N="+mm1N+")";  //중심이동중앙값
            showSmoothing(strModel, strLabel, tobs, k1, k2, xdata, yhat5);

}
function redrawModel1() {
  document.getElementById("model1").checked = true;
  clearModel1();
  drawModel1();
}
function redrawModel2() {
  document.getElementById("model2").checked = true;
  clearModel2();
  drawModel2();
}
function redrawModel3() {
  document.getElementById("model3").checked = true;
  clearModel3();
  drawModel3();
}
function redrawModel4() {
  document.getElementById("model4").checked = true;
  clearModel4();
  drawModel4();
}
function redrawModel5() {
  document.getElementById("model5").checked = true;
  clearModel5();
  drawModel5();
}
function clearModel1() {
     checkModel[1] = false;
     svg.selectAll("circle.reglabel1").remove();
     svg.selectAll("line.reglabel1").remove();
     svg.selectAll("text.reglabel1").remove();
}
function clearModel2() {
     checkModel[2] = false;
     svg.selectAll("circle.reglabel2").remove();
     svg.selectAll("line.reglabel2").remove();
     svg.selectAll("text.reglabel2").remove();
}
function clearModel3() {
     checkModel[3] = false;
     svg.selectAll("circle.reglabel3").remove();
     svg.selectAll("line.reglabel3").remove();
     svg.selectAll("text.reglabel3").remove();
}
function clearModel4() {
     checkModel[4] = false;
     svg.selectAll("circle.reglabel4").remove();
     svg.selectAll("line.reglabel4").remove();
     svg.selectAll("text.reglabel4").remove();
}
function clearModel5() {
     checkModel[5] = false;
     svg.selectAll("circle.reglabel5").remove();
     svg.selectAll("line.reglabel5").remove();
     svg.selectAll("text.reglabel5").remove();
}

function smoothingTable(model, nobs, yhat) {
    var screenTable = document.getElementById("screenTable");
    var table = document.createElement('table');
    loc.appendChild(table);
    var row, header;
    var i, j, k, strModel, temp;
    var ncol = 4;
    var cell = new Array(ncol);
    table.style.fontSize = "13px";
    switch (model) {
      case 1:
        strModel = "MA (N="+ma1N+")";
        break;
      case 2:
        strModel = "MA (N="+ma2N+")";
        break;
      case 3:
        strModel = "ES (α="+es1Alpha+")";
        break;
      case 4:
        strModel = "ES (α="+es2Alpha+")";
        break;
      case 5:
        strModel = "Median (N="+mm1N+")";
        break;
    }

    k = 0;
    row = table.insertRow(k++);
    row.style.height ="30px";
    for (j=0; j<ncol; j++) {
      cell[j] = row.insertCell(j);
      cell[j].style.textAlign = "center";
      cell[j].style.border = "1px solid black";
      cell[j].style.width ="100px";
    }
    cell[0].innerHTML = "<b>"+svgStrU[127][langNum]+"</b> "+model;
    cell[1].innerHTML = strModel;
    cell[0].style.width ="70px";

    row  = table.insertRow(k++);
    row.style.height ="25px";
    for (j=0; j<ncol; j++) {
      cell[j] = row.insertCell(j);
      cell[j].style.backgroundColor = "#eee";
      cell[j].style.textAlign = "center";
      cell[j].style.border = "1px solid black";
    }
    for (j=1; j<ncol; j++) {
      cell[j].style.width ="100px";
    }
    cell[0].innerHTML = "<b>t</b>";
    cell[1].innerHTML = "X(t)";
    cell[2].innerHTML = "Y(t)";
    cell[3].innerHTML = strModel;

    for (i=0; i<nobs; i++) {
       row = table.insertRow(k++);
       for (j=0; j<ncol; j++) {
              cell[j] = row.insertCell(j)          
              cell[j].style.textAlign = "center";
              cell[j].style.border = "1px solid black";
       }
       cell[0].innerHTML = i+1;
       cell[1].innerHTML = xdata[i];
       cell[2].innerHTML = f4(ydata[i]);
       cell[3].innerHTML = f4(yhat[i]);
       cell[0].style.backgroundColor = "#eee";
       cell[0].style.textAlign = "center";
    }
}

</script>






  <h4>13.2.2 Exponential Smoothing</h4>
  <p>
    <div class="mainTable">
      <p>
        3-point moving average can be considered the weighted average of three data with each weight 
        \(\frac{1}{3}\) as follows:
      $$
        M_t \,=\, \frac{Y_{t-1} \,+\, Y_{t} \,+\, Y_{t+1} } {3 } \,=\, \frac{1}{3}Y_{t-1} \,+\, \frac{1}{3}Y_{t} \,+\, \frac{1}{3}Y_{t+1}
      $$
        When the weights are \(w_1 , w_2 , ... , w_n\), the weighted moving average \(M_t\) of the 
        time series is defined as follows:
      $$
        M_t \,=\, \sum_{i=1}^{n} w_i Y_{i}
      $$
        where \(n\)  is the number of data, \(w_i \ge 0\) and \(\sum_{i=1}^{n} w_i = 1 \).
      <p>
        Various weighted averages with different weights can be used depending on the purpose. 
        Among them, a smoothing method that gives more weight to data closer to the present and 
        smaller weights as it is farther from the present is called <b>exponential smoothing</b>. 
        The exponential smoothing method is determined by an <b>exponential smoothing constant</b> \(\alpha\)
        that has a value between 0 and 1. The exponentially smoothed data \(E_t\) is calculated as follows:
      <p>
        \( \qquad E_{1} \,=\, \alpha \,Y_{1} \,+\, (1- \alpha)\, E_{0} \)      <br>
        \( \qquad E_{2} \,=\, \alpha \,Y_{2} \,+\, (1- \alpha)\, E_{1} \)      <br>
        \( \qquad E_{3} \,=\, \alpha \,Y_{3} \,+\, (1- \alpha)\, E_{2} \)      <br>
        \( \qquad \cdots \)      <br>
        \( \qquad E_{t} \,=\, \alpha \,Y_{t} \,+\, (1- \alpha)\, E_{t} \)      <br>
      <p>
        Here, an initial value \(E_{0}\) is required, and \(Y_1\) is usually used a lot, and the average 
        value of the data can also be used. The exponentially smoothed value \(E_t\) at the point in time 
        \(t\) gives weight \(\alpha\) to the current data, and the \(1-\alpha\)  weight to the previous 
        smoothed data is given. The exponentially smoothed value \(E_t\) can be represented with 
        the original data \(Y_t\) as follows:
      $$
        E_t \,=\, \alpha Y_t + (1-\alpha) Y_{t-1} + \alpha(1-\alpha)^2 Y_{t-2} + \cdots + \alpha(1-\alpha)^{t-2} Y_2 + (1-\alpha)^{t-1} Y_1    
      $$
        Therefore, the exponential smoothing method uses all data from the present and the past, but gives 
        the current data the highest weight &alpha;, and gives a lower weight as the distance from the present time increases.
      <p>
        Exponential smoothing of the crude oil price in [Table 13.2.1] with the initial value 
        \(E _{1986} = Y _{1987}   \) and exponential smoothing constant \(\alpha\) = 0.3 is as follows.
      <p>
        \( \qquad E_{1986} \,=\, E_{1987} = 16.74 \)      <br>
        \( \qquad E_{1987} \,=\, 0.3  \,Y_{1987} \,+\, (1- 0.3)\, E_{1986} \,=\, (0.3)(16.74)+(0.7)(16.74)=16.74  \)      <br>
        \( \qquad E_{1988} \,=\, 0.3  \,Y_{1988} \,+\, (1- 0.3)\, E_{1987} \,=\, (0.3)(17.12)+(0.7)(16.74)=16.854  \)      <br>
      <p>
        All data exponentially smoothed with \(\alpha\) = 0.3 are given in [Table 13.2.2]. It can be seen that,
        in the exponential smoothing method, there is no loss of data at both ends, unlike the moving average method. 
        The crude oil price time series and exponentially smoothed data are shown in &lt;Figure 13.2.2&gt;. 
        It can be seen that the smoothed data are not significantly different from the original data. 
        If the value of\(\alpha\)  is small, more weight is given to the past data than to the present, 
        making it less sensitive to sudden changes in the present data. Conversely, the closer the value of 
        \(\alpha\) is to 1, that is, the more weight is given to the current data, the more the smoothed data
        resembles the original data, and the smoothing effect disappears.
      <p>
      <div class="textLeft">[Table 13.2.2] Price of Crude Oil and Exponential Smoothing with &alpha; =0.3 </div>
      <p>
      <table style="width:400px"> 
        <tr> 
          <th class="thGrey" style="width:100px">Year</th>
          <th class="thGrey" style="width:150px">Price of Oil</th>
          <th class="thGrey" style="width:150px">Exponential Smoothing<br>&alpha;=0.3</th>
        </tr>
        <tr> 
           <td class="tdCenter">
             1987<br>
             1988<br>
             1989<br>
             1990<br>
             1991<br>
             1992<br>
             1993<br>
             1994<br>
             1995<br>
             1996<br>
             1997<br>
             1998<br>
             1999<br>
             2000<br>
             2001<br>
             2002<br>
             2003<br>
             2004<br>
             2005<br>
             2006<br>
             2007<br>
             2008<br>
             2009<br>
             2010<br>
             2011<br>
             2012<br>
             2013<br>
             2014<br>
             2015<br>
             2016<br>
             2017<br>
             2018<br>
             2019<br>
             2020<br>
             2021<br>
             2022<br>
           </td> 
           <td class="tdCenter">
             16.74 <br>
             17.12 <br>
             21.84 <br>
             28.48 <br>
             19.15 <br>
             19.49 <br>
             14.19 <br>
             17.77 <br>
             19.54 <br>
             25.90 <br>
             17.65 <br>
             12.14 <br>
             25.76 <br>
             26.72 <br>
             19.96 <br>
             31.21 <br>
             32.51 <br>
             43.36 <br>
             61.06 <br>
             60.85 <br>
             95.95 <br>
             44.60 <br>
             79.39 <br>
             91.38 <br>
             98.83 <br>
             91.83 <br>
             98.17 <br>
             53.45 <br>
             37.13 <br>
             53.75 <br>
             60.46 <br>
             45.15 <br>
             61.14 <br>
             48.52 <br>
             75.21 <br>
             106.95<br>
          </td> 
           <td class="tdCenter">
             16.740<br>
             16.854<br>
             18.350<br>
             21.389<br>
             20.717<br>
             20.349<br>
             18.501<br>
             18.282<br>
             18.659<br>
             20.832<br>
             19.877<br>
             17.556<br>
             20.017<br>
             22.028<br>
             21.408<br>
             24.348<br>
             26.797<br>
             31.766<br>
             40.554<br>
             46.643<br>
             61.435<br>
             56.385<br>
             63.286<br>
             71.714<br>
             79.849<br>
             83.443<br>
             87.861<br>
             77.538<br>
             65.416<br>
             61.916<br>
             61.479<br>
             56.580<br>
             57.948<br>
             55.120<br>
             61.146<br>
             74.888<br>
          </td> 
         </tr>
      </table>
      <p>
      <table style="width:650px">
        <tr>
          <td>
            <input class="qrBtn" type="image" src="../../QR/eStatU330_TimeseriesSmoothing.svg" onclick="window.open(addrStr[134])">
          </td>
          <td>
            <img class="imgFig600400" src="../Figure/Fig130202.png">
            <div class="figText">&lt;Figure 13.2.2&gt; Price of Crude Oil and Exponential Smoothing with &alpha;=0.3 </div>
          </td>
        </tr>
      </table>
    </div>
  <p>
  <h4>13.2.3 Filtering by Moving Median</h4>
  <p>
    <div class="mainTable">
        The N-point <b>centered moving median</b> of a time series refers to the median of N data from a single point 
        in time \(t\). For example, in crude oil price data, the value of a five-point moving median for a specific 
        year is the median of data for two years before a certain year, that year, and data for two years thereafter. 
        If data are denoted by \(Y_{t-2} ,Y_{t-1} , Y_{t}  , Y_{t+1} ,   Y_{t+2}   \), and the data are sorted from
        smallest to largest, and expressed as \(Y_{(t-2)} ,Y_{(t-1)} , Y_{(t)} , Y_{(t+1)} , Y_{(t+2)} \), 
        the median value is \(Moving Median_t \,=\, Y_{(t)}\).
      <p>
        For example, the 1989 5-point central moving median for crude oil prices in [Table 13.2.3] is as follows:
      <p>
        \(\qquad MovingMedian_{1989} \,=\, median \{ Y_{1987} , Y_{1988} ,Y_{1989} , Y_{1990} , Y_{1991} \} \)
        \(\qquad \qquad \qquad \qquad \qquad \;\;=\, median \{16.74, 17.12 , 21.84 , 28.48,19.15 \}  \,=\, 19.15 \)
      <p>
        [Table 13.2.3] and &lt;Figure 13.2.3&gt; show all the five-point moving median values obtained in this way and their graphs. Note that the moving median for the first two years and the last two years are not available here. Because the centered moving medians remove extreme values, it is called a filtering and the time series is much smoother than the original data.
      <p>
      <div class="textLeft"> [Table 13.2.3] Price of Crude Oil and 5-point Centered Moving Median</div>
      <p>
      <table style="width:400px"> 
        <tr> 
          <th class="thGrey" style="width:100px">Year</th>
          <th class="thGrey" style="width:150px">Price of Oil</th>
          <th class="thGrey" style="width:150px">5-point Centered Moving Median</th>
        </tr>
        <tr> 
           <td class="tdCenter">
             1987<br>
             1988<br>
             1989<br>
             1990<br>
             1991<br>
             1992<br>
             1993<br>
             1994<br>
             1995<br>
             1996<br>
             1997<br>
             1998<br>
             1999<br>
             2000<br>
             2001<br>
             2002<br>
             2003<br>
             2004<br>
             2005<br>
             2006<br>
             2007<br>
             2008<br>
             2009<br>
             2010<br>
             2011<br>
             2012<br>
             2013<br>
             2014<br>
             2015<br>
             2016<br>
             2017<br>
             2018<br>
             2019<br>
             2020<br>
             2021<br>
             2022<br>
           </td> 
           <td class="tdCenter">
             16.74 <br>
             17.12 <br>
             21.84 <br>
             28.48 <br>
             19.15 <br>
             19.49 <br>
             14.19 <br>
             17.77 <br>
             19.54 <br>
             25.90 <br>
             17.65 <br>
             12.14 <br>
             25.76 <br>
             26.72 <br>
             19.96 <br>
             31.21 <br>
             32.51 <br>
             43.36 <br>
             61.06 <br>
             60.85 <br>
             95.95 <br>
             44.60 <br>
             79.39 <br>
             91.38 <br>
             98.83 <br>
             91.83 <br>
             98.17 <br>
             53.45 <br>
             37.13 <br>
             53.75 <br>
             60.46 <br>
             45.15 <br>
             61.14 <br>
             48.52 <br>
             75.21 <br>
             106.95<br>
          </td> 
           <td class="tdCenter">
             <br>
             <br>
             19.15<br>
             19.49<br>
             19.49<br>
             19.15<br>
             19.15<br>
             19.49<br>
             17.77<br>
             17.77<br>
             19.54<br>
             25.76<br>
             19.96<br>
             25.76<br>
             26.72<br>
             31.21<br>
             32.51<br>
             43.36<br>
             60.85<br>
             60.85<br>
             61.06<br>
             79.39<br>
             91.38<br>
             91.38<br>
             91.83<br>
             91.83<br>
             91.83<br>
             53.75<br>
             53.75<br>
             53.45<br>
             53.75<br>
             53.75<br>
             60.46<br>
             61.14<br>
             <br>
             <br>
          </td> 
         </tr>
      </table>
      <p>
      <table style="width:650px">
        <tr>
          <td>
            <input class="qrBtn" type="image" src="../../QR/eStatU330_TimeseriesSmoothing.svg" onclick="window.open(addrStr[134])">
          </td>
          <td>
            <img class="imgFig600400" src="../Figure/Fig130203.png">
            <div class="figText">&lt;Figure 13.2.3&gt;  Price of Crude Oil and 5-point Centered Moving Median</div>
          </td>
        </tr>
      </table>
      <p>
        If the value of N is an even number, there is a difficulty in obtaining the central moving median having 
        the same number of data on both sides of the base year. For example, the center of the four-point moving 
        median from 1987 to 1990 is between 1988 and 1989. If you denote this as \(Median_{1988.5}\), it can be 
        calculated as follows:
      <p>
        \(\qquad MovingMedian_{1988.5} \,=\, median \{Y_{1987} , Y_{1988} , Y_{1989} , Y_{1990} \} \)
        \(\qquad \qquad \qquad \qquad \qquad \;=\,  median \{16.74 , 17.12 , 21.84 , 28.48 \}  \,=\, \frac {17.12 +21.84} {2} = 19.48 \)
      <p>
        The 4-point moving median obtained in this way is called the non-central 4-point moving median. 
        As such, the non-central moving average in the case of this even number N does not match the 
        observation year of the original data, which is inconvenient. In the case of this even number, 
        it is calculated as the average of the values of the two non-central moving medians that are 
        adjacent to each other. In other words, the central four-point moving median in 1989 is the mean of
        \(MovingMedian_{1988.5}\)  and \(MovingMedian_{1989.5}\).
    </div>
    <p>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(131)">&#10094; &nbsp;&nbsp;<b>Previous</b></button>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(133)"><b>Next</b>&nbsp;&nbsp; &#10095;</button>
  <p>

</div>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="https://maxcdn.bootstrapcdn.com/js/ie10-viewport-bug-workaround.js"></script>
    <script>
        //document.getElementById('sidebar').getElementsByTagName('ul')[0].className += "nav nav-sidebar";
        
        /* ajust the height when click the toc
           the code is from https://github.com/twbs/bootstrap/issues/1768
        */
        var shiftWindow = function() { scrollBy(0, -50) };
        window.addEventListener("hashchange", shiftWindow);
        function load() { if (window.location.hash) shiftWindow(); }
        
        /*add Bootstrap styles to tables*/
        var tables = document.getElementsByTagName("table");
        for(var i = 0; i < tables.length; ++i){
            tables[i].className += "table table-bordered table-hover";
        }
    </script>

</body>
</html>

