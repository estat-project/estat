<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <title>Chapter 9</title>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="../../css/ie10-viewport-bug-workaround.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="../../css/dashboard.css" rel="stylesheet">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <style type="text/css">code{white-space: pre;}</style>
       <style type="text/css">.sidebar ul{padding-left: 10px;}</style>
       <script src="../../js/prism.js"></script>
       <link rel="stylesheet" href="../../css/prism.css">
       <script src="../../js/jquery.min.js"></script>    
       <script type="text/javascript" id="MathJax-script" async
	       src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
       </script>
       <script>
	 $(document).ready(function() {
  	     toc = $("#sidebar > ul > li > ul");
  	     sections = toc.children();   // <li>
  	     for(var i=0; i<sections.length; i++) {
  		 if ($(sections[i]).children().length == 1) { continue; }
  		 var first = sections[i].firstElementChild;  // <a>
  		 var last = sections[i].lastElementChild;
  		 var li = $("<li>");
  		 var details = $("<details>");
  		 var summary = $("<summary>");
  		 $(summary).append(first)
  		 $(details).append(summary);
  		 $(details).append(last);
  		 $(li).append(details);	
  		 $(sections[i]).replaceWith(li);
  	     }
	 });
	 </script>
       <link rel="stylesheet" href="../../css/pandoc.css">
       <script src="../../js/eBook.js"></script>
       <script src="../../../eStat/js/language.js" ></script>   
       <script src="../../../eStat/lib/d3/d3.v4.min.js"></script>   
       <script src="../../../eStat/lib/DistributionsUtil.js" ></script>
       <script src="../../../eStat/js/eStatU.js"></script>
       <script src="../../../eStat/lib/FileSaver.min.js" ></script>
       <script src="../../../eStat/lib/convertSVG.js"></script>
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
  <ul class="nav navbar-nav">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Chapter<span class="caret"></span></a>
      <ul class="dropdown-menu"> 
        <li><a href="../index.html">HOME</a></li>
        <li><a href="../chapter01/index.html">Chapter 1</a></li>
        <li><a href="../chapter02/index.html">Chapter 2</a></li>
        <li><a href="../chapter03/index.html">Chapter 3</a></li>
        <li><a href="../chapter04/index.html">Chapter 4</a></li>
        <li><a href="../chapter05/index.html">Chapter 5</a></li>
        <li><a href="../chapter06/index.html">Chapter 6</a></li>
        <li><a href="../chapter07/index.html">Chapter 7</a></li>
        <li><a href="../chapter08/index.html">Chapter 8</a></li>
        <li><a href="../chapter09/index.html">Chapter 9</a></li>
        <li><a href="../chapter10/index.html">Chapter 10</a></li>
        <li><a href="../chapter11/index.html">Chapter 11</a></li>
        <li><a href="../chapter12/index.html">Chapter 12</a></li>
        <li><a href="../chapter13/index.html">Chapter 13</a></li>
      </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Section<span class="caret"></span></a>
	  <ul class="dropdown-menu"> 
                <li><a href="../chapter09/0901.html">9.1 Analysis of Variance for Experiments of Single Factor</a></li>
                <li><a href="../chapter09/090101.html">&nbsp;&nbsp;9.1.1 Multiple Comparison</a></li>
                <li><a href="../chapter09/090101.html">&nbsp;&nbsp;9.1.2 Residual Analysis</a></li>
                <li><a href="../chapter09/0902.html">9.2 Design of Experiments for Sampling</a></li>
                <li><a href="../chapter09/0902.html">&nbsp;&nbsp;9.2.1 Completely Randomized Design</a></li>
                <li><a href="../chapter09/0902.html">&nbsp;&nbsp;9.2.2 Randomized Block Design</a></li>
                <li><a href="../chapter09/0903.html">9.3 Analysis of Variance for Experiments of Two Factors</a></li>
                <li><a href="../chapter09/0904.html">9.4 Exercise</a></li>
	  </ul>
    </li>
    <li><a class="navbar-brand" href="../../../eStat/index.html" target="_blank">eStat</a></li>
    <li><a class="navbar-brand" href="../../../eStatU/index.html" target="_blank">eStatU</a></li>
    <li><a class="navbar-brand" href="../../Distribution/index.html" target="_blank">Distribution</a></li>
  </ul>
</nav>

<div class="container-fluid">
  <div class="row">
    <div id="sidebar" class="col-sm-3 col-md2 sidebar">
      <ul>
	<li><a href=""></a>
	  <ul>
            <li><a href="../index.html">HOME</a></li>
	    <li><a href="../chapter01/index.html">Chapter 1</a>
	      <ul>
                <li><a href="../chapter01/0101.html">1.1 Statistics and Data Science</a></li>
                <li><a href="../chapter01/0102.html">1.2 Population and Sample</a></li>
                <li><a href="../chapter01/0103.html">1.3 Variables and Data</a></li>
                <li><a href="../chapter01/0104.html">1.4 Softwares for Statistical Analysis</a></li>
                <li><a href="../chapter01/0105.html">1.5 Exercies</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter02/index.html">Chapter 2</a>
	      <ul>
                <li><a href="../chapter02/0201.html">2.1 Visualization of Qualitative Data</a></li>
                <li><a href="../chapter02/0202.html">2.2 Visualization of Summary Data</a></li>
                <li><a href="../chapter02/0202.html">&nbsp;&nbsp;2.2.1 Summary Data of Categorical Variable</a></li>
                <li><a href="../chapter02/0202.html">&nbsp;&nbsp;2.2.2 Summary Data of Categorical Variable with Group</a></li>
                <li><a href="../chapter02/0203.html">2.3 Visualization of Raw Data</a></li>
                <li><a href="../chapter02/0203.html">&nbsp;&nbsp;2.3.1 Raw Data of Categorical Variable</a></li>
                <li><a href="../chapter02/0203.html">&nbsp;&nbsp;2.3.2 Raw Data of Categorical Variable with Group</a></li>
                <li><a href="../chapter02/0204.html">2.4 Word Cloud</a></li>
                <li><a href="../chapter02/0205.html">2.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter03/index.html">Chapter 3</a>
	      <ul>
                <li><a href="../chapter03/0301.html">3.1 Visualization of Quantitative Data</a></li> 
                <li><a href="../chapter03/0302.html">3.2 Visualization of Single Quantitative Variable</a></li>
                <li><a href="../chapter03/0302.html">&nbsp;&nbsp;3.2.1 Visualization of Quantitative Data without Group</a></li>
                <li><a href="../chapter03/0302.html">&nbsp;&nbsp;3.2.2 Visualization of Quantitative Data with Group</a></li>
                <li><a href="../chapter03/0303.html">3.3 Visualization of Two Quantitative Variables</a></li>
                <li><a href="../chapter03/0304.html">3.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter04/index.html">Chapter 4</a>
	      <ul>
                <li><a href="../chapter04/0401.html">4.1 Frequency Table for Single Variable</a></li>
                <li><a href="../chapter04/0401.html">&nbsp;&nbsp;4.1.1 Frequency Table for Categorical Variable</a></li>
                <li><a href="../chapter04/0401.html">&nbsp;&nbsp;4.1.2 Frequency Table for Quantitative Variable</a></li>
                <li><a href="../chapter04/0402.html">4.2 Contingency Table for Two Variables</a></li>
                <li><a href="../chapter04/0402.html">&nbsp;&nbsp;4.2.1 Contingency Table for Two Categorical Variables</a></li>
                <li><a href="../chapter04/0402.html">&nbsp;&nbsp;4.2.2 Contingency Table for Two Quantitative Variables</a></li>
                <li><a href="../chapter04/040301.html">4.3 Summary Measures for Quantitative Variable</a></li>
                <li><a href="../chapter04/040301.html">&nbsp;&nbsp;4.3.1 Measures of Central Tendency</a></li>
                <li><a href="../chapter04/040302.html">&nbsp;&nbsp;4.3.2 Measures of Dispersion</a></li>
                <li><a href="../chapter04/0404.html">4.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter05/index.html">Chapter 5</a>
	      <ul>
                <li><a href="../chapter05/0501.html">5.1 Definition of Probability</a></li>
                <li><a href="../chapter05/0502.html">5.2 Calculation of Probability</a></li>
                <li><a href="../chapter05/0503.html">5.3 Discrete Random Variable</a></li>
		<li><a href="../chapter05/050301.html">&nbsp;&nbsp;5.3.1 Binomial Distribution</a></li>
		<li><a href="../chapter05/050302.html">&nbsp;&nbsp;5.3.2 Poissson Distribution</a></li>
		<li><a href="../chapter05/050303.html">&nbsp;&nbsp;5.3.3 Geometric Distribution</a></li>
		<li><a href="../chapter05/050304.html">&nbsp;&nbsp;5.3.4 Hypergeometric Distribution</a></li>
                <li><a href="../chapter05/0504.html">5.4 Continuous Random Variable</a></li>
		<li><a href="../chapter05/050401.html">&nbsp;&nbsp;5.4.1 Normal Distribution</a></li>
		<li><a href="../chapter05/050402.html">&nbsp;&nbsp;5.4.2 Exponential Distribution</a></li>
                <li><a href="../chapter05/0505.html">5.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter06/index.html">Chapter 6</a>
	      <ul>
                <li><a href="../chapter06/0601.html">6.1 Simple Random Sampling</a></li>
                <li><a href="../chapter06/060201.html">6.2 Sampling Distribution of Sample Means and Estimation of the Population Mean</a></li>
                <li><a href="../chapter06/060201.html">&nbsp;&nbsp;6.2.1 Sampling Distribution of Sample Means</a></li>
                <li><a href="../chapter06/060202.html">&nbsp;&nbsp;6.2.2 Estimation of the Population Mean</a></li>
                <li><a href="../chapter06/060301.html">6.3 Sampling Distribution of Sample Variances and Estimation of the Population Variance</a></li>
                <li><a href="../chapter06/060301.html">&nbsp;&nbsp;6.3.1 Sampling Distribution of Sample Variances</a></li>
                <li><a href="../chapter06/060302.html">&nbsp;&nbsp;6.3.2 Estimation of the Population Variance</a></li>
                <li><a href="../chapter06/060401.html">6.4 Sampling Distribution of Sample Proportions and Estimation of the Population Proportion</a></li>
                <li><a href="../chapter06/060401.html">&nbsp;&nbsp;6.4.1 Sampling Distribution of Sample Proportions</a></li>
                <li><a href="../chapter06/060402.html">&nbsp;&nbsp;6.4.2 Estimation of the Population Proportion</a></li>
                <li><a href="../chapter06/0605.html">6.5 Determination of the Sample Size  </a></li>
                <li><a href="../chapter06/0605.html">&nbsp;&nbsp;6.5.1 Determination of the Sample Size to Estimate the Population Mean </a></li>
                <li><a href="../chapter06/0605.html">&nbsp;&nbsp;6.5.2 Determination of the Sample Size to Estimate the Population Proportion</a></li> 
                <li><a href="../chapter06/0606.html">6.6 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter07/index.html">Chapter 7</a>
	      <ul>
                <li><a href="../chapter07/0701.html">7.1 Testing Hypothesis for a Population Mean</a></li>
                <li><a href="../chapter07/0702.html">7.2 Testing Hypothesis for a Population Variance</a></li>
                <li><a href="../chapter07/0703.html">7.3 Testing Hypothesis for a Population Proportion</a></li>
                <li><a href="../chapter07/0704.html">7.4 Testing Hypothesis with α and β simultaneously</a></li>
                <li><a href="../chapter07/0704.html">&nbsp;&nbsp;7.4.1 Type 2 Error and Power of a Test</a></li>
                <li><a href="../chapter07/0704.html">&nbsp;&nbsp;7.4.2 Testing Hypothesis with α and β</a></li>
                <li><a href="../chapter07/0705.html">7.5 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter08/index.html">Chapter 8</a>
	      <ul>
                <li><a href="../chapter08/080101.html">8.1 Testing Hypothesis for Two Population Means</a></li>
                <li><a href="../chapter08/080101.html">&nbsp;&nbsp;8.1.1 Two Independent Samples</a></li>
                <li><a href="../chapter08/080102.html">&nbsp;&nbsp;8.1.2 Paired Sample</a></li>
                <li><a href="../chapter08/0802.html">8.2 Testing Hypothesis for Two Population Variances</a></li>
                <li><a href="../chapter08/0803.html">8.3 Testing Hypothesis for Two Population Proportions</a></li>
                <li><a href="../chapter08/0804.html">8.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter09/index.html">Chapter 9</a>
	      <ul>
                <li><a href="../chapter09/0901.html">9.1 Analysis of Variance for Experiments of Single Factor</a></li>
                <li><a href="../chapter09/090101.html">&nbsp;&nbsp;9.1.1 Multiple Comparison</a></li>
                <li><a href="../chapter09/090101.html">&nbsp;&nbsp;9.1.2 Residual Analysis</a></li>
                <li><a href="../chapter09/0902.html">9.2 Design of Experiments for Sampling</a></li>
                <li><a href="../chapter09/0902.html">&nbsp;&nbsp;9.2.1 Completely Randomized Design</a></li>
                <li><a href="../chapter09/0902.html">&nbsp;&nbsp;9.2.2 Randomized Block Design</a></li>
                <li><a href="../chapter09/0903.html">9.3 Analysis of Variance for Experiments of Two Factors</a></li>
                <li><a href="../chapter09/0904.html">9.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter10/index.html">Chapter 10</a>
	      <ul>
                <li><a href="../chapter10/1001.html">10.1 Nonparametric Test for the Location Parameter of Single Population  </a></li>
                <li><a href="../chapter10/1001.html">&nbsp;&nbsp;10.1.1 Sign Test</a></li>
                <li><a href="../chapter10/100102.html">&nbsp;&nbsp;10.1.2 Wilcoxon Signed Rank Sum Test</a></li>
                <li><a href="../chapter10/1002.html">10.2 Nonparametric Test for Location Parameters of Two Populations</a></li>
                <li><a href="../chapter10/1002.html">&nbsp;&nbsp;10.2.1 Independent Samples: Wilcoxon Rank Sum Test</a></li>
                <li><a href="../chapter10/100202.html">&nbsp;&nbsp;10.2.2 Paired Samples: Wilcoxon Signed Rank Sum Test</a></li>
                <li><a href="../chapter10/1003.html">10.3 Nonparametric Test for Location Parameters of Several Populations</a></li>
                <li><a href="../chapter10/1003.html">&nbsp;&nbsp;10.3.1 Completely Randomized Design: Kruskal-Wallis Test</a></li>
                <li><a href="../chapter10/100302.html">&nbsp;&nbsp;10.3.2 Randomized Block Design: Friedman Test</a></li>
                <li><a href="../chapter10/1004.html">10.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter11/index.html">Chapter 11</a>
	      <ul>
                <li><a href="../chapter11/1101.html">11.1 Goodness of Fit Test</a></li>
                <li><a href="../chapter11/1101.html">&nbsp;&nbsp;11.1.1 Goodness of Fit Test for Categorical Distribution</a></li>
                <li><a href="../chapter11/110102.html">&nbsp;&nbsp;11.1.2 Goodness of Fit Test for Continuous Distribution</a></li>
                <li><a href="../chapter11/1102.html">11.2 Testing Hypothesis for Contingency Table</a></li>
                <li><a href="../chapter11/1102.html">&nbsp;&nbsp;11.2.1 Independence Test</a></li>
                <li><a href="../chapter11/110202.html">&nbsp;&nbsp;11.2.2 Homogeneity Test</a></li>
                <li><a href="../chapter11/1103.html">11.3 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter12/index.html">Chapter 12</a>
	      <ul>
                <li><a href="../chapter12/1201.html">12.1 Correlation Analysis</a></li>
                <li><a href="../chapter12/1202.html">12.2 Simple Linear Regression Analysis</a></li>
                <li><a href="../chapter12/1203.html">12.3 Multiple Linear Regression Analysis</a></li>
                <li><a href="../chapter12/1204.html">12.4 Exercise</a></li>
	      </ul>
	    </li>
	    <li><a href="../chapter13/index.html">Chapter 13</a>
	      <ul>
                <li><a href="../chapter13/1301.html">13.1 What is Time Series Analysis?</a></li>
                <li><a href="../chapter13/1302.html">13.2 Smoothing of Time Series</a></li>
                <li><a href="../chapter13/1303.html">13.3 Transformation of Time Series</a></li>
                <li><a href="../chapter13/1304.html">13.4 Regression Model and Forecasting</a></li>
                <li><a href="../chapter13/1305.html">13.5 Exponential Smoothing Model and Forecasting</a></li>
                <li><a href="../chapter13/1306.html">13.6 Seasonal Model and Forecasting</a></li>
                <li><a href="../chapter13/1307.html">13.7 Exercise</a></li>
	      </ul>
	    </li>

	  </ul>
	</li>
      </ul>
    </div>
  </div>
</div>

<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">


  <!--***********************************************************************-->
  <h2>Chapter 9. Testing Hypothesis for Several Population Means</h2> 
  <p>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(94)">&#10094; &nbsp;&nbsp;<b>Previous</b></button>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(97)"><b>Next</b>&nbsp;&nbsp; &#10095;</button>
  <p>
  <h3>9.3 Analysis of Variance for Two Factors</h3>
  <p>
  <h6>
      <a href="0903.pdf" target="_blank"><u>[presentation]</u></a>&nbsp;&nbsp;&nbsp;
      <a href="https://youtu.be/Cp5_Qydpb74" target="_blank"><u>[video]</u></a>
  </h6>
  <p>

    <div class="mainTable">
      If there are two factors affecting the response variable, the analysis is called a two-way analysis of variances. 
      This technique is frequently used in experiments such as engineering, medicine and agriculture. The response 
      variable is observed at each combination of levels of two factors (denoted as A and B). In general, it is 
      advisable to repeat at least two experiments at each combination of levels of two factors, if possible, in order 
      to increase the reliability of the experimental results. 
      <p>
      When data are obtained from repeated experiments at each factor level, the two-way ANOVA tests whether the 
      population means of each level of factor A  are the same (called the <b>main effect test of the factor A</b>) as the 
      one-way ANOVA, or tests whether the population means of each level of factor B are the same (called the <b>main 
      effect test of the factor B</b>). In addition, the two-way ANOVA tests whether the effect of one factor A is 
      influenced by each level of the other factor B (called the <b>interaction effect test</b>). For example, in a chemical 
      process, if the higher the pressure when the temperature is low, the greater the amount of products, and the 
      lower the pressure when the temperature is high, the greater the amount of products, the interaction effect 
      exists between the two factors of temperature and pressure. The interaction effect exists where the effects of 
      one factor change with changes in the level of another factor.
    </div>
    <p>
      
    <div class="mainTableYellow">
      <b>Main effect and Interaction effect</b>
      <p>
      When data are obtained from repeated experiments at each factor level, the two-way ANOVA tests whether the 
      population means of each level of factor A (called the main effect test of the factor A) are the same as the 
      one-way ANOVA, or tests whether the population means of each level of factor B are the same (called the 
      <b>main effect</b> test of the factor B). 
      <p>
      The two-way ANOVA also tests whether the effect of one factor A is influenced by each level of the other factor B 
      (called the <b>interaction effect</b> test). 
    </div>
    <p>

    <!------------------------------------------------------------------------------------------------->
    <div class="mainTableGrey">
       <p>
       <b>Example 9.3.1</b>
       Table 9.3.1 shows the yield data of three repeated agricultural experiments for each combination of four 
       fertilizer levels and three rice types to investigate the yield of rice. 
    <p>
      <div class="textLeft"> Table 9.3.1  Yield of rice by fertilizers and types of rice (unit kg)</div>
      <p>
       <table style="width:500px"> 
         <tr> 
           <th style="width:100px">Fertilizer</th>
           <th>Rice type 1</th>
           <th>Rice type 2</th>
           <th>Rice type 3</th>
         </tr>
         <tr> 
           <td class="tdCenter">1</td>
           <td class="tdCenter">64, 66, 70</td>
           <td class="tdCenter">72, 81, 64</td>
           <td class="tdCenter">74, 51, 65</td>
         </tr>
         <tr> 
           <td class="tdCenter">2</td>
           <td class="tdCenter">65, 63, 58</td>
           <td class="tdCenter">57, 43, 52</td>
           <td class="tdCenter">47, 58, 67</td>
         </tr>
         <tr> 
           <td class="tdCenter">3</td>
           <td class="tdCenter">59, 68, 65</td>
           <td class="tdCenter">66, 71, 59</td>
           <td class="tdCenter">58, 45, 42</td>
         </tr>
         <tr> 
           <td class="tdCenter">4</td>
           <td class="tdCenter">58, 50, 49</td>
           <td class="tdCenter">57, 61, 53</td>
           <td class="tdCenter">53, 59, 38</td>
         </tr>
      </table>
      <p>
      <div class="textLeft">[Ex] ⇨ eBook ⇨ EX090301_YieldByRiceFertilzer.csv</div>
      <p>       
      <div class="textL20M20">
        1) Find the average yield for each combination of fertilizers and rice types.
      </div>       
      <div class="textL20M20">
        2) Using 『eStat』, draw a scatter plot with the rice types (1, 2 and 3) as X-axis and the yield as Y-axis. 
           Separate the color of dots in the scatter plot by the type of fertilizer. Then, show the average of the 
           combinations at each level on the scatter plot and connect them with lines for each type of fertilizer to observe. 
      </div>       
      <div class="textL20M20">
        3) Test the main effects of fertilizers and rice types and test the interaction effect of the two factors.
      </div>       
      <div class="textL20M20">
        4) Using 『eStat』, check the result of the two-way analysis of variance.
      </div>       
      <p>
      <b>Answer</b>
      <p>
      <div class="textL20M20">
        1) For convenience, let us call the fertilizer as the factor A and the rice type as factor B. 
           The averages of the rice yield for each level combination of two factors are shown in Table 9.3.2. 
           Denote the \(k^{th}\) rice yield, \(y_{ijk}\), and average \({\overline y}_{ij\cdot}\) of each combination
           of \(j^{th}\) level of factor A and \(i^{th}\) level of factor B. Also, denote the average of 
           \(j^{th}\) level of factor A as \({\overline y}_{\cdot j \cdot}\), the average of \(i^{th}\) level of 
           factor B as \({\overline y}_{i \cdot \cdot}\), and the global average as 
           \({\overline y}_{\cdot \cdot \cdot}\). 
      </div>
      <p>
      <div class="textLeft">Table 9.3.2 Average yield of rice by fertilizers and types of rice (unit kg)</div>
      <p>
      <table style="width:500px"> 
         <tr> 
           <th>(Factor B)<br>Fertilizer</th>
           <th>(Factor A)<br>Rice type 1</th>
           <th>(Factor A)<br>Rice type 2</th>
           <th>(Factor A)<br>Rice type 3</th>
           <th>Row Average</th>
         </tr>
         <tr> 
           <td class="tdCenter">1</td>
           <td class="tdCenter">\(\overline y_{11\cdot}\) = 66.7</td>
           <td class="tdCenter">\(\overline y_{12\cdot}\) = 72.3</td>
           <td class="tdCenter">\(\overline y_{13\cdot}\) = 63.3</td>
           <td class="tdCenter">\(\overline y_{1\cdot\cdot}\) = 67.4</td>
         </tr>
         <tr> 
           <td class="tdCenter">2</td>
           <td class="tdCenter">\(\overline y_{21\cdot}\) = 62.0</td>
           <td class="tdCenter">\(\overline y_{22\cdot}\) = 50.7</td>
           <td class="tdCenter">\(\overline y_{23\cdot}\) = 57.3</td>
           <td class="tdCenter">\(\overline y_{2\cdot\cdot}\) = 56.7</td>
         </tr>
         <tr> 
           <td class="tdCenter">3</td>
           <td class="tdCenter">\(\overline y_{31\cdot}\) = 64.0</td>
           <td class="tdCenter">\(\overline y_{32\cdot}\) = 65.3</td>
           <td class="tdCenter">\(\overline y_{33\cdot}\) = 48.3</td>
           <td class="tdCenter">\(\overline y_{3\cdot\cdot}\) = 59.2</td>
         </tr>
         <tr> 
           <td class="tdCenter">4</td>
           <td class="tdCenter">\(\overline y_{41\cdot}\) = 52.3</td>
           <td class="tdCenter">\(\overline y_{42\cdot}\) = 57.0</td>
           <td class="tdCenter">\(\overline y_{43\cdot}\) = 50.0</td>
           <td class="tdCenter">\(\overline y_{4\cdot\cdot}\) = 53.1</td>
         </tr>
         <tr> 
           <td class="tdCenter"><b>Column Average</b></td>
           <td class="tdCenter">\(\overline y_{\cdot1\cdot}\) = 61.3</td>
           <td class="tdCenter">\(\overline y_{\cdot2\cdot}\) = 61.3</td>
           <td class="tdCenter">\(\overline y_{\cdot3\cdot}\) = 54.8</td>
           <td class="tdCenter">\(\overline y_{\cdot\cdot\cdot}\) = 59.1</td>
         </tr>
      </table>
      <p>

      <div class="textL20M20">
        2) To draw a scatter plot for the two-way ANOVA using 『eStat』, enter data as &lt;Figure 9.3.1&gt; 
           where the fertilizer is variable 1, the rice type is variable 2 and the rice yield is variable 3.
        <table class="width:650px">
          <tr>
            <td>
              <input class="qrBtn" type="image" src="../../QR/EX090301.svg" onclick="window.open(addrStr[29])">
            </td>
            <td>
              <img class="imgFig600400" src="../Figure/Fig090301.png">
              <div class="figText">&lt;Figure 9.3.1&gt; Data input for two-way ANOVA of 『eStat』</div>
            </td>
          </tr>
        </table>
       </div>
       <p>
       <div class="textL20">
            In the variable selection box which appears by clicking the ANOVA icon  on the main menu,
            select 'Analysis Var' as Yield and 'By Group' as Rice and Fertilizer, then the scatter plot
            of the yield by rice type will appear as in &lt;Figure 9.3.2&gt;. In addition, the average yields 
            at each rice type by fertilizer are marked as dots linking them with lines by fertilizer. 
            In this graph, rice type 1 always yields more than rice type 3 regardless of the fertilizer used. 
            Rice type 2 varies in yield depending on the type of fertilizer used, which shows the existence of
            interaction, and the use of fertilizer 1 usually results in a high yield regardless of the rice types. 
         <p>
           <img class="imgFig600400" src="../Figure/Fig090302.svg">
           <div class="figText">&lt;Figure 9.3.2&gt; Yields by rice types and fertilizer types</div>
      </div>       
      <p>
 
      <div class="textL20M20">
        3) Testing the factor A, which is to test the main effect of rice types, implies to test the following null hypothesis.
      </div>
      <p>
      <div class="textL20">
          \(\quad \small H_0\) : The average yields of the three rice types are the same.
        <p>
        If the null hypothesis is rejected, we conclude that the main effect of rice types exists. 
        In order to test the main effect of rice types, as in the one-way analysis of variance, the sum of 
        squared distances from each average yield \({\overline y}_{\cdot j \cdot}\) of rice type  to the overall 
        average yield \({\overline y}_{\cdot \cdot \cdot}\). 
        <p>
          \(\quad \small {SSA} = 12(61.3-{\overline y}_{\cdot \cdot \cdot})^2 + 12(61.3-{\overline y}_{\cdot \cdot \cdot})^2 + 12(54.8-{\overline y}_{\cdot \cdot \cdot})^2 \) = 342.39
        <p>
        where the weight of 12 of each sum of squares is the number of data for each rice type. Since there are 
        3 rice types, the degrees of freedom of \(\small SSA\) is (3-1) and we call the sum of squares \(\small SSA\) divided
        by (3-1), \(\frac{SSA}{(3-1)}\), is the mean squares of factor A, \(\small MSA\).
        <p>       
        Testing the factor B, which is to test the main effect of fertilizer types, implies to test the following 
        null hypothesis.
        <p>
          \(\quad \small H_0\) : The average yields of the four fertilizer types are the same.
        <p>
        If the null hypothesis is rejected, we conclude that the main effect of fertilizer types exists. 
        In order to test the main effect of fertilizer types, as in the one-way analysis of variance, 
        the sum of squared distances from each average yield \({\overline y}_{i \cdot \cdot}\) of fertilizer type 
        \(i\) to the overall average yield \({\overline y}_{\cdot \cdot \cdot}\), 
        <p>
          \(\quad \small {SSB} = 9(67.4 - {\overline y}_{\cdot \cdot \cdot})^2 + 9(56.7 - {\overline y}_{\cdot \cdot \cdot} )^2 + 9(59.2 - {\overline y}_{\cdot \cdot \cdot})^2 + 9(53.1 - {\overline y}_{\cdot \cdot \cdot})^2  \) = 1002.89
        <p>
        where the weight of 9 of each sum of squares is the number of data for each fertilizer type. 
        Since there are 4 fertilizer types, the degrees of freedom of \(\small SSB\) is (4-1) and we call 
        the sum of squares \(\small SSB\) divided by (4-1), \(\frac{SSB}{(4-1)}\), is the mean squares of factor B,
        \(\small MSB\).
        <p>
        Testing the interaction effect of rice and fertilizer (represented as factor AB) is to test the following 
        null hypothesis.
        <p>
          \(\quad \small H_0\) : There is no interaction effect between rice type and fertilizer type.
        <p>
        If the null hypothesis is rejected, we conclude that there is an interaction effect between rice types 
        and fertilizer types. In order to test the interaction effect, the sum of squared distances from each 
        average yield \({\overline y}_{ij \cdot}\) subtracting the average yield \({\overline y}_{i \cdot \cdot}\) of 
        fertilizer type \(i\), subtracting the average yield \({\overline y}_{\cdot j \cdot}\) of rice type \(j\), 
        adding the overall average yield \({\overline y}_{\cdot \cdot \cdot}\). 
        <p>
          \(\quad\)  \(\small {SSAB} = 3(66.7- {\overline y}_{1 \cdot \cdot} - {\overline y}_{\cdot 1 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2 + 3(72.3- {\overline y}_{1 \cdot \cdot} -{\overline y}_{\cdot 2 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2  + 3(63.3- {\overline y}_{1 \cdot \cdot} - {\overline y}_{\cdot 3 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2 \) <br>
          \(\qquad\) \(\small + 3(62.0- {\overline y}_{2 \cdot \cdot} - {\overline y}_{\cdot 1 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2 + 3(50.7- {\overline y}_{2 \cdot \cdot} - {\overline y}_{\cdot 2 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2 + 3(57.3- {\overline y}_{2 \cdot \cdot} -{\overline y}_{\cdot 3 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2  \)<br>
          \(\qquad\) \(\small + 3(64.0- {\overline y}_{3 \cdot \cdot} - {\overline y}_{\cdot 1 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2 + 3(65.3- {\overline y}_{3 \cdot \cdot} - {\overline y}_{\cdot 2 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2  + 3(48.3- {\overline y}_{3 \cdot \cdot} - {\overline y}_{\cdot 3 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2 \)<br>
          \(\qquad\) \(\small + 3(52.3- {\overline y}_{4 \cdot \cdot} - {\overline y}_{\cdot 1 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2 + 3(57.0- {\overline y}_{4 \cdot \cdot} - {\overline y}_{\cdot 2 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2 + 3(50.0- {\overline y}_{4 \cdot \cdot} -{\overline y}_{\cdot 3 \cdot} +{\overline y}_{\cdot \cdot \cdot})^2  \)<br>
        <p>
        where the weight of 3 of each sum of squares is the number of data for each cell of rice and fertilizer 
        type. The degrees of freedom of \(\small SSAB\) is (3-1)(4-1) and we call the sum of squares \(\small SSAB\) divided
        by  (3-1)(4-1), \(\small \frac {SSAB}{(3-1)(4-1)}\) is the mean squares of interaction AB, \(\small MSAB\).
        <p>
        It is not possible to test each effect immediately using these sum of squares, but the error sum of squares
        should be calculated. In order to calculate the error sum of squares, first we calculate the total sum 
        of squares which is the sum of the squared distances from each data to the overall average.
        <p>
          \(\quad \small {SST} =  ( 64 -{\overline y}_{\cdot \cdot \cdot})^2 + ( 66 -{\overline y}_{\cdot \cdot \cdot})^2 + ( 70 -{\overline y}_{\cdot \cdot \cdot})^2 + \cdots +
           ( 53 -{\overline y}_{\cdot \cdot \cdot})^2 + ( 59 -{\overline y}_{\cdot \cdot \cdot})^2  + ( 38 -{\overline y}_{\cdot \cdot \cdot})^2 = 3267.56 \)
        <p>
        This total sum of squares can be proven mathematically to be the sum of the other sums of squares as follows:
        <p>
          \(\quad \small {SST} = SSA + SSB + SSAB + SSE \)
        <p>
        Therefore, the error sum of squares can be calculated as follows:
        <p>
          \(\quad \small {SSE} = SST - (SSA + SSB + SSAB) \)
        <p>
        If the yields on each rice type or fertilizer type are assumed to be normal and the variances are the same, 
        the statistic which divides the each mean squares by the error mean squares follows \(F\) distribution. 
        Therefore, the main effects and interaction effect can be tested using \(F\) distributions. 
        If the interaction effect is separated, we test them first. Testing results using the 5% significance level
        are as follows:
        <p>
        ① Testing of the interaction effect on rice and fertilizer:
           <p>
             \(\qquad \small F_0 = \frac {MSAB}{MSE} = \frac { \frac{SSAB}{(3-1)(4-1)} } {\frac {SSE}{24}} \) = 1.77 <br>
             \(\qquad \small F_{6,24; 0.05} \) = 2.51
           <p>
           <div class="textL20">
             Since \(\small F_0\) < \(\small F_{6,24; 0.05} \), we conclude that there is no interaction.
             The interaction on rice and fertilizer in &lt;Figure 9.3.2&gt; is so small which is not statistically 
             significant and it may due to other kind of random error. The calculated \(p\)-value of 
             \(\small F_0\) = 1.77 using 『eStat』 is 0.1488.  
           </div>
        <p>
        ② Testing of the main effect on rice types (Factor A):
           <p>
             \(\qquad \small F_0 = \frac {MSA}{MSE} = \frac { \frac{SSA}{(3-1)} } {\frac {SSE}{24}}  \) = 3.08 <br>
             \(\qquad \small F_{2,24; 0.05} \) = 3.40
           <p>
           <div class="textL20">
             Since \(\small F_0\) < \(\small F_{2,24; 0.05} \), we can not reject the null hypothesis 
             that average yields of rice types are the same. There is not enough evidence statistically 
             that average yields are different depending on rice types. The calculated \(p\)-value of 
             \(\small F_0\) = 3.08 using 『eStat』 is 0.0644  
           </div>
        <p>
        ③ Testing of the main effect on fertilizer types (Factor B):
           <p>
             \(\qquad \small F_0 = \frac {MSB}{MSE} = \frac { \frac{SSB}{(4-1)} } {\frac {SSE}{24}} \) = 6.02 <br>
             \(\qquad \small F_{3,24; 0.05} \) = 3.01
           <p>
           <div class="textL20">
             Since \(\small F_0\) > \(\small F_{3,24; 0.05} \), we reject the null hypothesis that average yields
             of fertilizer types are the same. There is enough statistical evidence which shows that average 
             yields are different depending on fertilizer types. Since there is no interaction effect by 1), 
             we can conclude that fertilizer 1 produces more yields than other fertilizer. The calculated 
             \(p\)-value of \(\small F_0\) = 6.02 using 『eStat』 is 0.0033.  
           </div>
        <p>
        The result of the two-way analysis of variances is as Table 9.3.3.
      </div> 

           <p>
             <div class="textLeft">Table 9.3.3  two-way analysis of variance of yields by rice and fertilizer types</div>
           <p>
             <table style="width:600px"> 
                <tr> 
                  <th>Factor</th>
                  <th>Sum of Squares</th>
                  <th>Degree of freedom</th>
                  <th>Mean Squares</th>
                  <th>F value</th>
                  <th>p value</th>
                </tr>
                <tr> 
                  <td class="tdCenter">Rice Type</td>
                  <td class="tdCenter">342.3889</td>
                  <td class="tdCenter">2</td>
                  <td class="tdCenter">171.1944</td>
                  <td class="tdCenter">3.0815</td>
                  <td class="tdCenter">0.0644</td>
                </tr>
                <tr> 
                  <td class="tdCenter">Fertilizer Type</td>
                  <td class="tdCenter">1002.8889</td>
                  <td class="tdCenter">3</td>
                  <td class="tdCenter">334.2963</td>
                  <td class="tdCenter">6.0173</td>
                  <td class="tdCenter">0.0033</td>
                </tr>
                <tr> 
                  <td class="tdCenter">Interaction</td>
                  <td class="tdCenter">588.9444</td>
                  <td class="tdCenter">6</td>
                  <td class="tdCenter">98.1574</td>
                  <td class="tdCenter">1.7668</td>
                  <td class="tdCenter">0.1488</td>
                </tr>
                <tr> 
                  <td class="tdCenter">Error</td>
                  <td class="tdCenter">1333.3333</td>
                  <td class="tdCenter">24</td>
                  <td class="tdCenter">55.5556</td>
                  <td class="tdCenter"></td>
                  <td class="tdCenter"></td>
                </tr>
                <tr> 
                  <td class="tdCenter"><b>Total</b></td>
                  <td class="tdCenter"><b>3267.5556</b></td>
                  <td class="tdCenter"><b>35</b></td>
                  <td class="tdCenter"></td>
                  <td class="tdCenter"></td>
                  <td class="tdCenter"></td>
                </tr>
             </table>
           <p>

      <div class="textL20M20">
        4) If you press the [ANOVA F-test] button in the options window below &lt;Figure 9.3.2&gt; of 『eStat』, the 
           two-dimensional table of means / standard deviations for each level combination as in &lt;Figure 9.3.3&gt; and 
           the two-way analysis of variance table as in &lt;Figure 9.3.4&gt; will appear in the Log Area. 
      </div>       
        <p>
          <img class="imgFig600400" src="../Figure/Fig090303.png">
          <div class="figText">&lt;Figure 9.3.3&gt; Two dimensional mean / standard deviation table</div>
        <p>
          <img class="imgFig600400" src="../Figure/Fig090304.png">
          <div class="figText">&lt;Figure 9.3.4&gt; two-way analysis of variance table</div>
        <p>
      The same analysis of two factors ANOVA can be done using 『eStatU』 by following data input and clicking [Execute] button..
      <p>
      <!---   ************ html for two factors ANOVA ************  ---->
      <p>
      <b>[<span data-msgid="Testing Hypothesis ANOVA2"></span>]</b>
      <p>
         <input class="qrBtn" type="image" src="../../QR/eStatU900_TestANOVA2.svg" onclick="window.open(addrStr[174])">
      <p>
      <button type="button" id="erase" style="width:100px;"><b>New Data</b></button>
      <p>
      <table style="width:600px">
	<tr>  
	  <td><b>[<span data-msgid="Hypothesis">Hypothesis</span>]</b></td>
	  <td><span data-msgid="Interaction"></span>&nbsp;&nbsp;</td>
	  <td><span class="fontmath">
                H<sub>o</sub> : <span data-msgid="NoInteraction"></span>
              </span>
          </td>
	  <td> &nbsp;&nbsp; </td>
	  <td><span class="fontmath">
                H<sub>1</sub> : <span data-msgid="ExistInteraction"></span>
              </span> 
          </td>
	</tr>
	<tr>  
	  <td></td>
	  <td><span data-msgid="Factor"></span> A</td>
	  <td><span class="fontmath">H<sub>o</sub> : &alpha;<sub>1</sub> = &alpha;<sub>2</sub> = ... = &alpha;<sub>a</sub> = 0</span>
          </td>
	  <td> </td>
	  <td><span class="fontmath">H<sub>1</sub> : &alpha;<sub>j</sub> &ne; 0</span> 
          </td>
	</tr>
	<tr>  
	  <td></td>
	  <td><span data-msgid="Factor"></span> B</td>
	  <td><span class="fontmath">H<sub>o</sub> : &beta;<sub>1</sub> = &beta;<sub>2</sub> = ... = &beta;<sub>b</sub> = 0</span>
          </td>
	  <td></td>
	  <td><span class="fontmath">H<sub>1</sub> : &beta;<sub>i</sub> &ne; 0</span> 
          </td>
	</tr>
	<tr>  
	  <td><b>[<span data-msgid="Test Type">Test Type</span>]</b></td>
	  <td><span class="fontmath" data-msgid="F-test">F-test</span> (ANOVA)</td>
	</tr>
      </table>
  
      <table style="width:700px">
	<tr>  
	  <td style="width:110px"><b>[<span data-msgid="Sample Data">Sample Data</span>]</b></td>
	  <td colspan="4">(<span style="color:blue" data-msgid="SameSampleSize"></span>)</td>
	</tr>
	<tr>
	  <td></td>
	  <td style="text-align:center;"><span data-msgid="Factor"></span> A 1</td>
	  <td style="text-align:center;"><span data-msgid="Factor"></span> A 2</td>
	  <td style="text-align:center;"><span data-msgid="Factor"></span> A 3</td>
	  <td style="text-align:center;"><span data-msgid="Factor"></span> A 4</td>
	  <td style="text-align:center;"><span data-msgid="Mean"></span></td>
	</tr>
	<tr>
	  <td style="text-align:right;"><span data-msgid="Factor"></span> B 1</td>
	  <td><input type="text" size=9 id="data11"></td>
	  <td><input type="text" size=9 id="data12"></td>
	  <td><input type="text" size=9 id="data13"></td>
	  <td><input type="text" size=9 id="data14"></td>
	  <td>&nbsp; y&#772;<sub>1..</sub>
	      <input type="text" class="textarea" size=5 id="rowbar1"></td>
	</tr>
	<tr>
	  <td style="text-align:right;"><span data-msgid="Factor"></span> B 2</td>
	  <td><input type="text" size=9 id="data21"></td>
	  <td><input type="text" size=9 id="data22"></td>
	  <td><input type="text" size=9 id="data23"></td>
	  <td><input type="text" size=9 id="data24"></td>
	  <td>&nbsp; y&#772;<sub>2..</sub>
	      <input type="text" class="textarea" size=5 id="rowbar2"></td>
	</tr>
	<tr>
	  <td style="text-align:right;"><span data-msgid="Factor"></span> B 3</td>
	  <td><input type="text" size=9 id="data31"></td>
	  <td><input type="text" size=9 id="data32"></td>
	  <td><input type="text" size=9 id="data33"></td>
	  <td><input type="text" size=9 id="data34"></td>
	  <td>&nbsp; y&#772;<sub>3..</sub>
	      <input type="text" class="textarea" size=5 id="rowbar3"></td>
	</tr>
	<tr>
	  <td style="text-align:right;"><span data-msgid="Factor"></span> B 4</td>
	  <td><input type="text" size=9 id="data41"></td>
	  <td><input type="text" size=9 id="data42"></td>
	  <td><input type="text" size=9 id="data43"></td>
	  <td><input type="text" size=9 id="data44"></td>
	  <td>&nbsp; y&#772;<sub>4..</sub>
	      <input type="text" class="textarea" size=5 id="rowbar4"></td>
	</tr>
	<tr>  
          <td style="text-align:center;"><span data-msgid="Mean"></span></td>
	  <td> y&#772;<sub>.1.</sub>
	      <input type="text" class="textarea" size=5 id="colbar1"></td>
	  <td> y&#772;<sub>.2.</sub>
	      <input type="text" class="textarea" size=5 id="colbar2"></td>
	  <td> y&#772;<sub>.3.</sub>
	      <input type="text" class="textarea" size=5 id="colbar3"></td>
	  <td> y&#772;<sub>.4.</sub>
	      <input type="text" class="textarea" size=5 id="colbar4"></td>
	  <td>&nbsp; y&#772;<sub>...</sub>
	      <input type="text" class="textarea" size=5 id="totbar"></td>
	</tr>
      </table>   

      <button type="button" id="execute" >
        <span data-msgid="Execute">Execute</span>
      </button> 
      <br>
      <svg id="chart" width="600" height="400" style="border-style:solid;"> </svg>
      <br>
      <button type="button" id="saveGraphU" >
	<span class="tooltiptext" data-msgid="Graph Save">Graph Save</span>
      </button>
      &nbsp;
      <button type="button" id="saveTable"><span class="tooltiptext" data-msgid="Table Save">Table Save</span></button>

      <p>
      <div> 
        <div id="screenTable">
          <div id="loc">
          </div>
        </div>
      </div>

    </div>
    <!---script for two factors ANOVA ---------------------------------------------------------------->
<script>
      setLanguage('en');
      var chart = d3.select("#chart");
      var svgWidth    = 600;
      var svgHeight   = 400;
      var margin      = {top: 80, bottom: 60, left: 80, right: 80};
      var graphWidth  = svgWidth - margin.left - margin.right;
      var graphHeight = svgHeight - margin.top - margin.bottom;
      var i, j, k, dfa, dfb, dfab, dfe, dft, info;
      var sst, ssa, ssb, ssab, sse, msa, msb, msab, mse, temp; 
      var fobs1, fobs2, fobs3, pvalue1, pvalue2, pvalue3;
      var dmax, dmin;
      var maxA = 5;
      var maxB = 5;
      var maxK = 5;
      var nnA, nnB, nnK;
      var totbar;
      var y     = new Array(maxB);
      var yobs  = new Array(maxB);
      var ymean = new Array(maxB);
      for (i = 0; i < maxB; i++) {
        y[i]     = new Array(maxA)
        yobs[i]  = new Array(maxA)
        ymean[i] = new Array(maxA);
      }
      for (i = 0; i < maxB; i++) 
        for (j = 0; j < maxA; j++) 
          y[i][j] = new Array(maxK);
      var robs  = new Array(maxB);
      var rmean = new Array(maxB);
      var rname = new Array(maxB);
      var cobs  = new Array(maxA)
      var cmean = new Array(maxA)
      var cname = new Array(maxA)    
      var tobs, tmean;
      for (j=0; j<maxA; j++) cname[j] = "Factor A " + (j+1).toString(); 
      for (i=0; i<maxB; i++) rname[i] = "Factor B " + (i+1).toString(); 

      document.getElementById("rowbar1").disabled = true;  
      document.getElementById("rowbar2").disabled = true;  
      document.getElementById("rowbar3").disabled = true;  
      document.getElementById("rowbar4").disabled = true;  
      document.getElementById("colbar1").disabled = true;  
      document.getElementById("colbar2").disabled = true;  
      document.getElementById("colbar3").disabled = true;  
      document.getElementById("colbar4").disabled = true;  
      document.getElementById("totbar").disabled  = true;  

      // input data control ===================================================
      d3.select("#data11").on("input", function() {
        stat = simplestat("#data11");  
        y[1][1] = data;
        if (document.getElementById("data11").value == "") yobs[1][1] = 0;
        else yobs[1][1] = y[1][1].length;
      });
      d3.select("#data12").on("input", function() {
        stat = simplestat("#data12");  
        y[1][2] = data; 
        if (document.getElementById("data12").value == "") yobs[1][2] = 0;
        else yobs[1][2] = y[1][2].length;
      });
      d3.select("#data13").on("input", function() {
        stat = simplestat("#data13");  
        y[1][3] = data;
        if (document.getElementById("data13").value == "") yobs[1][3] = 0;
        else yobs[1][3] = y[1][3].length;
      });
      d3.select("#data14").on("input", function() {
        stat = simplestat("#data14");  
        y[1][4] = data;
        if (document.getElementById("data14").value == "") yobs[1][4] = 0;
        else yobs[1][4] = y[1][4].length;
      });
      d3.select("#data21").on("input", function() {
        stat = simplestat("#data21");  
        y[2][1] = data;
        if (document.getElementById("data21").value == "") yobs[2][1] = 0;
        else yobs[2][1] = y[2][1].length;
      });
      d3.select("#data22").on("input", function() {
        stat = simplestat("#data22");  
        y[2][2] = data; 
        if (document.getElementById("data22").value == "") yobs[2][2] = 0;
        else yobs[2][2] = y[2][2].length;
      });
      d3.select("#data23").on("input", function() {
        stat = simplestat("#data23");  
        y[2][3] = data;
        if (document.getElementById("data23").value == "") yobs[2][3] = 0;
        else yobs[2][3] = y[2][3].length;
      });
      d3.select("#data24").on("input", function() {
        stat = simplestat("#data24");  
        y[2][4] = data;
        if (document.getElementById("data24").value == "") yobs[2][4] = 0;
        else yobs[2][4] = y[2][4].length;
      });
      d3.select("#data31").on("input", function() {
        stat = simplestat("#data31");  
        y[3][1] = data;
        if (document.getElementById("data31").value == "") yobs[3][1] = 0;
        else yobs[3][1] = y[3][1].length;
      });
      d3.select("#data32").on("input", function() {
        stat = simplestat("#data32");  
        y[3][2] = data; 
        if (document.getElementById("data32").value == "") yobs[3][2] = 0;
        else yobs[3][2] = y[3][2].length;
      });
      d3.select("#data33").on("input", function() {
        stat = simplestat("#data33");  
        y[3][3] = data;
        if (document.getElementById("data33").value == "") yobs[3][3] = 0;
        else yobs[3][3] = y[3][3].length;
      });
      d3.select("#data34").on("input", function() {
        stat = simplestat("#data34");  
        y[3][4] = data;
        if (document.getElementById("data34").value == "") yobs[3][4] = 0;
        else yobs[3][4] = y[3][4].length;
      });
      d3.select("#data41").on("input", function() {
        stat = simplestat("#data41");  
        y[4][1] = data;
        if (document.getElementById("data41").value == "") yobs[4][1] = 0;
        else yobs[4][1] = y[4][1].length;
      });
      d3.select("#data42").on("input", function() {
        stat = simplestat("#data42");  
        y[4][2] = data; 
        if (document.getElementById("data42").value == "") yobs[4][2] = 0;
        else yobs[4][2] = y[4][2].length;
      });
      d3.select("#data43").on("input", function() {
        stat = simplestat("#data43");  
        y[4][3] = data;
        if (document.getElementById("data43").value == "") yobs[4][3] = 0;
        else yobs[4][3] = y[4][3].length;
      });
      d3.select("#data44").on("input", function() {
        stat = simplestat("#data44");  
        y[4][4] = data;
        if (document.getElementById("data44").value == "") yobs[4][4] = 0;
        else yobs[4][4] = y[4][4].length;
      });

      // init example
      document.getElementById("data11").value = "64, 66, 70";
        stat = simplestat("#data11");  
        y[1][1] = data;
        yobs[1][1] = y[1][1].length;
      document.getElementById("data12").value = "72, 81, 64";
        stat = simplestat("#data12");  
        y[1][2] = data;
        yobs[1][2] = y[1][2].length;
      document.getElementById("data13").value = "74, 51, 65";
        stat = simplestat("#data13");  
        y[1][3] = data;
        yobs[1][3] = y[1][3].length;
      document.getElementById("data21").value = "65, 63, 58";
        stat = simplestat("#data21");  
        y[2][1] = data;
        yobs[2][1] = y[2][1].length;
      document.getElementById("data22").value = "57, 43, 52";
        stat = simplestat("#data22");  
        y[2][2] = data;
        yobs[2][2] = y[2][2].length;
      document.getElementById("data23").value = "47, 58, 67";
        stat = simplestat("#data23");  
        y[2][3] = data;
        yobs[2][3] = y[2][3].length;
      document.getElementById("data31").value = "59, 68, 65";
        stat = simplestat("#data31");  
        y[3][1] = data;
        yobs[3][1] = y[3][1].length;
      document.getElementById("data32").value = "66, 71, 59";
        stat = simplestat("#data32");  
        y[3][2] = data;
        yobs[3][2] = y[3][2].length;
      document.getElementById("data33").value = "58, 45, 42";
        stat = simplestat("#data33");  
        y[3][3] = data;
        yobs[3][3] = y[3][3].length;
      document.getElementById("data41").value = "58, 50, 49";
        stat = simplestat("#data41");  
        y[4][1] = data;
        yobs[4][1] = y[4][1].length;
      document.getElementById("data42").value = "57, 61, 53";
        stat = simplestat("#data42");  
        y[4][2] = data;
        yobs[4][2] = y[4][2].length;
      document.getElementById("data43").value = "53, 59, 38";
        stat = simplestat("#data43");  
        y[4][3] = data;
        yobs[4][3] = y[4][3].length;


      // erase Data and Graph
      d3.select("#erase").on("click",function() {
        chart.selectAll("*").remove();
        document.getElementById("data11").value  = "";
        document.getElementById("data12").value  = "";
        document.getElementById("data13").value  = "";
        document.getElementById("data14").value  = "";
        document.getElementById("data21").value  = "";
        document.getElementById("data22").value  = "";
        document.getElementById("data23").value  = "";
        document.getElementById("data24").value  = "";
        document.getElementById("data31").value  = "";
        document.getElementById("data32").value  = "";
        document.getElementById("data33").value  = "";
        document.getElementById("data34").value  = "";
        document.getElementById("data41").value  = "";
        document.getElementById("data42").value  = "";
        document.getElementById("data43").value  = "";
        document.getElementById("data44").value  = "";
        document.getElementById("rowbar1").value  = "";  
        document.getElementById("rowbar2").value  = "";  
        document.getElementById("rowbar3").value  = "";  
        document.getElementById("rowbar4").value  = "";  
        document.getElementById("rowbar5").value  = "";  
        document.getElementById("colbar1").value  = "";  
        document.getElementById("colbar2").value  = "";  
        document.getElementById("colbar3").value  = "";  
        document.getElementById("colbar4").value  = "";  
        document.getElementById("totbar").disabled  = true;  
      })


      // Testing Hypothesis ===========================================================
      d3.select("#execute").on("click",function() {
        chart.selectAll("*").remove();
        // check data, nnA, nnB, nnK 
        tobs = 0;
        for (j=1; j<maxA; j++) cobs[j] = 0;
        for (i=1; i<maxB; i++) {
          robs[i] = 0;
          for(j=1; j<maxA; j++) {
             if (yobs[i][j] > 0) {
               robs[i] += yobs[i][j];
               cobs[j] += yobs[i][j];
             }
          }
          tobs += robs[i];
        }   
        nnB = 0;
        for (i=1; i<maxB; i++) {
          if (robs[i] > 0) nnB++;
        }
        nnA = 0;
        for (j=1; j<maxA; j++) {
          if (cobs[j] > 0) nnA++
        } 
        nnK = yobs[1][1];
        for (i=1; i<=nnB; i++) {
          for (j=1; j<=nnA; j++) {
            if (yobs[i][j] != nnK) {  // wrong input k
              chart.append("text").attr("class","mean").attr("x", 150).attr("y", 100)
                   .text("All data size should be the same!!   Try again.").style("stroke","red");
              return;
            }
          }
        }
        // Two way ANOVA
        testingANOVA2();
        if (sse > 0) {
          drawANOVA2(nnA,nnB);
          // 2원분산분석표 그리기
          Anova2Table();
        }
      })

      // svg Graph Save
      d3.select("#saveGraphU").on("click", function() {
        var svg = d3.select("#chart");
        var width = svgWidth;
        var height = svgHeight;
        var svgString = getSVGString(svg.node());
        svgString2Image(svgString, width, height, 'png', save);
        function save(dataBlob, filesize) {
          saveAs(dataBlob, 'eStatGraphU.png');
        }
      });

      // save Table
      d3.select("#saveTable").on("click", function() {
        head = '<html><head><meta charset="UTF-8"></head><body>';
        tail = '</body></html>';
        saveAs(new Blob([head + d3.select("#screenTable").html() + tail]), "eStatULog.html");
      });

// ANOVA2 
function testingANOVA2() {
          // test statistics
          dft  = tobs - 1;
          dfa  = nnA - 1;
          dfb  = nnB - 1;
          dfab = dfa * dfb;
          dfe  = tobs - nnA*nnB;
          // total row, col mean
          dmax   = -99999999;
          dmin   =  99999999;
          tmean = 0;
          for (j=1; j<=nnA; j++) cmean[j] = 0;
          for (i=1; i<=nnB; i++) {
            rmean[i] = 0;
            for (j=1; j<=nnA; j++) {
              ymean[i][j] = 0;
              for (k=0; k<nnK; k++) ymean[i][j] += y[i][j][k];
              rmean[i] += ymean[i][j];
              cmean[j] += ymean[i][j];
              ymean[i][j] /= yobs[i][j];
              if (ymean[i][j] > dmax) dmax = ymean[i][j];
              if (ymean[i][j] < dmin) dmin = ymean[i][j];
            }
            tmean += rmean[i];
          }
          for (j=1; j<=nnA; j++) {
            cmean[j] /= cobs[j];
            str = "colbar"+j;
            document.getElementById(str).value = f3(cmean[j]);
          }
          for (i=1; i<=nnB; i++) {
            rmean[i] /= robs[i];
            str = "rowbar"+i;
            document.getElementById(str).value = f3(rmean[i]);
          }

          tmean = tmean / tobs;
          document.getElementById("totbar").value = f3(tmean);
          // total sum of squares
          sst = 0;
          for (i=1; i<=nnB; i++) {
            for (j=1; j<=nnA; j++) {
              for (k=0; k<nnK; k++) {
                temp = y[i][j][k] - tmean;
                sst += temp*temp;
              }
            }
          }

          // Error SS
          sse  = 0;
          for (i=1; i<=nnB; i++) {
            for (j=1; j<=nnA; j++) {
              for (k=0; k<nnK; k++) {
                temp = y[i][j][k] - ymean[i][j];
                sse += temp*temp;
              }
            }
          }
          if (sse <= 0) {  // wrong input k
            chart.append("text").attr("class","mean").attr("x", 150).attr("y", 100)
                 .text("Error sum of square is zero!!   Try again.").style("stroke","red");
            return;
          }

          // Interaction SS
          ssab = 0;
          for (i=1; i<=nnB; i++) {
            for (j=1; j<=nnA; j++) {
              temp = ymean[i][j] - rmean[i] - cmean[j] + tmean;
              ssab += nnK*temp*temp;
            }
          }

          // Factor A and B sum of squares
          ssa = 0;
          for (j=1; j<=nnA; j++) {
            temp = cmean[j]-tmean;
            ssa += cobs[j]*temp*temp;
          }

          ssb = 0;
          for (i=1; i<=nnB; i++) {
            temp = rmean[i]-tmean;
            ssb += robs[i]*temp*temp;
          }

          // mean squares   
          msa  = ssa / dfa;
          msb  = ssb / dfb;
          msab = ssab / dfab;
          mse  = sse / dfe;
          // pvalue
          fobs1 = msa / mse;
          fobs2 = msb / mse;
          fobs3 = msab / mse;
          pvalue1 = 1 - f_cdf(fobs1, dfa, dfe, info);
          pvalue2 = 1 - f_cdf(fobs2, dfb, dfe, info);
          pvalue3 = 1 - f_cdf(fobs3, dfab, dfe, info);

}  
// 분산분석표 --------------------------------------------------------------------------------------------------
function Anova2Table() {
    var screenTable = document.getElementById("screenTable");
    var table = document.createElement('table');
    loc.appendChild(table);

    var i, j, temp, info, str;
    var row;
    var num = 0;
    var ncol = 6;
    var k = 0;

    var cell = new Array(ncol);
    table.style.fontSize = "13px";
    table.style.cellPadding = "10";

    row = table.insertRow(num);
    for (j = 0; j < nnA+2; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.textAlign = "center";
        cell[j].style.backgroundColor = "#eee";
        cell[j].style.border = "1px solid black";
        cell[j].style.width = "80px";
    }
    cell[0].innerHTML = svgStr[34][langNum]; // "Mean";
    for (j = 1; j <= nnA; j++) cell[j].innerHTML = svgStr[72][langNum] + " A " + j ; // "Factor";  
    cell[nnA+1].innerHTML = svgStr[34][langNum]; // "Mean";

    for (i=1; i<=nnB; i++) {
      row = table.insertRow(++num);
      for (j = 0; j < nnA+2; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.border = "1px solid black";
        cell[j].style.width = "80px";
      }
      cell[0].style.textAlign = "center";
      for (j = 1; j < nnA+2; j++) {
        cell[j].style.textAlign = "right";
      }
      cell[0].innerHTML = svgStr[72][langNum] + " B " + i; // "요인";
      for (j=1; j<=nnA; j++) cell[j].innerHTML = f3(ymean[i][j]); 
      cell[nnA+1].innerHTML = f3(rmean[i]); 
      cell[nnA+1].style.backgroundColor = "#eee";
    }

    row = table.insertRow(++num);
    for (j = 0; j < nnA+2; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.backgroundColor = "#eee";
        cell[j].style.border = "1px solid black";
        cell[j].style.width = "80px";
    }
    cell[0].style.textAlign = "center";
    for (j = 1; j < nnA+2; j++) {
        cell[j].style.textAlign = "right";
    }
    cell[0].innerHTML = svgStr[34][langNum]; // "Mean";
    for (j = 1; j <= nnA; j++) cell[j].innerHTML = f3(cmean[j]);  
    cell[nnA+1].innerHTML = f3(tmean); 

    row = table.insertRow(++num);

    row = table.insertRow(++num);
    for (j = 0; j < ncol; j++) cell[j] = row.insertCell(j);
    cell[0].innerHTML = "<h3>" + svgStr[15][langNum] + "</h3>"; // "분산분석표";
    cell[0].style.textAlign = "center";
    cell[0].style.backgroundColor = "#eee";
    cell[0].style.border = "1px solid black";
    //          row.style.height ="40px";
    cell[0].style.width = "130px";

    row = table.insertRow(++num);
    for (j = 0; j < ncol; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.textAlign = "center";
        cell[j].style.backgroundColor = "#eee";
        cell[j].style.border = "1px solid black";
        cell[j].style.width = "80px";
    }
    cell[0].innerHTML = svgStr[72][langNum]; // "요인";
    cell[1].innerHTML = svgStr[73][langNum]; // "제곱합";  
    cell[2].innerHTML = svgStr[74][langNum]; // "자유도";  
    cell[3].innerHTML = svgStr[75][langNum]; // "평균제곱";  
    cell[4].innerHTML = "F " + svgStr[69][langNum]; // "F관찰값";   
    cell[5].innerHTML = "p " + svgStr[69][langNum]; // "p-값 =";    

    row = table.insertRow(++num);
    for (j = 0; j < ncol; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.textAlign = "right";
        cell[j].style.border = "1px solid black";
    }
    cell[0].style.backgroundColor = "#eee";
    cell[0].style.textAlign = "center";
    cell[0].innerHTML = "A"; 
    cell[1].innerHTML = f3(ssa).toString();
    cell[2].innerHTML = f0(dfa).toString();
    cell[3].innerHTML = f3(msa).toString();
    cell[4].innerHTML = f3(fobs1).toString();
    if (pvalue1 < 0.0001) str = " < 0.0001";
    else str = f4(pvalue1).toString();
    cell[5].innerHTML = str;

    row = table.insertRow(++num);
    for (j = 0; j < ncol; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.textAlign = "right";
        cell[j].style.border = "1px solid black";
    }
    cell[0].style.backgroundColor = "#eee";
    cell[0].style.textAlign = "center";
    cell[0].innerHTML = "B"; 
    cell[1].innerHTML = f3(ssb).toString();
    cell[2].innerHTML = f0(dfb).toString();
    cell[3].innerHTML = f3(msb).toString();
    cell[4].innerHTML = f3(fobs2).toString();
    if (pvalue2 < 0.0001) str = " < 0.0001";
    else str = f4(pvalue2).toString();
    cell[5].innerHTML = str;

    row = table.insertRow(++num);
    for (j = 0; j < ncol; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.textAlign = "right";
        cell[j].style.border = "1px solid black";
    }
    cell[0].style.backgroundColor = "#eee";
    cell[0].style.textAlign = "center";
    cell[0].innerHTML = svgStr[103][langNum]; // Interaction
    cell[1].innerHTML = f3(ssab).toString();
    cell[2].innerHTML = f0(dfab).toString();
    cell[3].innerHTML = f3(msab).toString();
    cell[4].innerHTML = f3(fobs3).toString();
    if (pvalue3 < 0.0001) str = " < 0.0001";
    else str = f4(pvalue3).toString();
    cell[5].innerHTML = str;

    row = table.insertRow(++num);
    for (j = 0; j < ncol; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.textAlign = "right";
        cell[j].style.border = "1px solid black";
    }
    cell[0].style.backgroundColor = "#eee";
    cell[0].style.textAlign = "center";
    cell[0].innerHTML = svgStr[77][langNum]; // "오차";
    cell[1].innerHTML = f3(sse).toString();
    cell[2].innerHTML = f0(dfe).toString();
    cell[3].innerHTML = f3(mse).toString();

    row = table.insertRow(++num);
    for (j = 0; j < ncol; j++) {
        cell[j] = row.insertCell(j);
        cell[j].style.border = "1px solid black";
        cell[j].style.textAlign = "right";
        cell[j].style.backgroundColor = "#eee";
    }
    cell[0].style.textAlign = "center";
    cell[0].innerHTML = svgStr[78][langNum]; // "전체";
    cell[1].innerHTML = f3(sst).toString();
    cell[2].innerHTML = f0(dft).toString();

    // 다음 표와의 공백을 위한 것
    row = table.insertRow(++num);
    row.style.height = "20px";

}
// 그래프 함수 ----------------------------------------------------------------------------------
function drawANOVA2(nnA,nnB) {
    chart.selectAll("*").remove();
    var i, j, k, m, p, tobs, temp, tlabel, df, info;
    var sx, sy, tx, ty, x1, x2, y1, y2;
    var radius = 4;

    // 점그래프 전체 데이터 최소 최대 계산
    temp    = (dmax - dmin) / 10; // (전체 최대 - 최소) / 10  : 그래프 양 끝쪽 buffer 
    gymin   = dmin - temp;
    gymax   = dmax + temp;
    gyrange = gymax - gymin;
    gxmin   = 0.5;
    gxmax   = nnA + 0.5;
    gxrange = gxmax - gxmin;

    // 그림 캔버스
    chart.append("rect")
        .style("fill", "white")
        .style("stroke", "black")
        .attr("x", margin.left)
        .attr("y", margin.top)
        .attr("width", graphWidth)
        .attr("height", graphHeight)
    // 전체 제목
    chart.append("text")
        .attr("x", margin.left + graphWidth/2)
        .attr("y", margin.top / 2 + 10)
        .style("font-size", "17px")
        .style("font-family", "sans-seirf")
        .style("stroke", "black")
        .style("text-anchor", "middle")
        .text(svgStr[109][langNum]) // line graph by block
    // X축 제목
    chart.append("text")
        .attr("x", margin.left + graphWidth/2)
        .attr("y", margin.top + graphHeight + margin.bottom / 2 + 10)
        .style("font-size", "14px")
        .style("font-family", "sans-seirf")
        .style("stroke", "black")
        .style("text-anchor", "middle")
        .text(svgStr[72][langNum]+" A") // Factor
    // Y축
    var yScale = d3.scaleLinear().domain([gymin, gymax]).range([graphHeight, 0]);
    chart.append("g")
        .attr("class", "axis")
        .attr("transform", "translate(" + margin.left + ", " + margin.top + ") ")
        .call(d3.axisLeft(yScale))

    // 범례
    for (i = 0; i < nnB; i++) {
       chart.append("text")
            .style("font-size", "12px")
            .style("font-family", "sans-seirf")
            .style("text-anchor", "start")
            .style("stroke", myColor[i+1])
            .attr("x", margin.left + graphWidth + 10)
            .attr("y", margin.top + (i+1) * 20)
            .text(rname[i]);
    }
    // Treatment
    ty = margin.top + graphHeight + 15;
    for (j = 0; j < nnA; j++) {
        str = (j+1).toString();
        tx  = margin.left + graphWidth * (j+1-gxmin) / gxrange;
        chart.append("text")
            .style("font-size", "10px")
            .style("font-family", "sans-seirf")
            .style("stroke", "black")
            .style("text-anchor", "middle")
            .attr("x", tx)
            .attr("y", ty)
            .text(cname[j]);
    }

    // Factor B별 line 그래프
    for (i = 0; i < nnB; i++) {
       sx = margin.left + graphWidth*(1-gxmin)/gxrange;
       sy = margin.top+graphHeight - graphHeight*(ymean[i+1][1]-gymin)/gyrange;        
       chart.append("circle")
            .attr("class", "circle")
            .style("fill", myColor[i+1])
            .attr("cx", sx)
            .attr("cy", sy)
            .attr("r", radius)
        // 점그리기 선그리기
        for (j = 1; j < nnA; j++) {
           tx = margin.left + graphWidth*(j+1-gxmin)/gxrange;
           ty = margin.top + graphHeight - graphHeight * (ymean[i+1][j+1] - gymin) / gyrange;
           chart.append("circle")
                .attr("class", "circle")
                .style("fill", myColor[i+1])
                .attr("cx", tx)
                .attr("cy", ty)
                .attr("r", radius)
           chart.append("line")
                .attr("x1", sx)
                .attr("y1", sy)
                .attr("x2", tx)
                .attr("y2", ty)
                .style("stroke", myColor[i+1])
                .style("stroke-width", "3px")
           sx = tx;
           sy = ty;
        } // endof j
    } // endof i

}

</script>



    <p>
    <div class="mainTable">
      Let's generalize the theory of the two-way analysis of variance discussed in the example above. 
      Let \(Y_{ijk}\) be the random variable representing the \(k^{th}\) observation at the \(i^{th}\)
      level of factor A, which has \(a\) number of levels, and \(j^{th}\) level of factor B, which has
      \(b\)number of levels. A statistical model of the two-way analysis of variances is as follows:
        $$
          Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_{ij} + \epsilon_{ijk} , \quad i=1,2, ... ,a ; \;  j=1,2, ... , b ; \;  k=1,2, ... , r
        $$
      <div class="textL20">
         \(\quad \mu\)  : total mean <br>
         \(\quad \alpha_i\)  : effect of \(i^{th}\) level of factor A<br>
         \(\quad \beta_j\)  : effect of \(j^{th}\) level of factor B<br>
         \(\quad \gamma_{ij}\)  : interaction effect of \(i^{th}\) level of factor A and \(j^{th}\) level of factor B<br>
         \(\quad \epsilon_{ijk}\)  : error terms which are independent and follow N(0,\(\sigma^{2}\)).
      </div>
      <p>
        Assume that experiments are repeated \(r\) times equally at the \(i^{th}\) level of factor A and 
        \(j^{th}\) level of factor B. Therefore, the total number of observations is \(n = abr\).
      <p>
        The total sum of squared distances from each observation to the total mean  can be partitioned as following sum 
        of squares similar to the one-way analysis of variance.  
      <p>
      <b>Total sum of squares</b> : <br>
      <b>SST</b> = \(\sum_{i=1}^{a} \sum_{j=1}^{b} \sum_{k=1}^{r}( Y_{ijk} - {\overline Y}_{\cdot \cdot \cdot} )^2 \) , 
         &nbsp;&nbsp; degrees of freedom ; \(n - 1\) 
      <p>
      <b>Factor A sum of squares</b> : <br>
      <b>SSA</b> = \(br \sum_{i=1}^{a} ( {\overline Y}_{i \cdot \cdot} - {\overline Y}_{\cdot \cdot \cdot} )^2 \) ,
         &nbsp;&nbsp; degrees of freedom ; \(a - 1\) 
      <p>
      <b>Factor B sum of squares</b> : <br>
      <b>SSB</b> = \(ar \sum_{j=1}^{b} ( {\overline Y}_{\cdot j \cdot} - {\overline Y}_{\cdot \cdot \cdot} )^2 \) ,
         &nbsp;&nbsp; degrees of freedom ; \(b - 1\) 
      <p>
      <b>Interaction sum of squares</b> : <br>
      <b>SSAB</b> = \(r \sum_{i=1}^{a} \sum_{j=1}^{b} ( {\overline Y}_{ij \cdot} - {\overline Y}_{i \cdot \cdot} - {\overline Y}_{\cdot j \cdot} + {\overline Y}_{\cdot \cdot \cdot} )^2 \) ,
         &nbsp;&nbsp; degrees of freedom ; \((a - 1)(b - 1)\) 
      <p>
      <b>Error sum of squares</b> : <br>
      <b>SSE</b> = \(\sum_{i=1}^{a} \sum_{j=1}^{b} \sum_{k=1}^{r} ( {Y}_{ijk} - {\overline Y}_{ij \cdot})^2 \) , 
         &nbsp;&nbsp; degrees of freedom ; \(n-ab\) 
      <p>   
    </div>
    <p>

    <div class="mainTableYellow">
      <b>Partition of Sum of Squares and degrees of freedom
        <p>
        Sum of Squares: \(\qquad SST = SSA + SSB + SSAB + SSE\) <br>    	
        degrees of freedom: \((n-1) = (a-1) + (b-1) + (a-1)(b-1) + (n-ab)\)
      </b>
    </div>
    <p>
  
    <div class="mainTable">
      The two-way analysis of variance is summarized as Table 9.3.4.
           <p>
             <div class="textLeft">Table 9.3.4  two-way analysis of variance table</div>
           <p>
             <table style="width:650px"> 
                <tr> 
                  <th>Factor</th>
                  <th>Sum of Squares</th>
                  <th>Degree of freedom</th>
                  <th>Mean Squares</th>
                  <th>F value</th>
                </tr>
                <tr> 
                  <td class="tdCenter">Factor A</td>
                  <td class="tdCenter">SSA</td>
                  <td class="tdCenter">\(a-1\)</td>
                  <td class="tdCenter">MSA=\(\frac{SSA}{a-1}\)</td>
                  <td class="tdCenter">\(F_1 = \frac{MSA}{MSE}\)</td>
                </tr>
                <tr> 
                  <td class="tdCenter">Factor B</td>
                  <td class="tdCenter">SSB</td>
                  <td class="tdCenter">\(b-1\)</td>
                  <td class="tdCenter">MSB=\(\frac{SSB}{b-1}\)</td>
                  <td class="tdCenter">\(F_2 = \frac{MSB}{MSE}\)</td>
                </tr>
                <tr> 
                  <td class="tdCenter">Interaction</td>
                  <td class="tdCenter">SSAB</td>
                  <td class="tdCenter">\((a-1)(b-1)\)</td>
                  <td class="tdCenter">MSAB=\(\frac{SSAB}{(a-1)(b-1)}\)</td>
                  <td class="tdCenter">\(F_3 = \frac{MSAB}{MSE}\)</td>
                </tr>
                <tr> 
                  <td class="tdCenter">Error</td>
                  <td class="tdCenter">SSE</td>
                  <td class="tdCenter">\(n-ab\)</td>
                  <td class="tdCenter">MSE=\(\frac{SSE}{(n-ab)}\)</td>
                  <td class="tdCenter"></td>
                </tr>
                <tr> 
                  <td class="tdCenter"><b>Total</b></td>
                  <td class="tdCenter"><b>SST</b></td>
                  <td class="tdCenter"><b>\(n-1\)</b></td>
                  <td class="tdCenter"></td>
                  <td class="tdCenter"></td>
                </tr>
             </table>
    </div>
    <p>

    <div class="mainTableYellow">
      <b>Two-way analysis of variance without repetition of experiments</b>
      <p>
      If there is no repeated observation at each level combination of two factors, the interaction effect can not be 
      estimated and the row of interaction factor is deleted from the above two-way ANOVA table. In this case, the 
      analysis of variance table is the same as the randomized block design as Table 9.2.3. 
    </div>
    <p>  

    <div class="mainTable">
      Testing hypothesis for the main effects and interaction effect of factor A and factor B are as follows. If the 
      interaction effect is separated, it is reasonable to test the interaction effect first. This is because, 
      depending on the significance of the interaction effect, the method of interpreting the result of the main effect 
      test of each factor can be different.  
      <p>
      1) Test for the interaction effect: 
         <div class="textL20">
           \(H_0 : \gamma_{ij} = 0,\; i=1,2,...,a;\; j=1,2,...,b \) <br>
           If \(\frac{MSAB}{MSE} \gt F_{(a-1)(b-1),n-ab; &alpha;} \), then reject \(H_0\)
         </div>  
         <p>   
      2)  Test for the main effect of factor A:
         <div class="textL20">
           \(H_0 : \alpha_1 = \alpha_2 = \cdots = \alpha_a = 0 \) <br>
           If \(\frac{MSA}{MSE} \gt F_{(a-1),n-ab; &alpha;} \), then reject \(H_0\)
         </div>  
         <p>   
      3)  Test for the main effect of factor B:
         <div class="textL20">
           \(H_0 : \beta_1 = \beta_2 = \cdots = \beta_b = 0 \) <br>
           If \(\frac{MSB}{MSE} \gt F_{(b-1),n-ab; &alpha;} \), then reject \(H_0\)
         </div>  
         <p>   
       <p>
      (『eStat』 calculates the \(p\)-value for each of these tests and tests them using it. That is, 
         for each test, if the \(p\)-value is less than the significance level, the null hypothesis 
         \(H_0\) is rejected.)
       <p>
         If the test for interaction effect is not significant, a test of the main effects of each factor can be performed 
         to test significant differences between levels. However, if there is a significant interaction effect, the test 
         for the main effects of each factor is meaningless, so an analysis should be made on which level combinations of 
         factors show differences in the means.
       <p>
         If you conclude that significant differences between the levels of a factor as in the one-way analysis of 
         variance exist there, you can compare confidence intervals at each level to see which level of the differences 
         appears. And a residual analysis is necessary to investigate the validity of the assumption.
    </div>
      
      
    <p>
    <!------------------------------------------------------------------------------------------------->
    <div class="mainTablePink">
      <table class="width:650px">
        <tr>
          <td>
            <input class="qrBtn" type="image" src="../../QR/PR090301.svg" onclick="window.open(addrStr[67])">
          </td>
          <td>
            <b>Practice 9.3.1</b> 
            The result of an experiment at a production plant of an electronic component to investigate the 
            life of the product due to changes in temperature (\(T_1 , T_2\)) and humidity (\(H_1 , H_2\)) 
            is as follows. Analyze data using the analysis of variance with 5% significance level.
            <p> 
            <table style="width:400px"> 
              <tr> 
                <th>(Unit: Time) </th>
                <th>Humidity \(H_1\)</th>
                <th>Humidity \(H_2\)</th>
              </tr>
              <tr> 
                <td class="tdCenter">Time \(T_1\)</td>
                <td class="tdCenter">6.29<br>6.38<br>6.25</td>
                <td class="tdCenter">5.95<br>6.05<br>5.89</td>
              </tr>
              <tr> 
                <td class="tdCenter">Time \(T_2\)</td>
                <td class="tdCenter">5.80<br>5.92<br>5.78</td>
                <td class="tdCenter">6.32<br>6.44<br>6.29</td>
              </tr>
            </table>
            <p>   
              <div class="textLeft"> [Ex] ⇨ eBook ⇨ PR090301_LifeByTemperatureHumidity.csv </div>
          </td>
        </tr>
      </table>
    </div>
    <!------------------------------------------------------------------------------------------------->
    <p>


    <div class="mainTableYellow">
       <b>Design of experiments for the two-way analysis of variances</b>
       <p>
       Even in the two-way analysis of variance, obtaining sample data at each level of two factors in engineering or in 
       agriculture can be influenced by other factors and should be careful in sampling. In order to accurately identify 
       the differences that may exist between each level of a factor, it is advisable to make as few as possible 
       influences from other factors. One of the most commonly used methods of doing this is completely randomized 
       design which makes the entire experiments random. There are many other experimental design methods, and for more 
       information, refer to the references to the experimental design of several factors.
    </div>
    <p>

  <div class="mainTablePink">
    <h4>Multiple Choice Exercise</h4>
    <p style="color:blue">*** Choose one answer and click [Submit] button

    <h6 class="textL30M30">9.12 What is called the effect of a factor A that varies depending on the level of the factor B? </h6>
    <form name="Q12">
      <label><input type="radio" name="item" value="1"> main effect of factor A</label><br>
      <label><input type="radio" name="item" value="2"> main effect of factor B</label><br>
      <label><input type="radio" name="item" value="3"> two-way ANOVA</label><br>
      <label><input type="radio" name="item" value="4"> interaction effect</label><br>
      <p>
      <input type="button" value="Submit" onClick="radio(9,12,Q12)"> &nbsp;&nbsp;&nbsp;
      <input type="text" size=15 id="ansQ12">
    </form>
  </div>

  <script>
    for (var i=12; i < ans[9][0]+1; i++) document.getElementById(ansID[i]).disabled = true;
  </script>
  <p>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(94)">&#10094; &nbsp;&nbsp;<b>Previous</b></button>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" style="width:160px" onclick="moveSection(97)"><b>Next</b>&nbsp;&nbsp; &#10095;</button>
  <p>

</div>


   
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="https://maxcdn.bootstrapcdn.com/js/ie10-viewport-bug-workaround.js"></script>
    <script>
        //document.getElementById('sidebar').getElementsByTagName('ul')[0].className += "nav nav-sidebar";
        
        /* ajust the height when click the toc
           the code is from https://github.com/twbs/bootstrap/issues/1768
        */
        var shiftWindow = function() { scrollBy(0, -50) };
        window.addEventListener("hashchange", shiftWindow);
        function load() { if (window.location.hash) shiftWindow(); }
        
        /*add Bootstrap styles to tables*/
        var tables = document.getElementsByTagName("table");
        for(var i = 0; i < tables.length; ++i){
            tables[i].className += "table table-bordered table-hover";
        }
    </script>

</body>
</html>

